import{V as A,W as Fe,X as q,Y as z,r as p,Z as pe,_ as B,a0 as ee,a1 as Me,a2 as J,a3 as Ke,a4 as te,a5 as X,a6 as se,a7 as Pe,a8 as We,a9 as He,j as t,aa as De,ab as Ue,A as Je,t as G,B as W,ac as Xe,I as E,ad as K,ae as R,h as N,af as S,ag as Ve,ah as Ie,ai as Q,aj as Ye,ak as qe,al as ze,am as M,an as he,u as Ge,n as L,ao as H,ap as me,aq as Qe,ar as Ze,as as Be,y as et}from"./index-86768d23.js";import{C as tt,I as st}from"./index-e833f93c.js";import{S as Ae,a as nt,b as at,c as rt,d as fe,P as ot}from"./index-256d14ec.js";import{S as Z}from"./tabs-4a607088.js";import{H as it}from"./index-0d54d933.js";import{E as lt,S as ge}from"./index-6451e54f.js";import{I as ct}from"./input-13e7a0de.js";import"./index-b796a12f.js";import"./textarea-04e722a8.js";import"./table-691b62af.js";import"./index-b7b8f00f.js";import"./index-7b70fec0.js";import"./popover-270ec558.js";import"./index-9a10118c.js";import"./index-cc5eb217.js";import"./index-99b92aac.js";import"./addNewVariableButton-b5485eef.js";import"./index-451a671a.js";import"./index-f1496333.js";var ye;let Ne=(ye=A.useId)!=null?ye:function(){let e=Fe(),[s,n]=A.useState(e?()=>q.nextId():null);return z(()=>{s===null&&n(q.nextId())},[s]),s!=null?""+s:void 0};function dt(e){return q.isServer?null:e instanceof Node?e.ownerDocument:e!=null&&e.hasOwnProperty("current")&&e.current instanceof Node?e.current.ownerDocument:document}function xe(e){var s;if(e.type)return e.type;let n=(s=e.as)!=null?s:"button";if(typeof n=="string"&&n.toLowerCase()==="button")return"button"}function ut(e,s){let[n,r]=p.useState(()=>xe(e));return z(()=>{r(xe(e))},[e.type,e.as]),z(()=>{n||s.current&&s.current instanceof HTMLButtonElement&&!s.current.hasAttribute("type")&&r("button")},[n,s]),n}function pt(e){let s=e.parentElement,n=null;for(;s&&!(s instanceof HTMLFieldSetElement);)s instanceof HTMLLegendElement&&(n=s),s=s.parentElement;let r=(s==null?void 0:s.getAttribute("disabled"))==="";return r&&ht(n)?!1:r}function ht(e){if(!e)return!1;let s=e.previousElementSibling;for(;s!==null;){if(s instanceof HTMLLegendElement)return!1;s=s.previousElementSibling}return!0}var $=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))($||{}),je;let mt=(je=A.startTransition)!=null?je:function(e){e()};var ft=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(ft||{}),gt=(e=>(e[e.ToggleDisclosure=0]="ToggleDisclosure",e[e.CloseDisclosure=1]="CloseDisclosure",e[e.SetButtonId=2]="SetButtonId",e[e.SetPanelId=3]="SetPanelId",e[e.LinkPanel=4]="LinkPanel",e[e.UnlinkPanel=5]="UnlinkPanel",e))(gt||{});let yt={0:e=>({...e,disclosureState:te(e.disclosureState,{0:1,1:0})}),1:e=>e.disclosureState===1?e:{...e,disclosureState:1},4(e){return e.linkedPanel===!0?e:{...e,linkedPanel:!0}},5(e){return e.linkedPanel===!1?e:{...e,linkedPanel:!1}},2(e,s){return e.buttonId===s.buttonId?e:{...e,buttonId:s.buttonId}},3(e,s){return e.panelId===s.panelId?e:{...e,panelId:s.panelId}}},ne=p.createContext(null);ne.displayName="DisclosureContext";function ae(e){let s=p.useContext(ne);if(s===null){let n=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,ae),n}return s}let re=p.createContext(null);re.displayName="DisclosureAPIContext";function Le(e){let s=p.useContext(re);if(s===null){let n=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,Le),n}return s}let oe=p.createContext(null);oe.displayName="DisclosurePanelContext";function xt(){return p.useContext(oe)}function jt(e,s){return te(s.type,yt,e,s)}let bt=p.Fragment;function kt(e,s){let{defaultOpen:n=!1,...r}=e,c=p.useRef(null),i=ee(s,Me(a=>{c.current=a},e.as===void 0||e.as===p.Fragment)),h=p.useRef(null),f=p.useRef(null),d=p.useReducer(jt,{disclosureState:n?0:1,linkedPanel:!1,buttonRef:f,panelRef:h,buttonId:null,panelId:null}),[{disclosureState:l,buttonId:y},x]=d,b=J(a=>{x({type:1});let g=dt(c);if(!g||!y)return;let o=(()=>a?a instanceof HTMLElement?a:a.current instanceof HTMLElement?a.current:g.getElementById(y):g.getElementById(y))();o==null||o.focus()}),_=p.useMemo(()=>({close:b}),[b]),T=p.useMemo(()=>({open:l===0,close:b}),[l,b]),P={ref:i};return A.createElement(ne.Provider,{value:d},A.createElement(re.Provider,{value:_},A.createElement(Ke,{value:te(l,{0:X.Open,1:X.Closed})},se({ourProps:P,theirProps:r,slot:T,defaultTag:bt,name:"Disclosure"}))))}let vt="button";function wt(e,s){let n=Ne(),{id:r=`headlessui-disclosure-button-${n}`,...c}=e,[i,h]=ae("Disclosure.Button"),f=xt(),d=f===null?!1:f===i.panelId,l=p.useRef(null),y=ee(l,s,d?null:i.buttonRef),x=Pe();p.useEffect(()=>{if(!d)return h({type:2,buttonId:r}),()=>{h({type:2,buttonId:null})}},[r,h,d]);let b=J(o=>{var u;if(d){if(i.disclosureState===1)return;switch(o.key){case $.Space:case $.Enter:o.preventDefault(),o.stopPropagation(),h({type:0}),(u=i.buttonRef.current)==null||u.focus();break}}else switch(o.key){case $.Space:case $.Enter:o.preventDefault(),o.stopPropagation(),h({type:0});break}}),_=J(o=>{switch(o.key){case $.Space:o.preventDefault();break}}),T=J(o=>{var u;pt(o.currentTarget)||e.disabled||(d?(h({type:0}),(u=i.buttonRef.current)==null||u.focus()):h({type:0}))}),P=p.useMemo(()=>({open:i.disclosureState===0}),[i]),a=ut(e,l),g=d?{ref:y,type:a,onKeyDown:b,onClick:T}:{ref:y,id:r,type:a,"aria-expanded":i.disclosureState===0,"aria-controls":i.linkedPanel?i.panelId:void 0,onKeyDown:b,onKeyUp:_,onClick:T};return se({mergeRefs:x,ourProps:g,theirProps:c,slot:P,defaultTag:vt,name:"Disclosure.Button"})}let _t="div",Ct=pe.RenderStrategy|pe.Static;function Et(e,s){let n=Ne(),{id:r=`headlessui-disclosure-panel-${n}`,...c}=e,[i,h]=ae("Disclosure.Panel"),{close:f}=Le("Disclosure.Panel"),d=Pe(),l=ee(s,i.panelRef,T=>{mt(()=>h({type:T?4:5}))});p.useEffect(()=>(h({type:3,panelId:r}),()=>{h({type:3,panelId:null})}),[r,h]);let y=We(),x=(()=>y!==null?(y&X.Open)===X.Open:i.disclosureState===0)(),b=p.useMemo(()=>({open:i.disclosureState===0,close:f}),[i,f]),_={ref:l,id:r};return A.createElement(oe.Provider,{value:i.panelId},se({mergeRefs:d,ourProps:_,theirProps:c,slot:b,defaultTag:_t,features:Ct,visible:x,name:"Disclosure.Panel"}))}let Tt=B(kt),Ot=B(wt),Pt=B(Et),F=Object.assign(Tt,{Button:Ot,Panel:Pt});const U=He((e,s)=>({tweak:[],setTweak:n=>e({tweak:n}),tweaksList:[],setTweaksList:n=>e({tweaksList:n})}));function Dt(e){return t.jsx("div",{className:"w-[200px]",children:t.jsx("span",{children:e!=null&&e!=""?e:"None"})})}function be(e){return e.data.nodes.reduce((s,n)=>(s[n.data.id]={},s),{})}const It=(e,s)=>e.data.node.template[s]&&s.charAt(0)!=="_"&&e.data.node.template[s].show&&De.has(e.data.node.template[s].type)&&s!=="code",At=(e,s)=>(typeof e=="string"&&s.type==="float"&&(e=parseFloat(e)),typeof e=="string"&&s.type==="int"&&(e=parseInt(e)),s.list===!0&&Array.isArray(e)&&(e=e==null?void 0:e.filter(n=>n!=="")),s.type==="dict"&&Array.isArray(e)&&(e=Ue(e)),s.type==="NestedDict"&&(e=JSON.stringify(e)),e);function ke(e,s,n,r){const c=n[0];return`curl -X POST \\
    "${window.location.protocol}//${window.location.host}/api/v1/run/${r||e}?stream=false" \\
    -H 'Content-Type: application/json'\\${s?"":`
  -H 'x-api-key: <your api key>'\\`}
    -d '{"input_value": "message",
    "output_type": "chat",
    "input_type": "chat",
    "tweaks": ${JSON.stringify(c,null,2)}}'
    `}function Nt(e,s,n){return`curl -X POST \\
  "${window.location.protocol}//${window.location.host}/api/v1/webhook/${n||e}" \\
  -H 'Content-Type: application/json'\\${s?"":`
  -H 'x-api-key: <your api key>'\\`}
  -d '{"any": "data"}'
  `}const Lt=e=>{let s=[];return e.data.nodes.forEach(r=>{r.data.node.template&&Object.keys(r.data.node.template).filter(c=>c.charAt(0)!=="_"&&r.data.node.template[c].show&&De.has(r.data.node.template[c].type)).map((c,i)=>{s.push(r.id)})}),s.filter((r,c,i)=>i.indexOf(r)===c)};function ve(e,s,n,r){let c="{}";if(n&&n.length>0){const i=n[0];if(!i)throw new Error("expected tweaks");c=JSON.stringify(i,null,2).replace(/true/g,"True").replace(/false/g,"False")}return`import argparse
import json
from argparse import RawTextHelpFormatter
import requests
from typing import Optional
import warnings
try:
    from langflow.load import upload_file
except ImportError:
    warnings.warn("Langflow provides a function to help you upload files to the flow. Please install langflow to use it.")
    upload_file = None

BASE_API_URL = "${window.location.protocol}//${window.location.host}/api/v1/run"
FLOW_ID = "${e}"
ENDPOINT = "${r||""}" ${r?"# The endpoint name of the flow":"# You can set a specific endpoint name in the flow settings"}

# You can tweak the flow by adding a tweaks dictionary
# e.g {"OpenAI-XXXXX": {"model_name": "gpt-4"}}
TWEAKS = ${c}

def run_flow(message: str,
  endpoint: str,
  output_type: str = "chat",
  input_type: str = "chat",
  tweaks: Optional[dict] = None,
  api_key: Optional[str] = None) -> dict:
    """
    Run a flow with a given message and optional tweaks.

    :param message: The message to send to the flow
    :param endpoint: The ID or the endpoint name of the flow
    :param tweaks: Optional tweaks to customize the flow
    :return: The JSON response from the flow
    """
    api_url = f"{BASE_API_URL}/{endpoint}"

    payload = {
        "input_value": message,
        "output_type": output_type,
        "input_type": input_type,
    }
    headers = None
    if tweaks:
        payload["tweaks"] = tweaks
    if api_key:
        headers = {"x-api-key": api_key}
    response = requests.post(api_url, json=payload, headers=headers)
    return response.json()

def main():
    parser = argparse.ArgumentParser(description="""Run a flow with a given message and optional tweaks.
Run it like: python <your file>.py "your message here" --endpoint "your_endpoint" --tweaks '{"key": "value"}'""",
        formatter_class=RawTextHelpFormatter)
    parser.add_argument("message", type=str, help="The message to send to the flow")
    parser.add_argument("--endpoint", type=str, default=ENDPOINT or FLOW_ID, help="The ID or the endpoint name of the flow")
    parser.add_argument("--tweaks", type=str, help="JSON string representing the tweaks to customize the flow", default=json.dumps(TWEAKS))
    parser.add_argument("--api_key", type=str, help="API key for authentication", default=None)
    parser.add_argument("--output_type", type=str, default="chat", help="The output type")
    parser.add_argument("--input_type", type=str, default="chat", help="The input type")
    parser.add_argument("--upload_file", type=str, help="Path to the file to upload", default=None)
    parser.add_argument("--components", type=str, help="Components to upload the file to", default=None)

    args = parser.parse_args()
    try:
      tweaks = json.loads(args.tweaks)
    except json.JSONDecodeError:
      raise ValueError("Invalid tweaks JSON string")

    if args.upload_file:
        if not upload_file:
            raise ImportError("Langflow is not installed. Please install it to use the upload_file function.")
        elif not args.components:
            raise ValueError("You need to provide the components to upload the file to.")
        tweaks = upload_file(file_path=args.upload_file, host=BASE_API_URL, flow_id=ENDPOINT, components=args.components, tweaks=tweaks)

    response = run_flow(
        message=args.message,
        endpoint=args.endpoint,
        output_type=args.output_type,
        input_type=args.input_type,
        tweaks=tweaks,
        api_key=args.api_key
    )

    print(json.dumps(response, indent=2))

if __name__ == "__main__":
    main()
`}function we(e,s){let n="{}";if(s&&s.length>0){const r=s[0];if(!r)throw new Error("expected tweaks");n=JSON.stringify(r,null,2).replace(/true/g,"True").replace(/false/g,"False")}return`from langflow.load import run_flow_from_json
TWEAKS = ${n}

result = run_flow_from_json(flow="${e}.json",
                            input_value="message",
                            fallback_to_env_vars=True, # False by default
                            tweaks=TWEAKS)`}const $t=(e,s,n,r)=>{let c=e??"";if(r.length>0)for(const i of r)Object.keys(i).forEach(h=>{const f=i[h];h==s.id&&Object.keys(f).forEach(d=>{d==n.name&&(c=f[d])})});else return e??"";return c};function _e(e,s,n){return`<script src="https://cdn.jsdelivr.net/gh/langflow-ai/langflow-embedded-chat@1.0_alpha/dist/build/static/js/bundle.min.js"><\/script>

  <langflow-chat
    window_title="${s}"
    flow_id="${e}"
    host_url="http://localhost:7860"${n?"":`
    api_key="..."`}

  ></langflow-chat>`}function Y(e,s=!1,n=!1){const r=[{name:"Run cURL",mode:"bash",image:"https://curl.se/logo/curl-symbol-transparent.png",language:"sh",code:e[0]},{name:"Python API",mode:"python",image:"https://images.squarespace-cdn.com/content/v1/5df3d8c5d2be5962e4f87890/1628015119369-OY4TV3XJJ53ECO0W2OLQ/Python+API+Training+Logo.png?format=1000w",language:"py",code:e[2]},{name:"Python Code",mode:"python",image:"https://cdn-icons-png.flaticon.com/512/5968/5968350.png",language:"py",code:e[3]},{name:"Chat Widget HTML",description:"Insert this code anywhere in your &lt;body&gt; tag. To use with react and other libs, check our <a class='link-color' href='https://langflow.org/guidelines/widget'>documentation</a>.",mode:"html",image:"https://cdn-icons-png.flaticon.com/512/5968/5968350.png",language:"html",code:e[4]}];return s&&r.splice(1,0,{name:"Webhook cURL",mode:"bash",image:"https://curl.se/logo/curl-symbol-transparent.png",language:"sh",code:e[1]}),n&&r.push({name:"Tweaks",mode:"python",image:"https://cdn-icons-png.flaticon.com/512/5968/5968350.png",language:"py",code:e[5]}),r}const Rt=p.forwardRef(({flow:e,children:s},n)=>{const r=U(j=>j.tweak),c=U(j=>j.setTweak),i=U(j=>j.setTweaksList),h=U(j=>j.tweaksList),[f,d]=p.useState(!1),{autoLogin:l}=p.useContext(Je),[y,x]=p.useState(!1),[b,_]=p.useState("0"),T=ve(e==null?void 0:e.id,l,r,e==null?void 0:e.endpoint_name),P=ke(e==null?void 0:e.id,l,r,e==null?void 0:e.endpoint_name),a=Nt(e==null?void 0:e.id,l,e==null?void 0:e.endpoint_name),g=we(e==null?void 0:e.name,r),o=_e(e==null?void 0:e.id,e==null?void 0:e.name,l),u=e.webhook,O=be(e),k=[P,a,T,g,o,g],[m,v]=p.useState(Y(k,u)),$e=e&&e.data&&e.data.nodes&&r&&(r==null?void 0:r.length)>0&&f===!0,ie=()=>{const j=[],C=be(e);j.push(C),c(j),ce(j)};p.useEffect(()=>{e.data.nodes.length==0?(c([]),i([])):ie(),Re(),Object.keys(O).length>0&&_("0"),v(Y(k,u,!0))},[e.data.nodes,y]),p.useEffect(()=>{$e?e.data.nodes.forEach(C=>{const D=C.id,I=C.data.node.template;Object.keys(I).forEach(w=>{It(C,w)&&le(D,C.data.node.template[w].value,C.data.node.template[w])})}):ie()},[f]);const Re=()=>{i(Lt(e))};async function le(j,C,D){C=At(C,D);const I=r.find(w=>w.hasOwnProperty(j));if(I)I[j][D.name]=C,I[j][D.name]==D.value&&r.forEach(w=>{var de;if(w[j]&&((de=Object.keys(w[j]))==null?void 0:de.length)===0){const Se=r.filter(ue=>{const V=ue[Object.keys(ue)[0]].prop;return V!=null&&V!==""});c(Se)}});else{const w={[j]:{[D.name]:C}};r.push(w)}if(r&&r.length>0){const w=G.cloneDeep(r);ce(w),c(w)}}const ce=j=>{const C=ve(e==null?void 0:e.id,l,j),D=ke(e==null?void 0:e.id,l,j,e==null?void 0:e.endpoint_name),I=we(e==null?void 0:e.name,j),w=_e(e==null?void 0:e.id,e==null?void 0:e.name,l);m&&(m==null?void 0:m.length)>0&&(m[0].code=D,m[1].code=C,m[2].code=I,m[3].code=w)};return t.jsxs(W,{open:y,setOpen:x,children:[t.jsx(W.Trigger,{asChild:!0,children:s}),t.jsxs(W.Header,{description:Xe,children:[t.jsx("span",{className:"pr-2",children:"API"}),t.jsx(E,{name:"Code2",className:"h-6 w-6 pl-1 text-gray-800 dark:text-white","aria-hidden":"true"})]}),t.jsx(W.Content,{children:t.jsx(tt,{flow:e,tabs:m,activeTab:b,setActiveTab:_,tweaks:{tweak:r,tweaksList:h,buildContent:Dt,buildTweakObject:le,getValue:$t},activeTweaks:f,setActiveTweaks:d,allowExport:!0})})]})}),St=Rt;function Ft(){const[e,s]=p.useState(!1),n=K(d=>d.hasIO),r=R(d=>d.hasStore),c=R(d=>d.validApiKey),i=R(d=>d.hasApiKey),h=N(d=>d.currentFlow);p.useEffect(()=>{const d=l=>{(l.key==="K"||l.key==="k")&&(l.metaKey||l.ctrlKey)&&K.getState().hasIO&&(l.preventDefault(),s(y=>!y))};return document.addEventListener("keydown",d),()=>{document.removeEventListener("keydown",d)}},[]),p.useRef();const f=p.useMemo(()=>t.jsx(Ae,{is_component:!1,component:h,disabled:!i||!c||!r,children:t.jsxs("button",{disabled:!i||!c||!r,className:S("relative inline-flex h-full w-full items-center justify-center gap-[4px] bg-muted px-5 py-3 text-sm font-semibold text-foreground transition-all duration-150 ease-in-out hover:bg-background hover:bg-hover ",!i||!c||!r?" button-disable text-muted-foreground  ":""),children:[t.jsx(E,{name:"Share3",className:S("-m-0.5 -ml-1 h-6 w-6",!i||!c||!r?"extra-side-bar-save-disable":"")}),"Share"]})}),[i,c,h,r]);return t.jsx(t.Fragment,{children:t.jsx(Ve,{show:!0,appear:!0,enter:"transition ease-out duration-300",enterFrom:"translate-y-96",enterTo:"translate-y-0",leave:"transition ease-in duration-300",leaveFrom:"translate-y-0",leaveTo:"translate-y-96",children:t.jsx("div",{className:"shadow-round-btn-shadow hover:shadow-round-btn-shadow message-button-position flex items-center justify-center gap-7 rounded-sm  border bg-muted shadow-md transition-all",children:t.jsxs("div",{className:"flex",children:[t.jsx("div",{className:"flex h-full w-full  gap-1 rounded-sm transition-all",children:n?t.jsx(st,{open:e,setOpen:s,disable:!n,children:t.jsxs("div",{className:"relative inline-flex w-full items-center justify-center   gap-1 px-5 py-3 text-sm font-semibold transition-all duration-500 ease-in-out hover:bg-hover",children:[t.jsx(E,{name:"BotMessageSquareIcon",className:" h-5 w-5 transition-all"}),"Playground"]})}):t.jsxs("div",{className:"relative inline-flex w-full cursor-not-allowed items-center justify-center gap-1 px-5 py-3 text-sm font-semibold text-muted-foreground transition-all duration-150 ease-in-out ease-in-out",children:[t.jsx(E,{name:"BotMessageSquareIcon",className:" h-5 w-5 transition-all"}),"Playground"]})}),t.jsx("div",{children:t.jsx(Z,{orientation:"vertical"})}),t.jsx("div",{className:"flex cursor-pointer items-center gap-2",children:h&&h.data&&t.jsx(St,{flow:h,children:t.jsxs("div",{className:S("relative inline-flex w-full items-center justify-center gap-1 px-5 py-3 text-sm font-semibold text-foreground transition-all duration-150 ease-in-out hover:bg-hover"),children:[t.jsx(E,{name:"Code2",className:" h-5 w-5"}),"API"]})})}),t.jsx("div",{children:t.jsx(Z,{orientation:"vertical"})}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("div",{className:`side-bar-button ${!i||!c||!r?" cursor-not-allowed":" cursor-pointer"}`,children:f})})]})})})})}function Ce({button:{title:e,Icon:s,buttons:n=[]},isChild:r=!0,children:c,openDisc:i}){return t.jsx(F,{as:"div",defaultOpen:i,children:({open:h})=>t.jsxs(t.Fragment,{children:[t.jsx("div",{children:t.jsxs(F.Button,{className:r?"components-disclosure-arrangement-child":"components-disclosure-arrangement","data-testid":`disclosure-${e.toLocaleLowerCase()}`,children:[t.jsxs("div",{className:"flex gap-4"+(r?" pl-2":""),children:[t.jsx(s,{strokeWidth:1.5,size:22,className:"text-primary"}),t.jsx("span",{className:"components-disclosure-title",children:e})]}),t.jsxs("div",{className:"components-disclosure-div",children:[n.map((f,d)=>t.jsx("button",{onClick:f.onClick,children:f.Icon},d)),t.jsx("div",{children:t.jsx(E,{name:"ChevronRight",className:`${h||i?"rotate-90 transform":""} h-4 w-4 text-foreground`})})]})]})}),t.jsx(F.Panel,{as:"div",children:c})]})},e)}function Mt({button:{title:e,Icon:s,buttons:n=[]},children:r,openDisc:c,testId:i}){return t.jsx(F,{as:"div",defaultOpen:c,children:({open:h})=>t.jsxs(t.Fragment,{children:[t.jsx("div",{children:t.jsxs(F.Button,{className:"parent-disclosure-arrangement","data-testid":i,children:[t.jsx("div",{className:"flex gap-4",children:t.jsx("span",{className:"parent-disclosure-title ",children:e})}),t.jsxs("div",{className:"components-disclosure-div",children:[n.map((f,d)=>t.jsx("button",{onClick:f.onClick,children:f.Icon},d)),t.jsx("div",{children:t.jsx(E,{name:"ChevronsUpDownIcon",className:" h-4 w-4 text-foreground"})})]})]})}),t.jsx(F.Panel,{as:"div",children:r})]})},e)}const Kt=p.forwardRef(({sectionName:e,display_name:s,itemName:n,error:r,color:c,onDragStart:i,apiClass:h,official:f},d)=>{const[l,y]=p.useState(!1),x=N(o=>o.deleteComponent),b=Ie(o=>o.version),[_,T]=p.useState({x:0,y:0}),P=p.useRef(null),a=o=>{var u;if(!l){const O=((u=P.current)==null?void 0:u.getBoundingClientRect())??{left:0,top:0};T({x:o.clientX-O.left,y:o.clientY-O.top})}};function g(o){switch(o){case"share":break;case"download":const u=Q(n);Ye(qe({id:ze(u),type:u,node:h},b));break;case"delete":x(s);break}}return t.jsx(nt,{onValueChange:g,onOpenChange:o=>y(o),open:l,children:t.jsx("div",{onPointerDown:a,onContextMenuCapture:o=>{o.preventDefault(),y(!0)},"data-tooltip-id":n,children:t.jsx("div",{draggable:!r,className:"side-bar-components-border bg-background"+(r?" cursor-not-allowed select-none":""),style:{borderLeftColor:c},onDragStart:i,onDragEnd:()=>{document.body.removeChild(document.getElementsByClassName("cursor-grabbing")[0])},children:t.jsxs("div",{"data-testid":e+s,id:e+s,className:"side-bar-components-div-form",children:[t.jsx("span",{className:"side-bar-components-text",children:s}),t.jsxs("div",{ref:P,children:[t.jsx(E,{name:"Menu",className:"side-bar-components-icon "}),t.jsx(at,{}),t.jsxs(rt,{position:"popper",side:"bottom",sideOffset:-25,style:{position:"absolute",left:_.x,top:_.y},children:[t.jsxs(fe,{value:"download",children:[t.jsxs("div",{className:"flex",children:[t.jsx(E,{name:"Download",className:"relative top-0.5 mr-2 h-4 w-4"})," ","Download"," "]})," "]}),!f&&t.jsxs(fe,{value:"delete",children:[t.jsxs("div",{className:"flex",children:[t.jsx(E,{name:"Trash2",className:"relative top-0.5 mr-2 h-4 w-4"})," ","Delete"," "]})," "]})]})]})]})})},n)},n)}),Ee=Kt;function Te(e,s){const n=M.indexOf(e.toLowerCase()),r=M.indexOf(s.toLowerCase());return n!==-1&&r!==-1?n-r:n!==-1?-1:r!==-1?1:e.localeCompare(s)}function Oe(e,s){const n=/(.+) \((\w+)\)/,r=e.match(n),c=s.match(n);if(r&&c){const i=r[1],h=c[1];if(i!==h)return i.localeCompare(h);const f=parseInt(r[2]),d=parseInt(c[2]);return f-d}else return e.localeCompare(s)}function Wt(){const e=he(a=>a.data),s=he(a=>a.templates),n=K(a=>a.getFilterEdge),r=K(a=>a.setFilterEdge);N(a=>a.uploadFlow);const c=N(a=>a.currentFlow),i=R(a=>a.hasStore),h=R(a=>a.hasApiKey),f=R(a=>a.validApiKey),d=Ge(a=>a.setErrorData),[l,y]=p.useState(e),[x,b]=p.useState("");function _(a,g){var o=a.currentTarget.cloneNode(!0);o.style.position="absolute",o.style.top="-500px",o.style.right="-500px",o.classList.add("cursor-grabbing"),document.body.appendChild(o),a.dataTransfer.setDragImage(o,0,0),a.dataTransfer.setData("nodedata",JSON.stringify(g))}function T(a){if(a===""){y(e);return}y(g=>{let o={};return Object.keys(e).forEach((u,O)=>{o[u]={},Object.keys(e[u]).filter(m=>{var v;return m.toLowerCase().includes(a.toLowerCase())||((v=e[u][m].display_name)==null?void 0:v.toLowerCase().includes(a.toLowerCase()))}).forEach(m=>{o[u][m]=e[u][m]})}),o})}p.useEffect(()=>{let a=[];Object.keys(s).forEach(g=>{s[g].error&&a.push(g)}),a.length>0&&d({title:" Components with errors: ",list:a})},[]);function P(){(!x&&x===""||x==="search")&&(y(e),r([]),b(""))}return p.useEffect(()=>{n.length!==0&&b(""),n.length===0&&x===""&&(b(""),y(e))},[n,e]),p.useEffect(()=>{T(x)},[e]),p.useEffect(()=>{(n==null?void 0:n.length)>0&&y(a=>{let g=G.cloneDeep(e),o={};return Object.keys(g).forEach((u,O)=>{if(o[u]={},n.some(k=>k.family===u)){o[u]=g[u];const k=n.filter(m=>m.family===u).pop().type.split(",");for(let m=0;m<k.length;m++)k[m]=k[m].trimStart();if(k.some(m=>m!=="")){let m=Object.keys(g[u]).filter(v=>k.includes(v));Object.keys(g[u]).forEach(v=>{m.includes(v)||delete o[u][v]})}}}),b(""),o})},[n]),p.useEffect(()=>{(n==null?void 0:n.length)>0&&y(a=>{let g=G.cloneDeep(e),o={};return Object.keys(g).forEach((u,O)=>{if(o[u]={},n.some(k=>k.family===u)){o[u]=g[u];const k=n.filter(m=>m.family===u).pop().type.split(",");for(let m=0;m<k.length;m++)k[m]=k[m].trimStart();if(k.some(m=>m!=="")){let m=Object.keys(g[u]).filter(v=>k.includes(v));Object.keys(g[u]).forEach(v=>{m.includes(v)||delete o[u][v]})}}}),b(""),o})},[n,e]),p.useMemo(()=>t.jsx(Ae,{is_component:!1,component:c,disabled:!h||!f||!i,children:t.jsxs("button",{disabled:!h||!f||!i,className:S("extra-side-bar-buttons gap-[4px] text-sm font-semibold",!h||!f||!i?"button-disable  cursor-default text-muted-foreground":""),children:[t.jsx(E,{name:"Share3",className:S("-m-0.5 -ml-1 h-6 w-6",!h||!f||!i?"extra-side-bar-save-disable":"")}),"Share"]})}),[h,f,c,i]),p.useMemo(()=>t.jsx(lt,{children:t.jsx("button",{className:S("extra-side-bar-buttons"),children:t.jsx(E,{name:"FileDown",className:"side-bar-button-size"})})}),[]),p.useMemo(()=>a=>{if(L[a])return t.jsx(E,{name:a,strokeWidth:1.5,className:"w-[22px] text-primary"})},[]),t.jsxs("div",{className:"side-bar-arrangement",children:[t.jsxs("div",{className:"side-bar-search-div-placement",children:[t.jsx(ct,{onFocusCapture:()=>P(),value:x,type:"text",name:"search",id:"search",placeholder:"Search",className:"nopan nodelete nodrag noundo nocopy input-search",onChange:a=>{T(a.target.value),b(a.target.value)}}),t.jsx("div",{className:"search-icon ",onClick:()=>{x&&(y(e),b(""))},children:t.jsx(E,{name:x?"X":"Search",className:`h-5 w-5 stroke-[1.5] text-primary ${x?"cursor-pointer":"cursor-default"}`,"aria-hidden":"true"})})]}),t.jsx(Z,{}),t.jsxs("div",{className:"side-bar-components-div-arrangement",children:[t.jsx("div",{className:"parent-disclosure-arrangement",children:t.jsx("div",{className:"flex items-center gap-4 align-middle",children:t.jsx("span",{className:"parent-disclosure-title",children:"Basic Components"})})}),Object.keys(l).sort(Te).filter(a=>M.includes(a)).map((a,g)=>Object.keys(l[a]).length>0?t.jsx(t.Fragment,{children:t.jsx(Ce,{openDisc:n.length!==0||x.length!==0,isChild:!1,button:{title:H[a]??H.unknown,Icon:L[a]??L.unknown},children:t.jsx("div",{className:"side-bar-components-gap",children:Object.keys(l[a]).sort((o,u)=>Oe(l[a][o].display_name,l[a][u].display_name)).map((o,u)=>t.jsx(ge,{content:l[a][o].display_name,side:"right",children:t.jsx(Ee,{sectionName:a,apiClass:l[a][o],onDragStart:O=>_(O,{type:Q(o),node:l[a][o]}),color:me[a],itemName:o,error:!!l[a][o].error,display_name:l[a][o].display_name,official:l[a][o].official!==!1},u+o)},u))})},g+x+JSON.stringify(n))}):t.jsx("div",{},g))," ",t.jsx(Mt,{openDisc:!1,button:{title:"Advanced",Icon:L.unknown},testId:"extended-disclosure",children:Object.keys(l).sort(Te).filter(a=>!M.includes(a)).map((a,g)=>Object.keys(l[a]).length>0?t.jsxs(t.Fragment,{children:[t.jsx(Ce,{isChild:!1,openDisc:n.length!==0||x.length!==0,button:{title:H[a]??H.unknown,Icon:L[a]??L.unknown},children:t.jsx("div",{className:"side-bar-components-gap",children:Object.keys(l[a]).sort((o,u)=>Oe(l[a][o].display_name,l[a][u].display_name)).map((o,u)=>t.jsx(ge,{content:l[a][o].display_name,side:"right",children:t.jsx(Ee,{sectionName:a,apiClass:l[a][o],onDragStart:O=>_(O,{type:Q(o),node:l[a][o]}),color:me[a],itemName:o,error:!!l[a][o].error,display_name:l[a][o].display_name,official:l[a][o].official!==!1},u)},u))})},g+x+JSON.stringify(n)),g===Object.keys(l).length-M.length+1&&t.jsx(t.Fragment,{children:t.jsxs("a",{target:"_blank",href:"https://langflow.store",className:"components-disclosure-arrangement",children:[t.jsxs("div",{className:"flex gap-4",children:[t.jsx(Qe,{strokeWidth:1.5,className:"w-[22px] text-primary"}),t.jsx("span",{className:"components-disclosure-title",children:"Discover More"})]}),t.jsx("div",{className:"components-disclosure-div",children:t.jsx("div",{children:t.jsx(Ze,{className:"h-4 w-4 text-foreground"})})})]})})]}):t.jsx("div",{},g))},"Advanced")]})]})}function is({view:e}){const s=N(d=>d.setCurrentFlowId),n=Ie(d=>d.version),r=K(d=>d.setOnFlowPage),c=N(d=>d.currentFlow),{id:i}=Be(),h=et(),f=N(d=>d.flows);return p.useEffect(()=>{if(!f.some(l=>l.id===i)){h("/all");return}return s(i),r(!0),()=>{r(!1)}},[i]),t.jsxs(t.Fragment,{children:[t.jsx(it,{}),t.jsxs("div",{className:"flow-page-positioning",children:[c&&t.jsxs("div",{className:"flex h-full overflow-hidden",children:[!e&&t.jsx(Wt,{}),t.jsxs("main",{className:"flex flex-1",children:[t.jsx("div",{className:"h-full w-full",children:t.jsx(ot,{flow:c})}),!e&&t.jsx(Ft,{})]})]}),t.jsxs("a",{target:"_blank",href:"https://medium.com/logspace/langflow-datastax-better-together-1b7462cebc4d",className:"langflow-page-icon",children:[n&&t.jsx("div",{className:"mt-1",children:"Langflow 🤝 DataStax"}),t.jsxs("div",{className:n?"mt-2":"mt-1",children:["⛓️ v",n]})]})]})]})}export{is as default};
