import{ae as x,r as a,A as te,u as se,h as _,as as ae,y as le,bi as K,bj as oe,bk as re,bl as ne,bm as ie,bn as de,j as e,bo as ce,bp as ue,f as pe,J as me,I as L,t as O,bd as he,at as xe}from"./index-86768d23.js";import{I as ge,C as fe,S as C}from"./index-f9720a8a.js";import{P as be}from"./index-2f6eef1f.js";import{S as je}from"./index-6451e54f.js";import{P as Se}from"./index-f53f071d.js";import{T as ve}from"./index-451a671a.js";import{S as V,f as z,g as B,h as D,i as we,j as u}from"./table-691b62af.js";import"./index-e833f93c.js";import"./tabs-4a607088.js";import"./index-b796a12f.js";import"./input-13e7a0de.js";import"./textarea-04e722a8.js";import"./index-7b70fec0.js";import"./popover-270ec558.js";import"./index-9a10118c.js";import"./index-99b92aac.js";import"./form-9391738a.js";import"./index-0d54d933.js";import"./index-f1496333.js";import"./index-b7b8f00f.js";function qe(){const c=x(t=>t.hasApiKey),l=x(t=>t.validApiKey),p=x(t=>t.loadingApiKey),g=x(t=>t.updateValidApiKey),{apiKey:M}=a.useContext(te),f=se(t=>t.setErrorData),q=_(t=>t.setCurrentFlowId),G=_(t=>t.currentFlowId),[s,m]=a.useState(!0),[Y,b]=a.useState(!0),{id:h}=ae(),[i,J]=a.useState([]),[j,U]=a.useState(""),[r,N]=a.useState([]),[S,A]=a.useState(0),[v,T]=a.useState(12),[w,E]=a.useState(1),[I,X]=a.useState("Popular"),[$,H]=a.useState([]),[n,y]=a.useState("All"),[Q,P]=a.useState(""),[d,R]=a.useState("all"),W=le();a.useEffect(()=>{p||(c?l||f({title:K,list:[re]}):(f({title:K,list:[oe]}),m(!1)))},[p,l,c,G]),a.useEffect(()=>{Z(),ee()},[n,I,w,v,i,d,l,c,M,Q,p,h]);function Z(){b(!0),ne().then(t=>{H(t),b(!1)}).catch(t=>{console.log(t),b(!1)})}function ee(){p||(m(!0),ie({component_id:h,page:w,limit:v,is_component:n==="All"?null:n!=="Flows",sort:I==="Popular"?"-count(downloads)":"name",tags:i,liked:d==="likedbyme"&&l?!0:null,isPrivate:null,search:j===""?null:j,filterByUser:d==="createdbyme"&&l?!0:null}).then(t=>{var o;!(t!=null&&t.authorized)&&l===!0?(g(!1),R("all")):(t!=null&&t.authorized&&g(!0),m(!1),N((t==null?void 0:t.results)??[]),A((i==null?void 0:i.length)===0?Number((t==null?void 0:t.count)??0):((o=t==null?void 0:t.results)==null?void 0:o.length)??0))}).catch(t=>{var o,k;((o=t.response)==null?void 0:o.status)===403||((k=t.response)==null?void 0:k.status)===401?g(!1):(N([]),A(0),m(!1),f({title:de,list:[t.response.data.detail]}))}))}a.useEffect(()=>{q("")},[]);function F(){E(1),T(12)}return e.jsx(be,{betaIcon:!0,title:ce,description:ue,button:e.jsxs(pe,{"data-testid":"api-key-button-store",disabled:s,className:me(`${l?"":"animate-pulse border-error"}`,s?"cursor-not-allowed":""),variant:"primary",onClick:()=>{W("/settings/general/api")},children:[e.jsx(L,{name:"Key",className:"mr-2 w-4"}),"API Key"]}),children:e.jsxs("div",{className:"flex h-full w-full flex-col justify-between",children:[e.jsxs("div",{className:"flex w-full flex-col gap-4 p-0",children:[e.jsxs("div",{className:"flex items-end gap-4",children:[e.jsx(ge,{loading:s,divClasses:"relative h-12 w-[40%]",value:j,onChange:t=>U(t.target.value),onKeyDown:t=>{t.key==="Enter"&&P(O.uniqueId())},onClick:()=>{P(O.uniqueId())}}),e.jsxs("div",{className:"ml-4 flex w-full gap-2 border-b border-border",children:[e.jsx("button",{"data-testid":"all-button-store",disabled:s,onClick:()=>{y("All")},className:(n==="All"?"border-b-2 border-primary p-3":" border-b-2 border-transparent p-3 text-muted-foreground hover:text-primary")+(s?" cursor-not-allowed ":""),children:"All"}),e.jsx("button",{"data-testid":"flows-button-store",disabled:s,onClick:()=>{F(),y("Flows")},className:(n==="Flows"?"border-b-2 border-primary p-3":" border-b-2 border-transparent p-3 text-muted-foreground hover:text-primary")+(s?" cursor-not-allowed ":""),children:"Flows"}),e.jsx("button",{"data-testid":"components-button-store",disabled:s,onClick:()=>{F(),y("Components")},className:(n==="Components"?"border-b-2 border-primary p-3":" border-b-2 border-transparent p-3 text-muted-foreground hover:text-primary")+(s?" cursor-not-allowed ":""),children:"Components"}),e.jsx(je,{content:"Coming Soon",children:e.jsx("button",{className:"cursor-not-allowed p-3 text-muted-foreground",children:"Bundles"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(V,{disabled:s,onValueChange:R,value:d,children:[e.jsx(z,{className:"mr-4 w-[160px] flex-shrink-0",children:e.jsx(B,{placeholder:"Filter Values"})}),e.jsx(D,{children:e.jsxs(we,{children:[e.jsx(u,{value:"all",children:"All"}),e.jsx(u,{disabled:!c||!l,value:"createdbyme",children:"Created By Me"}),e.jsx(u,{disabled:!c||!l,value:"likedbyme",children:"Liked By Me"})]})})]}),h===void 0?e.jsx(ve,{tags:$,loadingTags:Y,disabled:s,selectedTags:i,setSelectedTags:J}):e.jsxs(he,{variant:"outline",size:"sq",className:"gap-2 bg-beta-foreground text-background hover:bg-beta-foreground",children:[e.jsx(xe,{to:"/store",className:"cursor-pointer",children:e.jsx(L,{name:"X",className:"h-4 w-4"})}),h]},"id")]}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsx("span",{className:"px-0.5 text-sm text-muted-foreground",children:(!s||r.length!==0)&&e.jsxs(e.Fragment,{children:[S," ",S!==1?"results":"result"]})}),e.jsxs(V,{disabled:s,onValueChange:t=>{X(t)},children:[e.jsx(z,{"data-testid":"select-order-store",children:e.jsx(B,{placeholder:"Popular"})}),e.jsxs(D,{children:[e.jsx(u,{value:"Popular",children:"Popular"}),e.jsx(u,{value:"Alphabetical",children:"Alphabetical"})]})]})]}),e.jsx("div",{className:"grid w-full gap-4 md:grid-cols-2 lg:grid-cols-3",children:!s||r.length!==0?r.map(t=>{var o;return e.jsx(e.Fragment,{children:e.jsx(fe,{data:t,authorized:l,disabled:s,playground:((o=t.last_tested_version)==null?void 0:o.includes("1.0.0"))&&!t.is_component},t.id)})}):e.jsxs(e.Fragment,{children:[e.jsx(C,{}),e.jsx(C,{}),e.jsx(C,{})]})}),!s&&(r==null?void 0:r.length)===0&&e.jsx("div",{className:"mt-6 flex w-full items-center justify-center text-center",children:e.jsx("div",{className:"flex h-full w-full flex-col",children:e.jsx("div",{className:"flex w-full flex-col gap-4",children:e.jsx("div",{className:"grid w-full gap-4",children:d!="all"?e.jsxs(e.Fragment,{children:["You haven't"," ",d==="createdbyme"?"created":"liked"," ","anything with the selected filters yet."]}):e.jsxs(e.Fragment,{children:["There are no"," ",n=="Flows"?"Flows":"Components"," with the selected filters."]})})})})})]}),!s&&r.length>0&&e.jsx("div",{className:"relative py-6",children:e.jsx(Se,{storeComponent:!0,pageIndex:w,pageSize:v,totalRowsCount:S,paginate:(t,o)=>{E(o),T(t)}})})]})})}export{qe as default};
