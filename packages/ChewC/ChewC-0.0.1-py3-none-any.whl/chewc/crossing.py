# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/04_crossing.ipynb.

# %% auto 0
__all__ = ['make_DH', 'make_cross', 'truncate_select']

# %% ../nbs/04_crossing.ipynb 4
from .core import *
from .meiosis import *
from .trait import *
import torch
import random
def make_DH(genetic_map, individual):
    haploid_line = simulate_gametes(genetic_map, individual)
    return gamete.repeat(2, 1, 1)

# %% ../nbs/04_crossing.ipynb 5
def make_cross(genetic_map, mother, father):
    egg = simulate_gametes(genetic_map, mother)  # Simulating gametes for the mother
    pollen = simulate_gametes(genetic_map, father)  # Simulating gametes for the father
    return torch.stack((egg, pollen), dim=0).squeeze(1)

# %% ../nbs/04_crossing.ipynb 6
def truncate_select(tgv):
    return torch.topk(tgv,20).indices
