import{s as Gt,E as oe,F as ie,G as ae,H as ce,w as it,e as Ht,i as U,d as m,I as Ce,x as me,y as un,p as Et,f as E,g as I,h as k,L as re,Y as ke,u as et,v as de,T as He,W as Ot,P as ue,V as De,j as f,K as pe,l as bt,a as Q,m as wt,c as Y,r as _,n as Vt,R as Zt,S as ve,k as Te,t as Bt,z as _t,A as vt,C as kt,o as Ye,Q as nl,O as kn,M as yn}from"./scheduler.8ceb707f.js";import{S as Jt,i as Qt,a as O,t as z,g as zt,c as Rt,h as fn,j as dn,k as Ve,f as Ut,b as at,d as ct,m as ut,e as ft}from"./index.552978e5.js";import{g as En}from"./globals.7f7f1b26.js";import{e as $t}from"./each.15ac4e72.js";import{a as pt}from"./Toaster.svelte_svelte_type_style_lang.a1b53f72.js";import{M as In,m as Sn}from"./Messages.ba9db01c.js";import{f as sl}from"./dayjs.min.08f51e5f.js";import{g as xe}from"./navigation.80b95902.js";import{p as Dn}from"./stores.4f628084.js";import{w as Be,c as Me,g as fe,p as Mn,q as Cn,h as Ae,k as Ne,m as mn,a as Le,S as rl,x as ol,W as hn,j as be,u as gn,l as Tn,s as Vn,r as Bn,i as Ie,O as Nn}from"./index.ee5c1e61.js";import{f as Xe,h as Ln,i as pn,r as Ge,j as il,v as al,p as cl,s as Hn,a as ul,k as An}from"./index.485e0f6b.js";import{i as On}from"./index.14c42508.js";import{u as Un,o as fl,c as Pn,b as Se,k as Je,j as zn,y as Rn}from"./index.1f05aec2.js";import{f as jn}from"./index.50d2829f.js";import{i as Fn,j as qn,k as Wn,l as Zn}from"./index.1bec2f68.js";import{T as xn,S as Gn,U as Jn,q as Qn}from"./UserMenu.6f96e892.js";import{r as Yn,s as Xn,t as Kn}from"./index.a3dba704.js";import{A as $n}from"./AddFilesPlaceholder.62406f9a.js";import"./sha256.8dba905a.js";import{T as ge}from"./Tooltip.653c5973.js";import{f as _n,h as ts}from"./updater.e153cbf1.js";import{D as Ke,M as we}from"./Dropdown.4f0533e0.js";import{s as es,g as ls,u as ns,a as ss,M as $e}from"./menu-trigger.1e780b67.js";import{f as Oe}from"./index.e8e699b3.js";import{S as rs,b as os}from"./Switch.7c13432f.js";import{t as vn,s as is}from"./index.3e98418a.js";import{S as as}from"./Selector.b6d02b5e.js";import{d as cs}from"./index.e51049e7.js";import{g as ye}from"./spread.8a54911c.js";import{f as us}from"./FileSaver.min.898eb36f.js";import"./singletons.83918706.js";import{M as fs}from"./MenuLines.8050dee4.js";import"./index.c4ca6160.js";const ds=s=>({subIds:s&1}),dl=s=>({subIds:s[0]});function ms(s){let t;const e=s[6].default,l=oe(e,s,s[5],dl);return{c(){l&&l.c()},l(n){l&&l.l(n)},m(n,o){l&&l.m(n,o),t=!0},p(n,[o]){l&&l.p&&(!t||o&33)&&ie(l,e,n,n[5],t?ce(e,n[5],o,ds):ae(n[5]),dl)},i(n){t||(O(l,n),t=!0)},o(n){z(l,n),t=!1},d(n){l&&l.d(n)}}}function hs(s,t,e){let l,{$$slots:n={},$$scope:o}=t,{disabled:r=void 0}=t,{open:i=void 0}=t,{onOpenChange:a=void 0}=t;const{updateOption:u,ids:c,states:{subOpen:d}}=es({disabled:r,onOpenChange:({next:p})=>(i!==p&&(a==null||a(p),e(2,i=p)),p)}),g=cs([c.menu,c.trigger],([p,S])=>({menu:p,trigger:S}));return it(s,g,p=>e(0,l=p)),s.$$set=p=>{"disabled"in p&&e(3,r=p.disabled),"open"in p&&e(2,i=p.open),"onOpenChange"in p&&e(4,a=p.onOpenChange),"$$scope"in p&&e(5,o=p.$$scope)},s.$$.update=()=>{s.$$.dirty&4&&i!==void 0&&d.set(i),s.$$.dirty&8&&u("disabled",r)},[l,g,i,r,a,o,n]}class gs extends Jt{constructor(t){super(),Qt(this,t,hs,ms,Gt,{disabled:3,open:2,onOpenChange:4})}}const ps=s=>({builder:s[0]&256}),ml=s=>({builder:s[8]}),_s=s=>({builder:s[0]&256}),hl=s=>({builder:s[8]}),vs=s=>({builder:s[0]&256}),gl=s=>({builder:s[8]}),bs=s=>({builder:s[0]&256}),pl=s=>({builder:s[8]}),ws=s=>({builder:s[0]&256}),_l=s=>({builder:s[8]}),ks=s=>({builder:s[0]&256}),vl=s=>({builder:s[8]});function ys(s){let t,e,l,n;const o=s[28].default,r=oe(o,s,s[27],ml);let i=[s[8],s[13]],a={};for(let u=0;u<i.length;u+=1)a=me(a,i[u]);return{c(){t=E("div"),r&&r.c(),this.h()},l(u){t=I(u,"DIV",{});var c=k(t);r&&r.l(c),c.forEach(m),this.h()},h(){re(t,a)},m(u,c){U(u,t,c),r&&r.m(t,null),s[33](t),e=!0,l||(n=[ke(s[8].action(t)),et(t,"m-focusout",s[12]),et(t,"m-keydown",s[12]),et(t,"m-pointermove",s[12])],l=!0)},p(u,c){r&&r.p&&(!e||c[0]&134217984)&&ie(r,o,u,u[27],e?ce(o,u[27],c,ps):ae(u[27]),ml),re(t,a=ye(i,[c[0]&256&&u[8],c[0]&8192&&u[13]]))},i(u){e||(O(r,u),e=!0)},o(u){z(r,u),e=!1},d(u){u&&m(t),r&&r.d(u),s[33](null),l=!1,de(n)}}}function Es(s){let t,e,l,n,o;const r=s[28].default,i=oe(r,s,s[27],hl);let a=[s[8],s[13]],u={};for(let c=0;c<a.length;c+=1)u=me(u,a[c]);return{c(){t=E("div"),i&&i.c(),this.h()},l(c){t=I(c,"DIV",{});var d=k(t);i&&i.l(d),d.forEach(m),this.h()},h(){re(t,u)},m(c,d){U(c,t,d),i&&i.m(t,null),s[32](t),l=!0,n||(o=[ke(s[8].action(t)),et(t,"m-focusout",s[12]),et(t,"m-keydown",s[12]),et(t,"m-pointermove",s[12])],n=!0)},p(c,d){s=c,i&&i.p&&(!l||d[0]&134217984)&&ie(i,r,s,s[27],l?ce(r,s[27],d,_s):ae(s[27]),hl),re(t,u=ye(a,[d[0]&256&&s[8],d[0]&8192&&s[13]]))},i(c){l||(O(i,c),e&&e.end(1),l=!0)},o(c){z(i,c),c&&(e=fn(t,s[5],s[6])),l=!1},d(c){c&&m(t),i&&i.d(c),s[32](null),c&&e&&e.end(),n=!1,de(o)}}}function Is(s){let t,e,l,n,o;const r=s[28].default,i=oe(r,s,s[27],gl);let a=[s[8],s[13]],u={};for(let c=0;c<a.length;c+=1)u=me(u,a[c]);return{c(){t=E("div"),i&&i.c(),this.h()},l(c){t=I(c,"DIV",{});var d=k(t);i&&i.l(d),d.forEach(m),this.h()},h(){re(t,u)},m(c,d){U(c,t,d),i&&i.m(t,null),s[31](t),l=!0,n||(o=[ke(s[8].action(t)),et(t,"m-focusout",s[12]),et(t,"m-keydown",s[12]),et(t,"m-pointermove",s[12])],n=!0)},p(c,d){s=c,i&&i.p&&(!l||d[0]&134217984)&&ie(i,r,s,s[27],l?ce(r,s[27],d,vs):ae(s[27]),gl),re(t,u=ye(a,[d[0]&256&&s[8],d[0]&8192&&s[13]]))},i(c){l||(O(i,c),c&&(e||He(()=>{e=dn(t,s[3],s[4]),e.start()})),l=!0)},o(c){z(i,c),l=!1},d(c){c&&m(t),i&&i.d(c),s[31](null),n=!1,de(o)}}}function Ss(s){let t,e,l,n,o,r;const i=s[28].default,a=oe(i,s,s[27],pl);let u=[s[8],s[13]],c={};for(let d=0;d<u.length;d+=1)c=me(c,u[d]);return{c(){t=E("div"),a&&a.c(),this.h()},l(d){t=I(d,"DIV",{});var g=k(t);a&&a.l(g),g.forEach(m),this.h()},h(){re(t,c)},m(d,g){U(d,t,g),a&&a.m(t,null),s[30](t),n=!0,o||(r=[ke(s[8].action(t)),et(t,"m-focusout",s[12]),et(t,"m-keydown",s[12]),et(t,"m-pointermove",s[12])],o=!0)},p(d,g){s=d,a&&a.p&&(!n||g[0]&134217984)&&ie(a,i,s,s[27],n?ce(i,s[27],g,bs):ae(s[27]),pl),re(t,c=ye(u,[g[0]&256&&s[8],g[0]&8192&&s[13]]))},i(d){n||(O(a,d),d&&He(()=>{n&&(l&&l.end(1),e=dn(t,s[3],s[4]),e.start())}),n=!0)},o(d){z(a,d),e&&e.invalidate(),d&&(l=fn(t,s[5],s[6])),n=!1},d(d){d&&m(t),a&&a.d(d),s[30](null),d&&l&&l.end(),o=!1,de(r)}}}function Ds(s){let t,e,l,n,o;const r=s[28].default,i=oe(r,s,s[27],_l);let a=[s[8],s[13]],u={};for(let c=0;c<a.length;c+=1)u=me(u,a[c]);return{c(){t=E("div"),i&&i.c(),this.h()},l(c){t=I(c,"DIV",{});var d=k(t);i&&i.l(d),d.forEach(m),this.h()},h(){re(t,u)},m(c,d){U(c,t,d),i&&i.m(t,null),s[29](t),l=!0,n||(o=[ke(s[8].action(t)),et(t,"m-focusout",s[12]),et(t,"m-keydown",s[12]),et(t,"m-pointermove",s[12])],n=!0)},p(c,d){s=c,i&&i.p&&(!l||d[0]&134217984)&&ie(i,r,s,s[27],l?ce(r,s[27],d,ws):ae(s[27]),_l),re(t,u=ye(a,[d[0]&256&&s[8],d[0]&8192&&s[13]]))},i(c){l||(O(i,c),c&&He(()=>{l&&(e||(e=Ve(t,s[1],s[2],!0)),e.run(1))}),l=!0)},o(c){z(i,c),c&&(e||(e=Ve(t,s[1],s[2],!1)),e.run(0)),l=!1},d(c){c&&m(t),i&&i.d(c),s[29](null),c&&e&&e.end(),n=!1,de(o)}}}function Ms(s){let t;const e=s[28].default,l=oe(e,s,s[27],vl);return{c(){l&&l.c()},l(n){l&&l.l(n)},m(n,o){l&&l.m(n,o),t=!0},p(n,o){l&&l.p&&(!t||o[0]&134217984)&&ie(l,e,n,n[27],t?ce(e,n[27],o,ks):ae(n[27]),vl)},i(n){t||(O(l,n),t=!0)},o(n){z(l,n),t=!1},d(n){l&&l.d(n)}}}function Cs(s){let t,e,l,n;const o=[Ms,Ds,Ss,Is,Es,ys],r=[];function i(a,u){return a[7]&&a[9]?0:a[1]&&a[9]?1:a[3]&&a[5]&&a[9]?2:a[3]&&a[9]?3:a[5]&&a[9]?4:a[9]?5:-1}return~(t=i(s))&&(e=r[t]=o[t](s)),{c(){e&&e.c(),l=Ht()},l(a){e&&e.l(a),l=Ht()},m(a,u){~t&&r[t].m(a,u),U(a,l,u),n=!0},p(a,u){let c=t;t=i(a),t===c?~t&&r[t].p(a,u):(e&&(zt(),z(r[c],1,1,()=>{r[c]=null}),Rt()),~t?(e=r[t],e?e.p(a,u):(e=r[t]=o[t](a),e.c()),O(e,1),e.m(l.parentNode,l)):e=null)},i(a){n||(O(e),n=!0)},o(a){z(e),n=!1},d(a){a&&m(l),~t&&r[t].d(a)}}}function Ts(s,t,e){let l;const n=["transition","transitionConfig","inTransition","inTransitionConfig","outTransition","outTransitionConfig","asChild","id","side","align","sideOffset","alignOffset","collisionPadding","avoidCollisions","collisionBoundary","sameWidth","fitViewport","strategy","overlap","el"];let o=Ce(t,n),r,i,{$$slots:a={},$$scope:u}=t,{transition:c=void 0}=t,{transitionConfig:d=void 0}=t,{inTransition:g=void 0}=t,{inTransitionConfig:p=void 0}=t,{outTransition:S=void 0}=t,{outTransitionConfig:b=void 0}=t,{asChild:h=!1}=t,{id:v=void 0}=t,{side:w="right"}=t,{align:C="start"}=t,{sideOffset:V=0}=t,{alignOffset:B=0}=t,{collisionPadding:D=8}=t,{avoidCollisions:P=!0}=t,{collisionBoundary:L=void 0}=t,{sameWidth:A=!1}=t,{fitViewport:R=!1}=t,{strategy:H="absolute"}=t,{overlap:F=!1}=t,{el:j=void 0}=t;const{elements:{subMenu:M},states:{subOpen:q},ids:ot,getAttrs:Z}=ls();it(s,M,W=>e(26,r=W)),it(s,q,W=>e(9,i=W));const J=_n(),X=Z("sub-content");function lt(W){Et[W?"unshift":"push"](()=>{j=W,e(0,j)})}function At(W){Et[W?"unshift":"push"](()=>{j=W,e(0,j)})}function Pt(W){Et[W?"unshift":"push"](()=>{j=W,e(0,j)})}function Xt(W){Et[W?"unshift":"push"](()=>{j=W,e(0,j)})}function Wt(W){Et[W?"unshift":"push"](()=>{j=W,e(0,j)})}return s.$$set=W=>{t=me(me({},t),un(W)),e(13,o=Ce(t,n)),"transition"in W&&e(1,c=W.transition),"transitionConfig"in W&&e(2,d=W.transitionConfig),"inTransition"in W&&e(3,g=W.inTransition),"inTransitionConfig"in W&&e(4,p=W.inTransitionConfig),"outTransition"in W&&e(5,S=W.outTransition),"outTransitionConfig"in W&&e(6,b=W.outTransitionConfig),"asChild"in W&&e(7,h=W.asChild),"id"in W&&e(14,v=W.id),"side"in W&&e(15,w=W.side),"align"in W&&e(16,C=W.align),"sideOffset"in W&&e(17,V=W.sideOffset),"alignOffset"in W&&e(18,B=W.alignOffset),"collisionPadding"in W&&e(19,D=W.collisionPadding),"avoidCollisions"in W&&e(20,P=W.avoidCollisions),"collisionBoundary"in W&&e(21,L=W.collisionBoundary),"sameWidth"in W&&e(22,A=W.sameWidth),"fitViewport"in W&&e(23,R=W.fitViewport),"strategy"in W&&e(24,H=W.strategy),"overlap"in W&&e(25,F=W.overlap),"el"in W&&e(0,j=W.el),"$$scope"in W&&e(27,u=W.$$scope)},s.$$.update=()=>{s.$$.dirty[0]&16384&&v&&ot.menu.set(v),s.$$.dirty[0]&67108864&&e(8,l=r),s.$$.dirty[0]&256&&Object.assign(l,X),s.$$.dirty[0]&67076096&&ns({side:w,align:C,sideOffset:V,alignOffset:B,collisionPadding:D,avoidCollisions:P,collisionBoundary:L,sameWidth:A,fitViewport:R,strategy:H,overlap:F})},[j,c,d,g,p,S,b,h,l,i,M,q,J,o,v,w,C,V,B,D,P,L,A,R,H,F,r,u,a,lt,At,Pt,Xt,Wt]}class Vs extends Jt{constructor(t){super(),Qt(this,t,Ts,Cs,Gt,{transition:1,transitionConfig:2,inTransition:3,inTransitionConfig:4,outTransition:5,outTransitionConfig:6,asChild:7,id:14,side:15,align:16,sideOffset:17,alignOffset:18,collisionPadding:19,avoidCollisions:20,collisionBoundary:21,sameWidth:22,fitViewport:23,strategy:24,overlap:25,el:0},null,[-1,-1])}}const Bs=s=>({builder:s&4}),bl=s=>({builder:s[2]}),Ns=s=>({builder:s&4}),wl=s=>({builder:s[2]});function Ls(s){let t,e,l,n;const o=s[13].default,r=oe(o,s,s[12],bl);let i=[s[2],s[6]],a={};for(let u=0;u<i.length;u+=1)a=me(a,i[u]);return{c(){t=E("div"),r&&r.c(),this.h()},l(u){t=I(u,"DIV",{});var c=k(t);r&&r.l(c),c.forEach(m),this.h()},h(){re(t,a)},m(u,c){U(u,t,c),r&&r.m(t,null),s[14](t),e=!0,l||(n=[ke(s[2].action(t)),et(t,"m-click",s[5]),et(t,"m-focusin",s[5]),et(t,"m-focusout",s[5]),et(t,"m-keydown",s[5]),et(t,"m-pointerleave",s[5]),et(t,"m-pointermove",s[5])],l=!0)},p(u,c){r&&r.p&&(!e||c&4100)&&ie(r,o,u,u[12],e?ce(o,u[12],c,Bs):ae(u[12]),bl),re(t,a=ye(i,[c&4&&u[2],c&64&&u[6]]))},i(u){e||(O(r,u),e=!0)},o(u){z(r,u),e=!1},d(u){u&&m(t),r&&r.d(u),s[14](null),l=!1,de(n)}}}function Hs(s){let t;const e=s[13].default,l=oe(e,s,s[12],wl);return{c(){l&&l.c()},l(n){l&&l.l(n)},m(n,o){l&&l.m(n,o),t=!0},p(n,o){l&&l.p&&(!t||o&4100)&&ie(l,e,n,n[12],t?ce(e,n[12],o,Ns):ae(n[12]),wl)},i(n){t||(O(l,n),t=!0)},o(n){z(l,n),t=!1},d(n){l&&l.d(n)}}}function As(s){let t,e,l,n;const o=[Hs,Ls],r=[];function i(a,u){return a[1]?0:1}return t=i(s),e=r[t]=o[t](s),{c(){e.c(),l=Ht()},l(a){e.l(a),l=Ht()},m(a,u){r[t].m(a,u),U(a,l,u),n=!0},p(a,[u]){let c=t;t=i(a),t===c?r[t].p(a,u):(zt(),z(r[c],1,1,()=>{r[c]=null}),Rt(),e=r[t],e?e.p(a,u):(e=r[t]=o[t](a),e.c()),O(e,1),e.m(l.parentNode,l))},i(a){n||(O(e),n=!0)},o(a){z(e),n=!1},d(a){a&&m(l),r[t].d(a)}}}function Os(s,t,e){let l,n;const o=["disabled","asChild","id","el"];let r=Ce(t,o),i,a,{$$slots:u={},$$scope:c}=t,{disabled:d=!1}=t,{asChild:g=!1}=t,{id:p=void 0}=t,{el:S=void 0}=t;const{elements:{subTrigger:b},ids:h,getAttrs:v,options:w}=ss();it(s,b,D=>e(11,a=D));const{disabled:C}=w;it(s,C,D=>e(10,i=D));const V=_n();function B(D){Et[D?"unshift":"push"](()=>{S=D,e(0,S)})}return s.$$set=D=>{t=me(me({},t),un(D)),e(6,r=Ce(t,o)),"disabled"in D&&e(7,d=D.disabled),"asChild"in D&&e(1,g=D.asChild),"id"in D&&e(8,p=D.id),"el"in D&&e(0,S=D.el),"$$scope"in D&&e(12,c=D.$$scope)},s.$$.update=()=>{s.$$.dirty&256&&p&&h.trigger.set(p),s.$$.dirty&2048&&e(2,l=a),s.$$.dirty&1152&&e(9,n={...v("sub-trigger"),...ts(d||i)}),s.$$.dirty&516&&Object.assign(l,n)},[S,g,l,b,C,V,r,d,p,n,i,a,c,u,B]}class Us extends Jt{constructor(t){super(),Qt(this,t,Os,As,Gt,{disabled:7,asChild:1,id:8,el:0})}}function kl(s,t,e){const l=s.slice();return l[10]=t[e],l}function Ps(s){let t;const e=s[4].default,l=oe(e,s,s[8],null);return{c(){l&&l.c()},l(n){l&&l.l(n)},m(n,o){l&&l.m(n,o),t=!0},p(n,o){l&&l.p&&(!t||o&256)&&ie(l,e,n,n[8],t?ce(e,n[8],o,null):ae(n[8]),null)},i(n){t||(O(l,n),t=!0)},o(n){z(l,n),t=!1},d(n){l&&l.d(n)}}}function zs(s){var r;let t,e,l=(((r=s[10])==null?void 0:r.label)??"Camera")+"",n,o;return{c(){t=E("div"),e=E("div"),n=bt(l),o=Q(),this.h()},l(i){t=I(i,"DIV",{class:!0});var a=k(t);e=I(a,"DIV",{class:!0});var u=k(e);n=wt(u,l),u.forEach(m),a.forEach(m),o=Y(i),this.h()},h(){f(e,"class","line-clamp-1"),f(t,"class","flex items-center")},m(i,a){U(i,t,a),_(t,e),_(e,n),U(i,o,a)},p(i,a){var u;a&2&&l!==(l=(((u=i[10])==null?void 0:u.label)??"Camera")+"")&&Vt(n,l)},d(i){i&&(m(t),m(o))}}}function yl(s){let t,e;function l(){return s[5](s[10])}return t=new we({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[zs]},$$scope:{ctx:s}}}),t.$on("click",l),{c(){at(t.$$.fragment)},l(n){ct(t.$$.fragment,n)},m(n,o){ut(t,n,o),e=!0},p(n,o){s=n;const r={};o&258&&(r.$$scope={dirty:o,ctx:s}),t.$set(r)},i(n){e||(O(t.$$.fragment,n),e=!0)},o(n){z(t.$$.fragment,n),e=!1},d(n){ft(t,n)}}}function Rs(s){let t,e,l=$t(s[1]),n=[];for(let r=0;r<l.length;r+=1)n[r]=yl(kl(s,l,r));const o=r=>z(n[r],1,1,()=>{n[r]=null});return{c(){for(let r=0;r<n.length;r+=1)n[r].c();t=Ht()},l(r){for(let i=0;i<n.length;i+=1)n[i].l(r);t=Ht()},m(r,i){for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(r,i);U(r,t,i),e=!0},p(r,i){if(i&10){l=$t(r[1]);let a;for(a=0;a<l.length;a+=1){const u=kl(r,l,a);n[a]?(n[a].p(u,i),O(n[a],1)):(n[a]=yl(u),n[a].c(),O(n[a],1),n[a].m(t.parentNode,t))}for(zt(),a=l.length;a<n.length;a+=1)o(a);Rt()}},i(r){if(!e){for(let i=0;i<l.length;i+=1)O(n[i]);e=!0}},o(r){n=n.filter(Boolean);for(let i=0;i<n.length;i+=1)z(n[i]);e=!1},d(r){r&&m(t),pe(n,r)}}}function js(s){let t,e,l;return e=new $e({props:{class:"w-full max-w-[180px] rounded-lg px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-[9999] bg-white dark:bg-gray-900 dark:text-white shadow-sm",sideOffset:6,side:"top",align:"start",transition:Oe,$$slots:{default:[Rs]},$$scope:{ctx:s}}}),{c(){t=E("div"),at(e.$$.fragment),this.h()},l(n){t=I(n,"DIV",{slot:!0});var o=k(t);ct(e.$$.fragment,o),o.forEach(m),this.h()},h(){f(t,"slot","content")},m(n,o){U(n,t,o),ut(e,t,null),l=!0},p(n,o){const r={};o&258&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){l||(O(e.$$.fragment,n),l=!0)},o(n){z(e.$$.fragment,n),l=!1},d(n){n&&m(t),ft(e)}}}function Fs(s){let t,e,l;function n(r){s[6](r)}let o={$$slots:{content:[js],default:[Ps]},$$scope:{ctx:s}};return s[2]!==void 0&&(o.show=s[2]),t=new Ke({props:o}),Et.push(()=>Ut(t,"show",n)),t.$on("change",s[7]),{c(){at(t.$$.fragment)},l(r){ct(t.$$.fragment,r)},m(r,i){ut(t,r,i),l=!0},p(r,[i]){const a={};i&258&&(a.$$scope={dirty:i,ctx:r}),!e&&i&4&&(e=!0,a.show=r[2],Ot(()=>e=!1)),t.$set(a)},i(r){l||(O(t.$$.fragment,r),l=!0)},o(r){z(t.$$.fragment,r),l=!1},d(r){ft(t,r)}}}function qs(s,t,e){let{$$slots:l={},$$scope:n}=t;ue("i18n");const o=De();let{onClose:r=()=>{}}=t,{devices:i}=t,a=!1;const u=g=>{o("change",g.deviceId)};function c(g){a=g,e(2,a)}const d=g=>{g.detail===!1&&r()};return s.$$set=g=>{"onClose"in g&&e(0,r=g.onClose),"devices"in g&&e(1,i=g.devices),"$$scope"in g&&e(8,n=g.$$scope)},[r,i,a,o,l,u,c,d,n]}class Ws extends Jt{constructor(t){super(),Qt(this,t,qs,Fs,Gt,{onClose:0,devices:1})}}function El(s){let t,e,l,n,o,r,i,a,u,c,d,g,p,S,b,h,v,w,C,V,B='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"></path></svg>',D,P,L,A=s[2]&&Il(s);function R(X,lt){return X[2]?Gs:Js}let H=R(s),F=H(s);const j=[Ks,Xs],M=[];function q(X,lt){return X[2]?0:1}g=q(s),p=M[g]=j[g](s);function ot(X,lt){return X[1]?lr:er}let Z=ot(s),J=Z(s);return{c(){t=E("audio"),l=Q(),n=E("div"),o=E("div"),r=E("div"),A&&A.c(),i=Q(),a=E("div"),F.c(),u=Q(),c=E("div"),d=E("div"),p.c(),S=Q(),b=E("div"),h=E("button"),v=E("div"),J.c(),w=Q(),C=E("div"),V=E("button"),V.innerHTML=B,this.h()},l(X){t=I(X,"AUDIO",{id:!0,src:!0,style:!0}),k(t).forEach(m),l=Y(X),n=I(X,"DIV",{class:!0});var lt=k(n);o=I(lt,"DIV",{class:!0});var At=k(o);r=I(At,"DIV",{class:!0});var Pt=k(r);A&&A.l(Pt),i=Y(Pt),a=I(Pt,"DIV",{class:!0});var Xt=k(a);F.l(Xt),Xt.forEach(m),u=Y(Pt),c=I(Pt,"DIV",{class:!0});var Wt=k(c);d=I(Wt,"DIV",{});var W=k(d);p.l(W),W.forEach(m),S=Y(Wt),b=I(Wt,"DIV",{});var T=k(b);h=I(T,"BUTTON",{type:!0});var K=k(h);v=I(K,"DIV",{class:!0});var st=k(v);J.l(st),st.forEach(m),K.forEach(m),T.forEach(m),w=Y(Wt),C=I(Wt,"DIV",{});var mt=k(C);V=I(mt,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),Zt(V)!=="svelte-khrbnh"&&(V.innerHTML=B),mt.forEach(m),Wt.forEach(m),Pt.forEach(m),At.forEach(m),lt.forEach(m),this.h()},h(){f(t,"id","audioElement"),ve(t.src,e="")||f(t,"src",e),Te(t,"display","none"),f(a,"class","flex justify-center items-center flex-1 h-full w-full max-h-full"),f(v,"class","line-clamp-1 text-sm font-medium"),f(h,"type","button"),f(V,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),f(V,"type","button"),f(c,"class","flex justify-between items-center pb-2 w-full"),f(r,"class","max-w-lg w-full h-screen max-h-[100dvh] flex flex-col justify-between p-3 md:p-6"),f(o,"class","absolute w-full h-screen max-h-[100dvh] bg-white text-gray-700 dark:bg-black dark:text-gray-300 flex justify-center"),f(n,"class","absolute w-full h-screen max-h-[100dvh] flex z-[999] overflow-hidden")},m(X,lt){U(X,t,lt),U(X,l,lt),U(X,n,lt),_(n,o),_(o,r),A&&A.m(r,null),_(r,i),_(r,a),F.m(a,null),_(r,u),_(r,c),_(c,d),M[g].m(d,null),_(c,S),_(c,b),_(b,h),_(h,v),J.m(v,null),_(c,w),_(c,C),_(C,V),D=!0,P||(L=et(V,"click",s[17]),P=!0)},p(X,lt){X[2]?A?A.p(X,lt):(A=Il(X),A.c(),A.m(r,i)):A&&(A.d(1),A=null),H===(H=R(X))&&F?F.p(X,lt):(F.d(1),F=H(X),F&&(F.c(),F.m(a,null)));let At=g;g=q(X),g===At?M[g].p(X,lt):(zt(),z(M[At],1,1,()=>{M[At]=null}),Rt(),p=M[g],p?p.p(X,lt):(p=M[g]=j[g](X),p.c()),O(p,1),p.m(d,null)),Z===(Z=ot(X))&&J?J.p(X,lt):(J.d(1),J=Z(X),J&&(J.c(),J.m(v,null)))},i(X){D||(O(p),D=!0)},o(X){z(p),D=!1},d(X){X&&(m(t),m(l),m(n)),A&&A.d(),F.d(),M[g].d(),J.d(),P=!1,L()}}}function Il(s){let t;function e(o,r){return o[1]?xs:Zs}let l=e(s),n=l(s);return{c(){t=E("div"),n.c(),this.h()},l(o){t=I(o,"DIV",{class:!0});var r=k(t);n.l(r),r.forEach(m),this.h()},h(){f(t,"class","flex justify-center items-center w-full min-h-20")},m(o,r){U(o,t,r),n.m(t,null)},p(o,r){l===(l=e(o))&&n?n.p(o,r):(n.d(1),n=l(o),n&&(n.c(),n.m(t,null)))},d(o){o&&m(t),n.d()}}}function Zs(s){let t,e;return{c(){t=E("div"),this.h()},l(l){t=I(l,"DIV",{class:!0}),k(t).forEach(m),this.h()},h(){f(t,"class",e=(s[3]*100>4?" size-[4.5rem]":s[3]*100>2?" size-16":s[3]*100>1?"size-14":"size-12")+" transition-all bg-black dark:bg-white rounded-full")},m(l,n){U(l,t,n)},p(l,n){n[0]&8&&e!==(e=(l[3]*100>4?" size-[4.5rem]":l[3]*100>2?" size-16":l[3]*100>1?"size-14":"size-12")+" transition-all bg-black dark:bg-white rounded-full")&&f(t,"class",e)},d(l){l&&m(t)}}}function xs(s){let t,e,l,n,o,r;return{c(){t=_t("svg"),e=_t("style"),l=bt(`.spinner_qM83 {
										animation: spinner_8HQG 1.05s infinite;
									}
									.spinner_oXPr {
										animation-delay: 0.1s;
									}
									.spinner_ZTLf {
										animation-delay: 0.2s;
									}
									@keyframes spinner_8HQG {
										0%,
										57.14% {
											animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
											transform: translate(0);
										}
										28.57% {
											animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
											transform: translateY(-6px);
										}
										100% {
											transform: translate(0);
										}
									}
								`),n=_t("circle"),o=_t("circle"),r=_t("circle"),this.h()},l(i){t=vt(i,"svg",{class:!0,viewBox:!0,fill:!0,xmlns:!0});var a=k(t);e=vt(a,"style",{});var u=k(e);l=wt(u,`.spinner_qM83 {
										animation: spinner_8HQG 1.05s infinite;
									}
									.spinner_oXPr {
										animation-delay: 0.1s;
									}
									.spinner_ZTLf {
										animation-delay: 0.2s;
									}
									@keyframes spinner_8HQG {
										0%,
										57.14% {
											animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
											transform: translate(0);
										}
										28.57% {
											animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
											transform: translateY(-6px);
										}
										100% {
											transform: translate(0);
										}
									}
								`),u.forEach(m),n=vt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(n).forEach(m),o=vt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(o).forEach(m),r=vt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(r).forEach(m),a.forEach(m),this.h()},h(){f(n,"class","spinner_qM83"),f(n,"cx","4"),f(n,"cy","12"),f(n,"r","3"),f(o,"class","spinner_qM83 spinner_oXPr"),f(o,"cx","12"),f(o,"cy","12"),f(o,"r","3"),f(r,"class","spinner_qM83 spinner_ZTLf"),f(r,"cx","20"),f(r,"cy","12"),f(r,"r","3"),f(t,"class","size-12 text-gray-900 dark:text-gray-400"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"xmlns","http://www.w3.org/2000/svg")},m(i,a){U(i,t,a),_(t,e),_(e,l),_(t,n),_(t,o),_(t,r)},p:kt,d(i){i&&m(t)}}}function Gs(s){let t,e,l,n,o,r,i,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-6"><path d="M5.28 4.22a.75.75 0 0 0-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L8 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L9.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L8 6.94 5.28 4.22Z"></path></svg>',u,c;return{c(){t=E("div"),e=E("video"),l=Q(),n=E("canvas"),o=Q(),r=E("div"),i=E("button"),i.innerHTML=a,this.h()},l(d){t=I(d,"DIV",{class:!0});var g=k(t);e=I(g,"VIDEO",{id:!0,class:!0}),k(e).forEach(m),l=Y(g),n=I(g,"CANVAS",{id:!0,style:!0}),k(n).forEach(m),o=Y(g),r=I(g,"DIV",{class:!0});var p=k(r);i=I(p,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),Zt(i)!=="svelte-zfg1vd"&&(i.innerHTML=a),p.forEach(m),g.forEach(m),this.h()},h(){f(e,"id","camera-feed"),e.autoplay=!0,f(e,"class","rounded-2xl h-full min-w-full object-cover object-center"),e.playsInline=!0,f(n,"id","camera-canvas"),Te(n,"display","none"),f(i,"type","button"),f(i,"class","p-1.5 text-white cursor-pointer backdrop-blur-xl bg-black/10 rounded-full"),f(r,"class","absolute top-4 md:top-8 left-4"),f(t,"class","relative flex video-container w-full max-h-full pt-2 pb-4 md:py-6 px-2 h-full")},m(d,g){U(d,t,g),_(t,e),_(t,l),_(t,n),_(t,o),_(t,r),_(r,i),u||(c=et(i,"click",s[14]),u=!0)},p:kt,d(d){d&&m(t),u=!1,c()}}}function Js(s){let t;function e(o,r){return o[1]?Ys:Qs}let l=e(s),n=l(s);return{c(){n.c(),t=Ht()},l(o){n.l(o),t=Ht()},m(o,r){n.m(o,r),U(o,t,r)},p(o,r){l===(l=e(o))&&n?n.p(o,r):(n.d(1),n=l(o),n&&(n.c(),n.m(t.parentNode,t)))},d(o){o&&m(t),n.d(o)}}}function Qs(s){let t,e;return{c(){t=E("div"),this.h()},l(l){t=I(l,"DIV",{class:!0}),k(t).forEach(m),this.h()},h(){f(t,"class",e=(s[3]*100>4?" size-52":s[3]*100>2?"size-48":s[3]*100>1?"size-[11.5rem]":"size-44")+" transition-all bg-black dark:bg-white rounded-full")},m(l,n){U(l,t,n)},p(l,n){n[0]&8&&e!==(e=(l[3]*100>4?" size-52":l[3]*100>2?"size-48":l[3]*100>1?"size-[11.5rem]":"size-44")+" transition-all bg-black dark:bg-white rounded-full")&&f(t,"class",e)},d(l){l&&m(t)}}}function Ys(s){let t,e,l,n,o,r;return{c(){t=_t("svg"),e=_t("style"),l=bt(`.spinner_qM83 {
										animation: spinner_8HQG 1.05s infinite;
									}
									.spinner_oXPr {
										animation-delay: 0.1s;
									}
									.spinner_ZTLf {
										animation-delay: 0.2s;
									}
									@keyframes spinner_8HQG {
										0%,
										57.14% {
											animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
											transform: translate(0);
										}
										28.57% {
											animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
											transform: translateY(-6px);
										}
										100% {
											transform: translate(0);
										}
									}
								`),n=_t("circle"),o=_t("circle"),r=_t("circle"),this.h()},l(i){t=vt(i,"svg",{class:!0,viewBox:!0,fill:!0,xmlns:!0});var a=k(t);e=vt(a,"style",{});var u=k(e);l=wt(u,`.spinner_qM83 {
										animation: spinner_8HQG 1.05s infinite;
									}
									.spinner_oXPr {
										animation-delay: 0.1s;
									}
									.spinner_ZTLf {
										animation-delay: 0.2s;
									}
									@keyframes spinner_8HQG {
										0%,
										57.14% {
											animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
											transform: translate(0);
										}
										28.57% {
											animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
											transform: translateY(-6px);
										}
										100% {
											transform: translate(0);
										}
									}
								`),u.forEach(m),n=vt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(n).forEach(m),o=vt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(o).forEach(m),r=vt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(r).forEach(m),a.forEach(m),this.h()},h(){f(n,"class","spinner_qM83"),f(n,"cx","4"),f(n,"cy","12"),f(n,"r","3"),f(o,"class","spinner_qM83 spinner_oXPr"),f(o,"cx","12"),f(o,"cy","12"),f(o,"r","3"),f(r,"class","spinner_qM83 spinner_ZTLf"),f(r,"cx","20"),f(r,"cy","12"),f(r,"r","3"),f(t,"class","size-44 text-gray-900 dark:text-gray-400"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"xmlns","http://www.w3.org/2000/svg")},m(i,a){U(i,t,a),_(t,e),_(e,l),_(t,n),_(t,o),_(t,r)},p:kt,d(i){i&&m(t)}}}function Xs(s){let t,e;return t=new ge({props:{content:s[6].t("Camera"),$$slots:{default:[$s]},$$scope:{ctx:s}}}),{c(){at(t.$$.fragment)},l(l){ct(t.$$.fragment,l)},m(l,n){ut(t,l,n),e=!0},p(l,n){const o={};n[0]&64&&(o.content=l[6].t("Camera")),n[1]&2048&&(o.$$scope={dirty:n,ctx:l}),t.$set(o)},i(l){e||(O(t.$$.fragment,l),e=!0)},o(l){z(t.$$.fragment,l),e=!1},d(l){ft(t,l)}}}function Ks(s){let t,e;return t=new Ws({props:{devices:s[4],$$slots:{default:[tr]},$$scope:{ctx:s}}}),t.$on("change",s[15]),{c(){at(t.$$.fragment)},l(l){ct(t.$$.fragment,l)},m(l,n){ut(t,l,n),e=!0},p(l,n){const o={};n[0]&16&&(o.devices=l[4]),n[1]&2048&&(o.$$scope={dirty:n,ctx:l}),t.$set(o)},i(l){e||(O(t.$$.fragment,l),e=!0)},o(l){z(t.$$.fragment,l),e=!1},d(l){ft(t,l)}}}function $s(s){let t,e='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"></path></svg>',l,n;return{c(){t=E("button"),t.innerHTML=e,this.h()},l(o){t=I(o,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),Zt(t)!=="svelte-r4n822"&&(t.innerHTML=e),this.h()},h(){f(t,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),f(t,"type","button")},m(o,r){U(o,t,r),l||(n=et(t,"click",s[16]),l=!0)},p:kt,d(o){o&&m(t),l=!1,n()}}}function tr(s){let t,e='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path fill-rule="evenodd" d="M15.312 11.424a5.5 5.5 0 0 1-9.201 2.466l-.312-.311h2.433a.75.75 0 0 0 0-1.5H3.989a.75.75 0 0 0-.75.75v4.242a.75.75 0 0 0 1.5 0v-2.43l.31.31a7 7 0 0 0 11.712-3.138.75.75 0 0 0-1.449-.39Zm1.23-3.723a.75.75 0 0 0 .219-.53V2.929a.75.75 0 0 0-1.5 0V5.36l-.31-.31A7 7 0 0 0 3.239 8.188a.75.75 0 1 0 1.448.389A5.5 5.5 0 0 1 13.89 6.11l.311.31h-2.432a.75.75 0 0 0 0 1.5h4.243a.75.75 0 0 0 .53-.219Z" clip-rule="evenodd"></path></svg>';return{c(){t=E("button"),t.innerHTML=e,this.h()},l(l){t=I(l,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),Zt(t)!=="svelte-t977tc"&&(t.innerHTML=e),this.h()},h(){f(t,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),f(t,"type","button")},m(l,n){U(l,t,n)},p:kt,d(l){l&&m(t)}}}function er(s){let t=s[6].t("Listening...")+"",e;return{c(){e=bt(t)},l(l){e=wt(l,t)},m(l,n){U(l,e,n)},p(l,n){n[0]&64&&t!==(t=l[6].t("Listening...")+"")&&Vt(e,t)},d(l){l&&m(e)}}}function lr(s){let t=s[6].t("Thinking...")+"",e;return{c(){e=bt(t)},l(l){e=wt(l,t)},m(l,n){U(l,e,n)},p(l,n){n[0]&64&&t!==(t=l[6].t("Thinking...")+"")&&Vt(e,t)},d(l){l&&m(e)}}}function nr(s){let t,e,l=s[0]&&El(s);return{c(){l&&l.c(),t=Ht()},l(n){l&&l.l(n),t=Ht()},m(n,o){l&&l.m(n,o),U(n,t,o),e=!0},p(n,o){n[0]?l?(l.p(n,o),o[0]&1&&O(l,1)):(l=El(n),l.c(),O(l,1),l.m(t.parentNode,t)):l&&(zt(),z(l,1,1,()=>{l=null}),Rt())},i(n){e||(O(l),e=!0)},o(n){z(l),e=!1},d(n){n&&m(t),l&&l.d(n)}}}function sr(s,t,e){let l,n,o,r;it(s,Be,T=>e(0,l=T)),it(s,Me,T=>e(27,n=T)),it(s,fe,T=>e(28,o=T));const i=ue("i18n");it(s,i,T=>e(6,r=T));let{submitPrompt:a}=t,{files:u}=t,c=!1,d=!1,g=!1,p=null,S={},b=null,h=0,v=!1,w=null,C,V=[];const B=-45,D=T=>{let K=0;for(let st=0;st<T.length;st++){const mt=(T[st]-128)/128;K+=mt*mt}return Math.sqrt(K/T.length)},P=T=>{const K=new AudioContext,st=K.createMediaStreamSource(T),mt=K.createAnalyser();mt.minDecibels=B,st.connect(mt);const x=mt.frequencyBinCount,dt=new Uint8Array(x),Yt=new Uint8Array(mt.fftSize);let Nt=Date.now();v=!1,(()=>{const qt=()=>{if(!C||!l){C&&C.stop();return}mt.getByteTimeDomainData(Yt),mt.getByteFrequencyData(dt),e(3,h=D(Yt)),dt.some(ee=>ee>0)&&(L(),v=!0,Nt=Date.now()),v&&Date.now()-Nt>2e3&&(d=!0,C&&C.stop()),window.requestAnimationFrame(qt)};window.requestAnimationFrame(qt)})()},L=()=>{w&&(speechSynthesis.cancel(),w=null),S[b]&&(S[b].pause(),S[b].currentTime=0);const T=document.getElementById("audioElement");T.pause(),T.currentTime=0},A=T=>l?new Promise(K=>{b=T;const st=document.getElementById("audioElement"),mt=S[T];st.src=mt.src,st.muted=!0,st.play().then(()=>{st.muted=!1}).catch(x=>{pt.error(x)}),st.onended=async x=>{await new Promise(dt=>setTimeout(dt,300)),Object.keys(S).length-1,K(x)}}):Promise.resolve(),R=async T=>{await Bt();const K=Xe(T,"recording.wav"),st=await vn(localStorage.token,K).catch(mt=>(pt.error(mt),null));if(st&&(console.log(st.text),st.text!=="")){const mt=await a(st.text);if(console.log(mt),mt.at(0)){const x=mt[0];x&&H(x)}}},H=async T=>{var K,st,mt,x;if((n.audio.tts.engine??"")==""){let dt=[];const Yt=setInterval(async()=>{var Nt;if(dt=await speechSynthesis.getVoices(),dt.length>0){clearInterval(Yt);const xt=((Nt=dt==null?void 0:dt.filter(qt=>{var Kt,ee,te,he;return qt.voiceURI===(((ee=(Kt=o==null?void 0:o.audio)==null?void 0:Kt.tts)==null?void 0:ee.voice)??((he=(te=n==null?void 0:n.audio)==null?void 0:te.tts)==null?void 0:he.voice))}))==null?void 0:Nt.at(0))??void 0;w=new SpeechSynthesisUtterance(T),xt&&(w.voice=xt),speechSynthesis.speak(w)}},100)}else if(n.audio.tts.engine==="openai"){console.log("openai");const dt=Ln(T).reduce((Nt,xt)=>{const qt=Nt.length-1;if(qt>=0){const Kt=Nt[qt];Kt.split(/\s+/).length<2?Nt[qt]=Kt+" "+xt:Nt.push(xt)}else Nt.push(xt);return Nt},[]);console.log(dt);let Yt=Promise.resolve();for(const[Nt,xt]of dt.entries()){const qt=await is(localStorage.token,((st=(K=o==null?void 0:o.audio)==null?void 0:K.tts)==null?void 0:st.voice)??((x=(mt=n==null?void 0:n.audio)==null?void 0:mt.tts)==null?void 0:x.voice),xt).catch(Kt=>(pt.error(Kt),null));if(qt){const Kt=await qt.blob(),ee=URL.createObjectURL(Kt),te=new Audio(ee);S[Nt]=te,Yt=Yt.then(()=>A(Nt))}}}},F=async()=>{if(l){if(d){if(e(1,c=!0),p){const K=lt();e(12,u=[{type:"image",url:K}])}const T=new Blob(V,{type:"audio/wav"});await R(T),d=!1,e(1,c=!1)}V=[],C=!1,j()}else V=[],C=!1},j=async()=>{const T=await navigator.mediaDevices.getUserMedia({audio:!0});C=new MediaRecorder(T),C.onstart=()=>{console.log("Recording started"),V=[],P(T)},C.ondataavailable=K=>{v&&V.push(K.data)},C.onstop=async()=>{console.log("Recording stopped"),await F()},C.start()};let M=[],q=null;const ot=async()=>{const T=await navigator.mediaDevices.enumerateDevices();e(4,M=T.filter(K=>K.kind==="videoinput")),navigator.mediaDevices.getDisplayMedia&&e(4,M=[...M,{deviceId:"screen",label:"Screen Share"}]),console.log(M),q===null&&M.length>0&&e(5,q=M[0].deviceId)},Z=async()=>{if(await ot(),p===null){e(2,g=!0),await Bt();try{await J()}catch(T){console.error("Error accessing webcam: ",T)}}},J=async()=>{const T=document.getElementById("camera-feed");T&&(q==="screen"?p=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!1}):p=await navigator.mediaDevices.getUserMedia({video:{deviceId:q?{exact:q}:void 0}}),p&&(await ot(),T.srcObject=p,await T.play()))},X=async()=>{p&&p.getTracks().forEach(K=>K.stop()),p=null},lt=()=>{const T=document.getElementById("camera-feed"),K=document.getElementById("camera-canvas");if(!K)return;const st=K.getContext("2d");K.width=T.videoWidth,K.height=T.videoHeight,st.drawImage(T,0,0,T.videoWidth,T.videoHeight);const mt=K.toDataURL("image/png");return console.log(mt),mt},At=async()=>{await X(),e(2,g=!1)},Pt=()=>{At()},Xt=async T=>{console.log(T.detail),e(5,q=T.detail),await X(),await J()},Wt=()=>{Z()},W=async()=>{Be.set(!1)};return s.$$set=T=>{"submitPrompt"in T&&e(13,a=T.submitPrompt),"files"in T&&e(12,u=T.files)},s.$$.update=()=>{s.$$.dirty[0]&1&&(l?j():At())},[l,c,g,h,M,q,r,i,Z,J,X,At,u,a,Pt,Xt,Wt,W]}class rr extends Jt{constructor(t){super(),Qt(this,t,sr,nr,Gt,{submitPrompt:13,files:12},null,[-1,-1])}}function or(s){let t,e,l,n,o,r,i;return a(),{feed:u,reset:a};function a(){t=!0,e="",l=0,n=-1,o=void 0,r=void 0,i=""}function u(d){e=e?e+d:d,t&&ir(e)&&(e=e.slice(bn.length)),t=!1;const g=e.length;let p=0,S=!1;for(;p<g;){S&&(e[p]===`
`&&++p,S=!1);let b=-1,h=n,v;for(let w=l;b<0&&w<g;++w)v=e[w],v===":"&&h<0?h=w-p:v==="\r"?(S=!0,b=w-p):v===`
`&&(b=w-p);if(b<0){l=g-p,n=h;break}else l=0,n=-1;c(e,p,h,b),p+=b+1}p===g?e="":p>0&&(e=e.slice(p))}function c(d,g,p,S){if(S===0){i.length>0&&(s({type:"event",id:o,event:r||void 0,data:i.slice(0,-1)}),i="",o=void 0),r=void 0;return}const b=p<0,h=d.slice(g,g+(b?S:p));let v=0;b?v=S:d[g+p+1]===" "?v=p+2:v=p+1;const w=g+v,C=S-v,V=d.slice(w,w+C).toString();if(h==="data")i+=V?"".concat(V,`
`):`
`;else if(h==="event")r=V;else if(h==="id"&&!V.includes("\0"))o=V;else if(h==="retry"){const B=parseInt(V,10);Number.isNaN(B)||s({type:"reconnect-interval",value:B})}}}const bn=[239,187,191];function ir(s){return bn.every((t,e)=>s.charCodeAt(e)===t)}class ar extends TransformStream{constructor(){let t;super({start(e){t=or(l=>{l.type==="event"&&e.enqueue(l)})},transform(e){t.feed(e)}})}}async function cr(s,t){const e=s.pipeThrough(new TextDecoderStream).pipeThrough(new ar).getReader();let l=ur(e);return t&&(l=fr(l)),l}async function*ur(s){var t,e,l;for(;;){const{value:n,done:o}=await s.read();if(o){yield{done:!0,value:""};break}if(!n)continue;const r=n.data;if(r.startsWith("[DONE]")){yield{done:!0,value:""};break}try{const i=JSON.parse(r);if(console.log(i),i.error){yield{done:!0,value:"",error:i.error};break}if(i.citations){yield{done:!1,value:"",citations:i.citations};continue}yield{done:!1,value:((l=(e=(t=i.choices)==null?void 0:t[0])==null?void 0:e.delta)==null?void 0:l.content)??"",usage:i.usage}}catch(i){console.error("Error extracting delta from SSE event:",i)}}}async function*fr(s){for await(const t of s){if(t.done){yield t;return}if(t.citations){yield t;continue}let e=t.value;if(e.length<5){yield{done:!1,value:e};continue}for(;e!="";){const l=Math.min(Math.floor(Math.random()*3)+1,e.length);yield{done:!1,value:e.slice(0,l)},(document==null?void 0:document.visibilityState)!=="hidden"&&await dr(5),e=e.slice(l)}}}const dr=s=>new Promise(t=>setTimeout(t,s));function Sl(s){let t,e=s[2]&&Dl(s);return{c(){e&&e.c(),t=Ht()},l(l){e&&e.l(l),t=Ht()},m(l,n){e&&e.m(l,n),U(l,t,n)},p(l,n){l[2]?e?(e.p(l,n),n&4&&O(e,1)):(e=Dl(l),e.c(),O(e,1),e.m(t.parentNode,t)):e&&(zt(),z(e,1,1,()=>{e=null}),Rt())},d(l){l&&m(t),e&&e.d(l)}}}function Dl(s){let t,e,l,n,o=s[1].type+"",r,i,a,u,c,d=s[1].content+"",g,p,S,b,h,v,w=s[1].url&&Ml(),C=s[1].url&&Cl(),V=s[1].dismissible&&Tl(s);return{c(){t=E("div"),e=E("div"),l=E("div"),n=E("div"),r=bt(o),a=Q(),w&&w.c(),u=Q(),c=E("div"),g=bt(d),p=Q(),C&&C.c(),S=Q(),b=E("div"),V&&V.c(),this.h()},l(B){t=I(B,"DIV",{class:!0});var D=k(t);e=I(D,"DIV",{class:!0});var P=k(e);l=I(P,"DIV",{class:!0});var L=k(l);n=I(L,"DIV",{class:!0});var A=k(n);r=wt(A,o),A.forEach(m),a=Y(L),w&&w.l(L),L.forEach(m),u=Y(P),c=I(P,"DIV",{class:!0});var R=k(c);g=wt(R,d),R.forEach(m),P.forEach(m),p=Y(D),C&&C.l(D),S=Y(D),b=I(D,"DIV",{class:!0});var H=k(b);V&&V.l(H),H.forEach(m),D.forEach(m),this.h()},h(){f(n,"class",i="text-xs font-black "+(s[3][s[1].type]??s[3].info)+" w-fit px-2 rounded uppercase line-clamp-1 mr-0.5"),f(l,"class","flex justify-between self-start"),f(c,"class","flex-1 text-xs text-gray-700 dark:text-white"),f(e,"class","flex flex-col md:flex-row md:items-center flex-1 text-sm w-fit gap-1.5"),f(b,"class","flex self-start"),f(t,"class","top-0 left-0 right-0 p-2 mx-4 px-3 flex justify-center items-center relative rounded-xl border border-gray-50 dark:border-gray-850 text-gray-800 dark:text-gary-100 bg-white dark:bg-gray-900 backdrop-blur-xl z-30")},m(B,D){U(B,t,D),_(t,e),_(e,l),_(l,n),_(n,r),_(l,a),w&&w.m(l,null),_(e,u),_(e,c),_(c,g),_(t,p),C&&C.m(t,null),_(t,S),_(t,b),V&&V.m(b,null),v=!0},p(B,D){(!v||D&2)&&o!==(o=B[1].type+"")&&Vt(r,o),(!v||D&2&&i!==(i="text-xs font-black "+(B[3][B[1].type]??B[3].info)+" w-fit px-2 rounded uppercase line-clamp-1 mr-0.5"))&&f(n,"class",i),B[1].url?w||(w=Ml(),w.c(),w.m(l,null)):w&&(w.d(1),w=null),(!v||D&2)&&d!==(d=B[1].content+"")&&Vt(g,d),B[1].url?C||(C=Cl(),C.c(),C.m(t,S)):C&&(C.d(1),C=null),B[1].dismissible?V?V.p(B,D):(V=Tl(B),V.c(),V.m(b,null)):V&&(V.d(1),V=null)},i(B){v||(B&&He(()=>{v&&(h||(h=Ve(t,sl,{delay:100,duration:300},!0)),h.run(1))}),v=!0)},o(B){B&&(h||(h=Ve(t,sl,{delay:100,duration:300},!1)),h.run(0)),v=!1},d(B){B&&m(t),w&&w.d(),C&&C.d(),V&&V.d(),B&&h&&h.end()}}}function Ml(s){let t,e='<a class="text-gray-700 dark:text-white text-xs font-bold underline" href="/assets/files/whitepaper.pdf" target="_blank">Learn More</a> <div class="ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-4 h-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div>';return{c(){t=E("div"),t.innerHTML=e,this.h()},l(l){t=I(l,"DIV",{class:!0,"data-svelte-h":!0}),Zt(t)!=="svelte-1ofrdjc"&&(t.innerHTML=e),this.h()},h(){f(t,"class","flex md:hidden group w-fit md:items-center")},m(l,n){U(l,t,n)},d(l){l&&m(t)}}}function Cl(s){let t,e='<a class="text-gray-700 dark:text-white text-xs font-bold underline" href="/" target="_blank">Learn More</a> <div class="ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div>';return{c(){t=E("div"),t.innerHTML=e,this.h()},l(l){t=I(l,"DIV",{class:!0,"data-svelte-h":!0}),Zt(t)!=="svelte-15ujvd1"&&(t.innerHTML=e),this.h()},h(){f(t,"class","hidden md:flex group w-fit md:items-center")},m(l,n){U(l,t,n)},d(l){l&&m(t)}}}function Tl(s){let t,e="Ã—",l,n;return{c(){t=E("button"),t.textContent=e,this.h()},l(o){t=I(o,"BUTTON",{class:!0,"data-svelte-h":!0}),Zt(t)!=="svelte-17pf3tf"&&(t.textContent=e),this.h()},h(){f(t,"class","-mt-[3px] ml-1.5 mr-1 text-gray-400 dark:hover:text-white h-1")},m(o,r){U(o,t,r),l||(n=et(t,"click",s[5]),l=!0)},p:kt,d(o){o&&m(t),l=!1,n()}}}function mr(s){let t,e=!s[0]&&Sl(s);return{c(){e&&e.c(),t=Ht()},l(l){e&&e.l(l),t=Ht()},m(l,n){e&&e.m(l,n),U(l,t,n)},p(l,[n]){l[0]?e&&(e.d(1),e=null):e?e.p(l,n):(e=Sl(l),e.c(),e.m(t.parentNode,t))},i:kt,o:kt,d(l){l&&m(t),e&&e.d(l)}}}function hr(s,t,e){const l=De();let{banner:n={id:"",type:"info",title:"",content:"",url:"",dismissable:!0,timestamp:Math.floor(Date.now()/1e3)}}=t,{dismissed:o=!1}=t,r=!1;const i={info:"bg-blue-500/20 text-blue-700 dark:text-blue-200 ",success:"bg-green-500/20 text-green-700 dark:text-green-200",warning:"bg-yellow-500/20 text-yellow-700 dark:text-yellow-200",error:"bg-red-500/20 text-red-700 dark:text-red-200"},a=c=>{e(0,o=!0),l("dismiss",c)};Ye(()=>{e(2,r=!0)});const u=()=>{a(n.id)};return s.$$set=c=>{"banner"in c&&e(1,n=c.banner),"dismissed"in c&&e(0,o=c.dismissed)},[o,n,r,i,a,u]}class gr extends Jt{constructor(t){super(),Qt(this,t,hr,mr,Gt,{banner:1,dismissed:0})}}function Vl(s,t,e){const l=s.slice();return l[12]=t[e],l[14]=e,l}function Bl(s){let t,e,l,n='<div class="text-lg font-semibold mt-2">/</div>',o,r,i,a,u,c,d='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-3 h-3"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg>',g,p,S=s[2].t("Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.")+"",b,h=$t(s[1]),v=[];for(let w=0;w<h.length;w+=1)v[w]=Nl(Vl(s,h,w));return{c(){t=E("div"),e=E("div"),l=E("div"),l.innerHTML=n,o=Q(),r=E("div"),i=E("div");for(let w=0;w<v.length;w+=1)v[w].c();a=Q(),u=E("div"),c=E("div"),c.innerHTML=d,g=Q(),p=E("div"),b=bt(S),this.h()},l(w){t=I(w,"DIV",{class:!0});var C=k(t);e=I(C,"DIV",{class:!0});var V=k(e);l=I(V,"DIV",{class:!0,"data-svelte-h":!0}),Zt(l)!=="svelte-1ynv172"&&(l.innerHTML=n),o=Y(V),r=I(V,"DIV",{class:!0});var B=k(r);i=I(B,"DIV",{class:!0});var D=k(i);for(let A=0;A<v.length;A+=1)v[A].l(D);D.forEach(m),a=Y(B),u=I(B,"DIV",{class:!0});var P=k(u);c=I(P,"DIV",{"data-svelte-h":!0}),Zt(c)!=="svelte-cdi12d"&&(c.innerHTML=d),g=Y(P),p=I(P,"DIV",{class:!0});var L=k(p);b=wt(L,S),L.forEach(m),P.forEach(m),B.forEach(m),V.forEach(m),C.forEach(m),this.h()},h(){f(l,"class","bg-gray-100 dark:bg-gray-700 w-10 rounded-l-xl text-center"),f(i,"class","m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5"),f(p,"class","line-clamp-1"),f(u,"class","px-2 pb-1 text-xs text-gray-600 bg-white rounded-br-xl flex items-center space-x-1"),f(r,"class","max-h-60 flex flex-col w-full rounded-r-xl bg-white"),f(e,"class","flex w-full px-2"),f(t,"class","pl-1 pr-12 mb-3 text-left w-full absolute bottom-0 left-0 right-0")},m(w,C){U(w,t,C),_(t,e),_(e,l),_(e,o),_(e,r),_(r,i);for(let V=0;V<v.length;V+=1)v[V]&&v[V].m(i,null);_(r,a),_(r,u),_(u,c),_(u,g),_(u,p),_(p,b)},p(w,C){if(C&19){h=$t(w[1]);let V;for(V=0;V<h.length;V+=1){const B=Vl(w,h,V);v[V]?v[V].p(B,C):(v[V]=Nl(B),v[V].c(),v[V].m(i,null))}for(;V<v.length;V+=1)v[V].d(1);v.length=h.length}C&4&&S!==(S=w[2].t("Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.")+"")&&Vt(b,S)},d(w){w&&m(t),pe(v,w)}}}function Nl(s){let t,e,l=s[12].command+"",n,o,r,i=s[12].title+"",a,u,c,d,g;function p(){return s[10](s[12])}function S(){return s[11](s[14])}return{c(){t=E("button"),e=E("div"),n=bt(l),o=Q(),r=E("div"),a=bt(i),u=Q(),this.h()},l(b){t=I(b,"BUTTON",{class:!0,type:!0});var h=k(t);e=I(h,"DIV",{class:!0});var v=k(e);n=wt(v,l),v.forEach(m),o=Y(h),r=I(h,"DIV",{class:!0});var w=k(r);a=wt(w,i),w.forEach(m),u=Y(h),h.forEach(m),this.h()},h(){f(e,"class","font-medium text-black"),f(r,"class","text-xs text-gray-600"),f(t,"class",c="px-3 py-1.5 rounded-xl w-full text-left "+(s[14]===s[0]?" bg-gray-100 selected-command-option-button":"")),f(t,"type","button")},m(b,h){U(b,t,h),_(t,e),_(e,n),_(t,o),_(t,r),_(r,a),_(t,u),d||(g=[et(t,"click",p),et(t,"mousemove",S),et(t,"focus",_r)],d=!0)},p(b,h){s=b,h&2&&l!==(l=s[12].command+"")&&Vt(n,l),h&2&&i!==(i=s[12].title+"")&&Vt(a,i),h&1&&c!==(c="px-3 py-1.5 rounded-xl w-full text-left "+(s[14]===s[0]?" bg-gray-100 selected-command-option-button":""))&&f(t,"class",c)},d(b){b&&m(t),d=!1,de(g)}}}function pr(s){let t,e=s[1].length>0&&Bl(s);return{c(){e&&e.c(),t=Ht()},l(l){e&&e.l(l),t=Ht()},m(l,n){e&&e.m(l,n),U(l,t,n)},p(l,[n]){l[1].length>0?e?e.p(l,n):(e=Bl(l),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},i:kt,o:kt,d(l){l&&m(t),e&&e.d(l)}}}const _r=()=>{};function vr(s,t,e){let l,n;it(s,Mn,b=>e(9,n=b));const o=ue("i18n");it(s,o,b=>e(2,l=b));let{files:r}=t,{prompt:i=""}=t,a=0,u=[];const c=()=>{e(0,a=Math.max(0,a-1))},d=()=>{e(0,a=Math.min(a+1,u.length-1))},g=async b=>{let h=b.content;if(b.content.includes("{{CLIPBOARD}}")){const C=await navigator.clipboard.readText().catch(D=>(pt.error(l.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));console.log(C);const V=await navigator.clipboard.read();let B=null;for(const D of V)for(const P of D.types)if(P.startsWith("image/")){const L=await D.getType(P);B=URL.createObjectURL(L),console.log(`Image URL (${P}): ${B}`)}B&&e(6,r=[...r,{type:"image",url:B}]),h=b.content.replaceAll("{{CLIPBOARD}}",C)}e(5,i=h);const v=document.getElementById("chat-textarea");await Bt(),v.style.height="",v.style.height=Math.min(v.scrollHeight,200)+"px",v==null||v.focus(),await Bt();const w=pn(i);if(w.length>0){const C=w.at(0);v.setSelectionRange(C==null?void 0:C.startIndex,C.endIndex+1)}},p=b=>{g(b)},S=b=>{e(0,a=b)};return s.$$set=b=>{"files"in b&&e(6,r=b.files),"prompt"in b&&e(5,i=b.prompt)},s.$$.update=()=>{s.$$.dirty&544&&e(1,u=n.filter(b=>b.command.includes(i)).sort((b,h)=>b.title.localeCompare(h.title))),s.$$.dirty&32&&i&&e(0,a=0)},[a,u,l,o,g,i,r,c,d,n,p,S]}class br extends Jt{constructor(t){super(),Qt(this,t,vr,pr,Gt,{files:6,prompt:5,selectUp:7,selectDown:8})}get selectUp(){return this.$$.ctx[7]}get selectDown(){return this.$$.ctx[8]}}function Ll(s,t,e){const l=s.slice();return l[19]=t[e],l[21]=e,l}function Hl(s){let t,e,l,n='<div class="text-lg font-semibold mt-2">#</div>',o,r,i,a,u,c,d=$t(s[3]),g=[];for(let h=0;h<d.length;h+=1)g[h]=Al(Ll(s,d,h));function p(h,v){var w,C;if(v&1&&(u=null),v&1&&(c=null),u==null&&(u=!!h[0].split(" ").some(Sr)),u)return Er;if(c==null&&(c=!!((C=(w=h[0].split(" "))==null?void 0:w.at(0))!=null&&C.substring(1).startsWith("http"))),c)return yr}let S=p(s,-1),b=S&&S(s);return{c(){t=E("div"),e=E("div"),l=E("div"),l.innerHTML=n,o=Q(),r=E("div"),i=E("div");for(let h=0;h<g.length;h+=1)g[h].c();a=Q(),b&&b.c(),this.h()},l(h){t=I(h,"DIV",{class:!0});var v=k(t);e=I(v,"DIV",{class:!0});var w=k(e);l=I(w,"DIV",{class:!0,"data-svelte-h":!0}),Zt(l)!=="svelte-czbw16"&&(l.innerHTML=n),o=Y(w),r=I(w,"DIV",{class:!0});var C=k(r);i=I(C,"DIV",{class:!0});var V=k(i);for(let B=0;B<g.length;B+=1)g[B].l(V);a=Y(V),b&&b.l(V),V.forEach(m),C.forEach(m),w.forEach(m),v.forEach(m),this.h()},h(){f(l,"class","bg-gray-100 dark:bg-gray-700 w-10 rounded-l-xl text-center"),f(i,"class","m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5"),f(r,"class","max-h-60 flex flex-col w-full rounded-r-xl bg-white"),f(e,"class","flex w-full px-2"),f(t,"class","pl-1 pr-12 mb-3 text-left w-full absolute bottom-0 left-0 right-0")},m(h,v){U(h,t,v),_(t,e),_(e,l),_(e,o),_(e,r),_(r,i);for(let w=0;w<g.length;w+=1)g[w]&&g[w].m(i,null);_(i,a),b&&b.m(i,null)},p(h,v){if(v&46){d=$t(h[3]);let w;for(w=0;w<d.length;w+=1){const C=Ll(h,d,w);g[w]?g[w].p(C,v):(g[w]=Al(C),g[w].c(),g[w].m(i,a))}for(;w<g.length;w+=1)g[w].d(1);g.length=d.length}S===(S=p(h,v))&&b?b.p(h,v):(b&&b.d(1),b=S&&S(h),b&&(b.c(),b.m(i,null)))},d(h){h&&m(t),pe(g,h),b&&b.d()}}}function wr(s){let t,e,l=s[19].name+"",n,o,r=s[19].filename+"",i,a,u,c,d=s[19].title+"",g;return{c(){t=E("div"),e=bt("#"),n=bt(l),o=bt(" ("),i=bt(r),a=bt(")"),u=Q(),c=E("div"),g=bt(d),this.h()},l(p){t=I(p,"DIV",{class:!0});var S=k(t);e=wt(S,"#"),n=wt(S,l),o=wt(S," ("),i=wt(S,r),a=wt(S,")"),S.forEach(m),u=Y(p),c=I(p,"DIV",{class:!0});var b=k(c);g=wt(b,d),b.forEach(m),this.h()},h(){f(t,"class","font-medium text-black line-clamp-1"),f(c,"class","text-xs text-gray-600 line-clamp-1")},m(p,S){U(p,t,S),_(t,e),_(t,n),_(t,o),_(t,i),_(t,a),U(p,u,S),U(p,c,S),_(c,g)},p(p,S){S&8&&l!==(l=p[19].name+"")&&Vt(n,l),S&8&&r!==(r=p[19].filename+"")&&Vt(i,r),S&8&&d!==(d=p[19].title+"")&&Vt(g,d)},d(p){p&&(m(t),m(u),m(c))}}}function kr(s){var a;let t,e=(((a=s[19])==null?void 0:a.title)??`#${s[19].name}`)+"",l,n,o,r=s[1].t("Collection")+"",i;return{c(){t=E("div"),l=bt(e),n=Q(),o=E("div"),i=bt(r),this.h()},l(u){t=I(u,"DIV",{class:!0});var c=k(t);l=wt(c,e),c.forEach(m),n=Y(u),o=I(u,"DIV",{class:!0});var d=k(o);i=wt(d,r),d.forEach(m),this.h()},h(){f(t,"class","font-medium text-black line-clamp-1"),f(o,"class","text-xs text-gray-600 line-clamp-1")},m(u,c){U(u,t,c),_(t,l),U(u,n,c),U(u,o,c),_(o,i)},p(u,c){var d;c&8&&e!==(e=(((d=u[19])==null?void 0:d.title)??`#${u[19].name}`)+"")&&Vt(l,e),c&2&&r!==(r=u[1].t("Collection")+"")&&Vt(i,r)},d(u){u&&(m(t),m(n),m(o))}}}function Al(s){let t,e,l,n;function o(c,d){return c[19].type==="collection"?kr:wr}let r=o(s),i=r(s);function a(){return s[14](s[19])}function u(){return s[15](s[21])}return{c(){t=E("button"),i.c(),this.h()},l(c){t=I(c,"BUTTON",{class:!0,type:!0});var d=k(t);i.l(d),d.forEach(m),this.h()},h(){f(t,"class",e="px-3 py-1.5 rounded-xl w-full text-left "+(s[21]===s[2]?" bg-gray-100 selected-command-option-button":"")),f(t,"type","button")},m(c,d){U(c,t,d),i.m(t,null),l||(n=[et(t,"click",a),et(t,"mousemove",u),et(t,"focus",Dr)],l=!0)},p(c,d){s=c,r===(r=o(s))&&i?i.p(s,d):(i.d(1),i=r(s),i&&(i.c(),i.m(t,null))),d&4&&e!==(e="px-3 py-1.5 rounded-xl w-full text-left "+(s[21]===s[2]?" bg-gray-100 selected-command-option-button":""))&&f(t,"class",e)},d(c){c&&m(t),i.d(),l=!1,de(n)}}}function yr(s){var d,g;let t,e,l=((g=(d=s[0].split(" "))==null?void 0:d.at(0))==null?void 0:g.substring(1))+"",n,o,r,i=s[1].t("Web")+"",a,u,c;return{c(){t=E("button"),e=E("div"),n=bt(l),o=Q(),r=E("div"),a=bt(i),this.h()},l(p){t=I(p,"BUTTON",{class:!0,type:!0});var S=k(t);e=I(S,"DIV",{class:!0});var b=k(e);n=wt(b,l),b.forEach(m),o=Y(S),r=I(S,"DIV",{class:!0});var h=k(r);a=wt(h,i),h.forEach(m),S.forEach(m),this.h()},h(){f(e,"class","font-medium text-black line-clamp-1"),f(r,"class","text-xs text-gray-600 line-clamp-1"),f(t,"class","px-3 py-1.5 rounded-xl w-full text-left bg-gray-100 selected-command-option-button"),f(t,"type","button")},m(p,S){U(p,t,S),_(t,e),_(e,n),_(t,o),_(t,r),_(r,a),u||(c=et(t,"click",s[17]),u=!0)},p(p,S){var b,h;S&1&&l!==(l=((h=(b=p[0].split(" "))==null?void 0:b.at(0))==null?void 0:h.substring(1))+"")&&Vt(n,l),S&2&&i!==(i=p[1].t("Web")+"")&&Vt(a,i)},d(p){p&&m(t),u=!1,c()}}}function Er(s){var d,g;let t,e,l=((g=(d=s[0].split(" "))==null?void 0:d.at(0))==null?void 0:g.substring(1))+"",n,o,r,i=s[1].t("Youtube")+"",a,u,c;return{c(){t=E("button"),e=E("div"),n=bt(l),o=Q(),r=E("div"),a=bt(i),this.h()},l(p){t=I(p,"BUTTON",{class:!0,type:!0});var S=k(t);e=I(S,"DIV",{class:!0});var b=k(e);n=wt(b,l),b.forEach(m),o=Y(S),r=I(S,"DIV",{class:!0});var h=k(r);a=wt(h,i),h.forEach(m),S.forEach(m),this.h()},h(){f(e,"class","font-medium text-black line-clamp-1"),f(r,"class","text-xs text-gray-600 line-clamp-1"),f(t,"class","px-3 py-1.5 rounded-xl w-full text-left bg-gray-100 selected-command-option-button"),f(t,"type","button")},m(p,S){U(p,t,S),_(t,e),_(e,n),_(t,o),_(t,r),_(r,a),u||(c=et(t,"click",s[16]),u=!0)},p(p,S){var b,h;S&1&&l!==(l=((h=(b=p[0].split(" "))==null?void 0:b.at(0))==null?void 0:h.substring(1))+"")&&Vt(n,l),S&2&&i!==(i=p[1].t("Youtube")+"")&&Vt(a,i)},d(p){p&&m(t),u=!1,c()}}}function Ir(s){var n,o;let t=s[3].length>0||((o=(n=s[0].split(" "))==null?void 0:n.at(0))==null?void 0:o.substring(1).startsWith("http")),e,l=t&&Hl(s);return{c(){l&&l.c(),e=Ht()},l(r){l&&l.l(r),e=Ht()},m(r,i){l&&l.m(r,i),U(r,e,i)},p(r,[i]){var a,u;i&9&&(t=r[3].length>0||((u=(a=r[0].split(" "))==null?void 0:a.at(0))==null?void 0:u.substring(1).startsWith("http"))),t?l?l.p(r,i):(l=Hl(r),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},i:kt,o:kt,d(r){r&&m(e),l&&l.d(r)}}}const Sr=s=>s.substring(1).startsWith("https://www.youtube.com")||s.substring(1).startsWith("https://youtu.be"),Dr=()=>{};function Mr(s,t,e){let l,n,o;it(s,Cn,D=>e(13,n=D));const r=ue("i18n");it(s,r,D=>e(1,o=D));let{prompt:i=""}=t;const a=De();let u=0,c=[],d=[],g=[];const p=()=>{e(2,u=Math.max(0,u-1))},S=()=>{e(2,u=Math.min(u+1,c.length-1))},b=async D=>{a("select",D),e(0,i=Ge(i));const P=document.getElementById("chat-textarea");await Bt(),P==null||P.focus(),await Bt()},h=async D=>{a("url",D),e(0,i=Ge(i));const P=document.getElementById("chat-textarea");await Bt(),P==null||P.focus(),await Bt()},v=async D=>{a("youtube",D),e(0,i=Ge(i));const P=document.getElementById("chat-textarea");await Bt(),P==null||P.focus(),await Bt()},w=D=>{console.log(D),b(D)},C=D=>{e(2,u=D)},V=()=>{var P,L;const D=(L=(P=i.split(" "))==null?void 0:P.at(0))==null?void 0:L.substring(1);il(D)?v(D):pt.error(o.t("Oops! Looks like the URL is invalid. Please double-check and try again."))},B=()=>{var P,L;const D=(L=(P=i.split(" "))==null?void 0:P.at(0))==null?void 0:L.substring(1);il(D)?h(D):pt.error(o.t("Oops! Looks like the URL is invalid. Please double-check and try again."))};return s.$$set=D=>{"prompt"in D&&e(0,i=D.prompt)},s.$$.update=()=>{s.$$.dirty&8194&&e(11,g=[...n.length>0?[{name:"All Documents",type:"collection",title:o.t("All Documents"),collection_names:n.map(D=>D.collection_name)}]:[],...n.reduce((D,P,L,A)=>{var R;return[...new Set([...D,...(((R=P==null?void 0:P.content)==null?void 0:R.tags)??[]).map(H=>H.name)])]},[]).map(D=>({name:D,type:"collection",collection_names:n.filter(P=>{var L;return(((L=P==null?void 0:P.content)==null?void 0:L.tags)??[]).map(A=>A.name).includes(D)}).map(P=>P.collection_name)}))]),s.$$.dirty&2049&&e(12,l=g.filter(D=>{var P,L;return D.name.includes(((L=(P=i.split(" "))==null?void 0:P.at(0))==null?void 0:L.substring(1))??"")}).sort((D,P)=>D.name.localeCompare(P.name))),s.$$.dirty&8193&&e(10,d=n.filter(D=>{var P,L;return D.name.includes(((L=(P=i.split(" "))==null?void 0:P.at(0))==null?void 0:L.substring(1))??"")}).sort((D,P)=>D.title.localeCompare(P.title))),s.$$.dirty&5120&&e(3,c=[...l,...d]),s.$$.dirty&4097&&i&&(e(2,u=0),console.log(l))},[i,o,u,c,r,b,h,v,p,S,d,g,l,n,w,C,V,B]}class Cr extends Jt{constructor(t){super(),Qt(this,t,Mr,Ir,Gt,{prompt:0,selectUp:8,selectDown:9})}get selectUp(){return this.$$.ctx[8]}get selectDown(){return this.$$.ctx[9]}}function Ol(s,t,e){const l=s.slice();return l[16]=t[e],l[18]=e,l}function Ul(s){let t,e=s[2].length>0&&Pl(s);return{c(){e&&e.c(),t=Ht()},l(l){e&&e.l(l),t=Ht()},m(l,n){e&&e.m(l,n),U(l,t,n)},p(l,n){l[2].length>0?e?e.p(l,n):(e=Pl(l),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(l){l&&m(t),e&&e.d(l)}}}function Pl(s){let t,e,l,n='<div class="text-lg font-semibold mt-2">@</div>',o,r,i,a=$t(s[2]),u=[];for(let c=0;c<a.length;c+=1)u[c]=zl(Ol(s,a,c));return{c(){t=E("div"),e=E("div"),l=E("div"),l.innerHTML=n,o=Q(),r=E("div"),i=E("div");for(let c=0;c<u.length;c+=1)u[c].c();this.h()},l(c){t=I(c,"DIV",{class:!0});var d=k(t);e=I(d,"DIV",{class:!0});var g=k(e);l=I(g,"DIV",{class:!0,"data-svelte-h":!0}),Zt(l)!=="svelte-1ourwwn"&&(l.innerHTML=n),o=Y(g),r=I(g,"DIV",{class:!0});var p=k(r);i=I(p,"DIV",{class:!0});var S=k(i);for(let b=0;b<u.length;b+=1)u[b].l(S);S.forEach(m),p.forEach(m),g.forEach(m),d.forEach(m),this.h()},h(){f(l,"class","bg-gray-100 dark:bg-gray-700 w-10 rounded-l-xl text-center"),f(i,"class","m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5"),f(r,"class","max-h-60 flex flex-col w-full rounded-r-xl bg-white"),f(e,"class","flex w-full px-2"),f(t,"class","pl-1 pr-12 mb-3 text-left w-full absolute bottom-0 left-0 right-0")},m(c,d){U(c,t,d),_(t,e),_(e,l),_(e,o),_(e,r),_(r,i);for(let g=0;g<u.length;g+=1)u[g]&&u[g].m(i,null)},p(c,d){if(d&22){a=$t(c[2]);let g;for(g=0;g<a.length;g+=1){const p=Ol(c,a,g);u[g]?u[g].p(p,d):(u[g]=zl(p),u[g].c(),u[g].m(i,null))}for(;g<u.length;g+=1)u[g].d(1);u.length=a.length}},d(c){c&&m(t),pe(u,c)}}}function zl(s){let t,e,l=s[16].name+"",n,o,r,i,a;function u(){return s[11](s[16])}function c(){return s[12](s[18])}return{c(){t=E("button"),e=E("div"),n=bt(l),o=Q(),this.h()},l(d){t=I(d,"BUTTON",{class:!0,type:!0});var g=k(t);e=I(g,"DIV",{class:!0});var p=k(e);n=wt(p,l),p.forEach(m),o=Y(g),g.forEach(m),this.h()},h(){f(e,"class","font-medium text-black line-clamp-1"),f(t,"class",r="px-3 py-1.5 rounded-xl w-full text-left "+(s[18]===s[1]?" bg-gray-100 selected-command-option-button":"")),f(t,"type","button")},m(d,g){U(d,t,g),_(t,e),_(e,n),_(t,o),i||(a=[et(t,"click",u),et(t,"mousemove",c),et(t,"focus",Vr)],i=!0)},p(d,g){s=d,g&4&&l!==(l=s[16].name+"")&&Vt(n,l),g&2&&r!==(r="px-3 py-1.5 rounded-xl w-full text-left "+(s[18]===s[1]?" bg-gray-100 selected-command-option-button":""))&&f(t,"class",r)},d(d){d&&m(t),i=!1,de(a)}}}function Tr(s){let t=s[0].charAt(0)==="@",e,l=t&&Ul(s);return{c(){l&&l.c(),e=Ht()},l(n){l&&l.l(n),e=Ht()},m(n,o){l&&l.m(n,o),U(n,e,o)},p(n,[o]){o&1&&(t=n[0].charAt(0)==="@"),t?l?l.p(n,o):(l=Ul(n),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},i:kt,o:kt,d(n){n&&m(e),l&&l.d(n)}}}const Vr=()=>{};function Br(s,t,e){let l;it(s,Ae,v=>e(10,l=v));const n=ue("i18n");it(s,n,v=>e(13,v));const o=De();let{prompt:r=""}=t,{user:i=null}=t,{chatInputPlaceholder:a=""}=t,{messages:u=[]}=t,c=0,d=[];const g=()=>{e(1,c=Math.max(0,c-1))},p=()=>{e(1,c=Math.min(c+1,d.length-1))},S=async v=>{e(0,r=""),o("select",v)},b=v=>{S(v)},h=v=>{e(1,c=v)};return s.$$set=v=>{"prompt"in v&&e(0,r=v.prompt),"user"in v&&e(5,i=v.user),"chatInputPlaceholder"in v&&e(6,a=v.chatInputPlaceholder),"messages"in v&&e(7,u=v.messages)},s.$$.update=()=>{s.$$.dirty&1025&&e(2,d=l.filter(v=>{var w,C;return v.name.includes(((C=(w=r.split(" "))==null?void 0:w.at(0))==null?void 0:C.substring(1))??"")}).sort((v,w)=>v.name.localeCompare(w.name))),s.$$.dirty&1&&r&&e(1,c=0)},[r,c,d,n,S,i,a,u,g,p,l,b,h]}class Nr extends Jt{constructor(t){super(),Qt(this,t,Br,Tr,Gt,{prompt:0,user:5,chatInputPlaceholder:6,messages:7,selectUp:8,selectDown:9})}get selectUp(){return this.$$.ctx[8]}get selectDown(){return this.$$.ctx[9]}}function Lr(s){let t,e;return{c(){t=_t("svg"),e=_t("path"),this.h()},l(l){t=vt(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var n=k(t);e=vt(n,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(e).forEach(m),n.forEach(m),this.h()},h(){f(e,"stroke-linecap","round"),f(e,"stroke-linejoin","round"),f(e,"d","M6 18 18 6M6 6l12 12"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"fill","none"),f(t,"viewBox","0 0 24 24"),f(t,"stroke-width",s[1]),f(t,"stroke","currentColor"),f(t,"class",s[0])},m(l,n){U(l,t,n),_(t,e)},p(l,[n]){n&2&&f(t,"stroke-width",l[1]),n&1&&f(t,"class",l[0])},i:kt,o:kt,d(l){l&&m(t)}}}function Hr(s,t,e){let{className:l="size-3.5"}=t,{strokeWidth:n="2"}=t;return s.$$set=o=>{"className"in o&&e(0,l=o.className),"strokeWidth"in o&&e(1,n=o.strokeWidth)},[l,n]}class Ar extends Jt{constructor(t){super(),Qt(this,t,Hr,Lr,Gt,{className:0,strokeWidth:1})}}function Or(s){let t,e,l;return{c(){t=_t("svg"),e=_t("path"),l=_t("path"),this.h()},l(n){t=vt(n,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var o=k(t);e=vt(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),k(e).forEach(m),l=vt(o,"path",{d:!0}),k(l).forEach(m),o.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M5.625 1.5H9a3.75 3.75 0 0 1 3.75 3.75v1.875c0 1.036.84 1.875 1.875 1.875H16.5a3.75 3.75 0 0 1 3.75 3.75v7.875c0 1.035-.84 1.875-1.875 1.875H5.625a1.875 1.875 0 0 1-1.875-1.875V3.375c0-1.036.84-1.875 1.875-1.875Zm6.905 9.97a.75.75 0 0 0-1.06 0l-3 3a.75.75 0 1 0 1.06 1.06l1.72-1.72V18a.75.75 0 0 0 1.5 0v-4.19l1.72 1.72a.75.75 0 1 0 1.06-1.06l-3-3Z"),f(e,"clip-rule","evenodd"),f(l,"d","M14.25 5.25a5.23 5.23 0 0 0-1.279-3.434 9.768 9.768 0 0 1 6.963 6.963A5.23 5.23 0 0 0 16.5 7.5h-1.875a.375.375 0 0 1-.375-.375V5.25Z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class",s[0])},m(n,o){U(n,t,o),_(t,e),_(t,l)},p(n,[o]){o&1&&f(t,"class",n[0])},i:kt,o:kt,d(n){n&&m(t)}}}function Ur(s,t,e){let{className:l="size-4"}=t;return s.$$set=n=>{"className"in n&&e(0,l=n.className)},[l]}class Pr extends Jt{constructor(t){super(),Qt(this,t,Ur,Or,Gt,{className:0})}}function zr(s){let t,e;return{c(){t=_t("svg"),e=_t("path"),this.h()},l(l){t=vt(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var n=k(t);e=vt(n,"path",{d:!0}),k(e).forEach(m),n.forEach(m),this.h()},h(){f(e,"d","M21.721 12.752a9.711 9.711 0 0 0-.945-5.003 12.754 12.754 0 0 1-4.339 2.708 18.991 18.991 0 0 1-.214 4.772 17.165 17.165 0 0 0 5.498-2.477ZM14.634 15.55a17.324 17.324 0 0 0 .332-4.647c-.952.227-1.945.347-2.966.347-1.021 0-2.014-.12-2.966-.347a17.515 17.515 0 0 0 .332 4.647 17.385 17.385 0 0 0 5.268 0ZM9.772 17.119a18.963 18.963 0 0 0 4.456 0A17.182 17.182 0 0 1 12 21.724a17.18 17.18 0 0 1-2.228-4.605ZM7.777 15.23a18.87 18.87 0 0 1-.214-4.774 12.753 12.753 0 0 1-4.34-2.708 9.711 9.711 0 0 0-.944 5.004 17.165 17.165 0 0 0 5.498 2.477ZM21.356 14.752a9.765 9.765 0 0 1-7.478 6.817 18.64 18.64 0 0 0 1.988-4.718 18.627 18.627 0 0 0 5.49-2.098ZM2.644 14.752c1.682.971 3.53 1.688 5.49 2.099a18.64 18.64 0 0 0 1.988 4.718 9.765 9.765 0 0 1-7.478-6.816ZM13.878 2.43a9.755 9.755 0 0 1 6.116 3.986 11.267 11.267 0 0 1-3.746 2.504 18.63 18.63 0 0 0-2.37-6.49ZM12 2.276a17.152 17.152 0 0 1 2.805 7.121c-.897.23-1.837.353-2.805.353-.968 0-1.908-.122-2.805-.353A17.151 17.151 0 0 1 12 2.276ZM10.122 2.43a18.629 18.629 0 0 0-2.37 6.49 11.266 11.266 0 0 1-3.746-2.504 9.754 9.754 0 0 1 6.116-3.985Z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class",s[0])},m(l,n){U(l,t,n),_(t,e)},p(l,[n]){n&1&&f(t,"class",l[0])},i:kt,o:kt,d(l){l&&m(t)}}}function Rr(s,t,e){let{className:l="size-4"}=t;return s.$$set=n=>{"className"in n&&e(0,l=n.className)},[l]}class jr extends Jt{constructor(t){super(),Qt(this,t,Rr,zr,Gt,{className:0})}}function Fr(s){let t;const e=s[7].default,l=oe(e,s,s[12],null);return{c(){l&&l.c()},l(n){l&&l.l(n)},m(n,o){l&&l.m(n,o),t=!0},p(n,o){l&&l.p&&(!t||o&4096)&&ie(l,e,n,n[12],t?ce(e,n[12],o,null):ae(n[12]),null)},i(n){t||(O(l,n),t=!0)},o(n){z(l,n),t=!1},d(n){l&&l.d(n)}}}function qr(s){let t,e;return t=new ge({props:{content:s[5].t("More"),$$slots:{default:[Fr]},$$scope:{ctx:s}}}),{c(){at(t.$$.fragment)},l(l){ct(t.$$.fragment,l)},m(l,n){ut(t,l,n),e=!0},p(l,n){const o={};n&32&&(o.content=l[5].t("More")),n&4096&&(o.$$scope={dirty:n,ctx:l}),t.$set(o)},i(l){e||(O(t.$$.fragment,l),e=!0)},o(l){z(t.$$.fragment,l),e=!1},d(l){ft(t,l)}}}function Rl(s){let t,e,l,n,o,r=s[5].t("Web Search")+"",i,a,u,c,d,g,p;l=new jr({});function S(h){s[8](h)}let b={};return s[0]!==void 0&&(b.state=s[0]),u=new rs({props:b}),Et.push(()=>Ut(u,"state",S)),{c(){t=E("div"),e=E("div"),at(l.$$.fragment),n=Q(),o=E("div"),i=bt(r),a=Q(),at(u.$$.fragment),d=Q(),g=E("hr"),this.h()},l(h){t=I(h,"DIV",{class:!0});var v=k(t);e=I(v,"DIV",{class:!0});var w=k(e);ct(l.$$.fragment,w),n=Y(w),o=I(w,"DIV",{class:!0});var C=k(o);i=wt(C,r),C.forEach(m),w.forEach(m),a=Y(v),ct(u.$$.fragment,v),v.forEach(m),d=Y(h),g=I(h,"HR",{class:!0}),this.h()},h(){f(o,"class","flex items-center"),f(e,"class","flex-1 flex items-center gap-2"),f(t,"class","flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer rounded-xl"),f(g,"class","border-gray-100 dark:border-gray-800 my-1")},m(h,v){U(h,t,v),_(t,e),ut(l,e,null),_(e,n),_(e,o),_(o,i),_(t,a),ut(u,t,null),U(h,d,v),U(h,g,v),p=!0},p(h,v){(!p||v&32)&&r!==(r=h[5].t("Web Search")+"")&&Vt(i,r);const w={};!c&&v&1&&(c=!0,w.state=h[0],Ot(()=>c=!1)),u.$set(w)},i(h){p||(O(l.$$.fragment,h),O(u.$$.fragment,h),p=!0)},o(h){z(l.$$.fragment,h),z(u.$$.fragment,h),p=!1},d(h){h&&(m(t),m(d),m(g)),ft(l),ft(u)}}}function Wr(s){let t,e,l,n=s[5].t("Upload Files")+"",o,r;return t=new Pr({}),{c(){at(t.$$.fragment),e=Q(),l=E("div"),o=bt(n),this.h()},l(i){ct(t.$$.fragment,i),e=Y(i),l=I(i,"DIV",{class:!0});var a=k(l);o=wt(a,n),a.forEach(m),this.h()},h(){f(l,"class","flex items-center")},m(i,a){ut(t,i,a),U(i,e,a),U(i,l,a),_(l,o),r=!0},p(i,a){(!r||a&32)&&n!==(n=i[5].t("Upload Files")+"")&&Vt(o,n)},i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){z(t.$$.fragment,i),r=!1},d(i){i&&(m(e),m(l)),ft(t,i)}}}function Zr(s){var o,r;let t,e,l,n=((r=(o=s[4])==null?void 0:o.features)==null?void 0:r.enable_web_search)&&Rl(s);return e=new we({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl",$$slots:{default:[Wr]},$$scope:{ctx:s}}}),e.$on("click",s[9]),{c(){n&&n.c(),t=Q(),at(e.$$.fragment)},l(i){n&&n.l(i),t=Y(i),ct(e.$$.fragment,i)},m(i,a){n&&n.m(i,a),U(i,t,a),ut(e,i,a),l=!0},p(i,a){var c,d;(d=(c=i[4])==null?void 0:c.features)!=null&&d.enable_web_search?n?(n.p(i,a),a&16&&O(n,1)):(n=Rl(i),n.c(),O(n,1),n.m(t.parentNode,t)):n&&(zt(),z(n,1,1,()=>{n=null}),Rt());const u={};a&4128&&(u.$$scope={dirty:a,ctx:i}),e.$set(u)},i(i){l||(O(n),O(e.$$.fragment,i),l=!0)},o(i){z(n),z(e.$$.fragment,i),l=!1},d(i){i&&m(t),n&&n.d(i),ft(e,i)}}}function xr(s){let t,e,l;return e=new $e({props:{class:"w-full max-w-[190px] rounded-xl px-1 py-1  border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow",sideOffset:15,alignOffset:-8,side:"top",align:"start",transition:Oe,$$slots:{default:[Zr]},$$scope:{ctx:s}}}),{c(){t=E("div"),at(e.$$.fragment),this.h()},l(n){t=I(n,"DIV",{slot:!0});var o=k(t);ct(e.$$.fragment,o),o.forEach(m),this.h()},h(){f(t,"slot","content")},m(n,o){U(n,t,o),ut(e,t,null),l=!0},p(n,o){const r={};o&4147&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){l||(O(e.$$.fragment,n),l=!0)},o(n){z(e.$$.fragment,n),l=!1},d(n){n&&m(t),ft(e)}}}function Gr(s){let t,e,l;function n(r){s[10](r)}let o={$$slots:{content:[xr],default:[qr]},$$scope:{ctx:s}};return s[3]!==void 0&&(o.show=s[3]),t=new Ke({props:o}),Et.push(()=>Ut(t,"show",n)),t.$on("change",s[11]),{c(){at(t.$$.fragment)},l(r){ct(t.$$.fragment,r)},m(r,i){ut(t,r,i),l=!0},p(r,[i]){const a={};i&4147&&(a.$$scope={dirty:i,ctx:r}),!e&&i&8&&(e=!0,a.show=r[3],Ot(()=>e=!1)),t.$set(a)},i(r){l||(O(t.$$.fragment,r),l=!0)},o(r){z(t.$$.fragment,r),l=!1},d(r){ft(t,r)}}}function Jr(s,t,e){let l,n;it(s,Me,h=>e(4,l=h));let{$$slots:o={},$$scope:r}=t;const i=ue("i18n");it(s,i,h=>e(5,n=h));let{uploadFilesHandler:a}=t,{webSearchEnabled:u}=t,{onClose:c}=t,d=!1;function g(h){u=h,e(0,u)}const p=()=>{a()};function S(h){d=h,e(3,d)}const b=h=>{h.detail===!1&&c()};return s.$$set=h=>{"uploadFilesHandler"in h&&e(1,a=h.uploadFilesHandler),"webSearchEnabled"in h&&e(0,u=h.webSearchEnabled),"onClose"in h&&e(2,c=h.onClose),"$$scope"in h&&e(12,r=h.$$scope)},[u,a,c,d,l,n,i,o,g,p,S,b,r]}class Qr extends Jt{constructor(t){super(),Qt(this,t,Jr,Gr,Gt,{uploadFilesHandler:1,webSearchEnabled:0,onClose:2})}}function Yr(s){let t,e;return{c(){t=_t("svg"),e=_t("path"),this.h()},l(l){t=vt(l,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var n=k(t);e=vt(n,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),k(e).forEach(m),n.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M12 5a7 7 0 0 0-7 7v1.17c.313-.11.65-.17 1-.17h2a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H6a3 3 0 0 1-3-3v-6a9 9 0 0 1 18 0v6a3 3 0 0 1-3 3h-2a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1h2c.35 0 .687.06 1 .17V12a7 7 0 0 0-7-7Z"),f(e,"clip-rule","evenodd"),f(t,"aria-hidden","true"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"fill","currentColor"),f(t,"viewBox","0 0 24 24"),f(t,"stroke-width",s[1]),f(t,"stroke","currentColor"),f(t,"class",s[0])},m(l,n){U(l,t,n),_(t,e)},p(l,[n]){n&2&&f(t,"stroke-width",l[1]),n&1&&f(t,"class",l[0])},i:kt,o:kt,d(l){l&&m(t)}}}function Xr(s,t,e){let{className:l="w-4 h-4"}=t,{strokeWidth:n="0"}=t;return s.$$set=o=>{"className"in o&&e(0,l=o.className),"strokeWidth"in o&&e(1,n=o.strokeWidth)},[l,n]}class Kr extends Jt{constructor(t){super(),Qt(this,t,Xr,Yr,Gt,{className:0,strokeWidth:1})}}function jl(s,t,e){const l=s.slice();return l[29]=t[e],l}function Fl(s){let t,e;return{c(){t=E("div"),this.h()},l(l){t=I(l,"DIV",{class:!0,style:!0}),k(t).forEach(m),this.h()},h(){f(t,"class",e="w-[2px] "+(s[0]?" bg-gray-500 dark:bg-gray-400   ":"bg-indigo-500 dark:bg-indigo-400  ")+" inline-block h-full"),Te(t,"height",Math.min(100,Math.max(14,s[29]*100))+"%")},m(l,n){U(l,t,n)},p(l,n){n[0]&1&&e!==(e="w-[2px] "+(l[0]?" bg-gray-500 dark:bg-gray-400   ":"bg-indigo-500 dark:bg-indigo-400  ")+" inline-block h-full")&&f(t,"class",e),n[0]&4&&Te(t,"height",Math.min(100,Math.max(14,l[29]*100))+"%")},d(l){l&&m(t)}}}function $r(s){let t,e='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="size-4"><path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5"></path></svg>',l,n;return{c(){t=E("button"),t.innerHTML=e,this.h()},l(o){t=I(o,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),Zt(t)!=="svelte-1qzkal"&&(t.innerHTML=e),this.h()},h(){f(t,"type","button"),f(t,"class","p-1.5 bg-indigo-500 text-white dark:bg-indigo-500 dark:text-blue-950 rounded-full")},m(o,r){U(o,t,r),l||(n=et(t,"click",s[10]),l=!0)},p:kt,d(o){o&&m(t),l=!1,n()}}}function to(s){let t,e=`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><style>.spinner_OSmW {
							transform-origin: center;
							animation: spinner_T6mA 0.75s step-end infinite;
						}
						@keyframes spinner_T6mA {
							8.3% {
								transform: rotate(30deg);
							}
							16.6% {
								transform: rotate(60deg);
							}
							25% {
								transform: rotate(90deg);
							}
							33.3% {
								transform: rotate(120deg);
							}
							41.6% {
								transform: rotate(150deg);
							}
							50% {
								transform: rotate(180deg);
							}
							58.3% {
								transform: rotate(210deg);
							}
							66.6% {
								transform: rotate(240deg);
							}
							75% {
								transform: rotate(270deg);
							}
							83.3% {
								transform: rotate(300deg);
							}
							91.6% {
								transform: rotate(330deg);
							}
							100% {
								transform: rotate(360deg);
							}
						}
					</style><g class="spinner_OSmW"><rect x="11" y="1" width="2" height="5" opacity=".14"></rect><rect x="11" y="1" width="2" height="5" transform="rotate(30 12 12)" opacity=".29"></rect><rect x="11" y="1" width="2" height="5" transform="rotate(60 12 12)" opacity=".43"></rect><rect x="11" y="1" width="2" height="5" transform="rotate(90 12 12)" opacity=".57"></rect><rect x="11" y="1" width="2" height="5" transform="rotate(120 12 12)" opacity=".71"></rect><rect x="11" y="1" width="2" height="5" transform="rotate(150 12 12)" opacity=".86"></rect><rect x="11" y="1" width="2" height="5" transform="rotate(180 12 12)"></rect></g></svg>`;return{c(){t=E("div"),t.innerHTML=e,this.h()},l(l){t=I(l,"DIV",{class:!0,"data-svelte-h":!0}),Zt(t)!=="svelte-otpw2s"&&(t.innerHTML=e),this.h()},h(){f(t,"class","text-gray-500 rounded-full cursor-not-allowed")},m(l,n){U(l,t,n)},p:kt,d(l){l&&m(t)}}}function eo(s){let t,e,l,n,o,r,i,a,u,c,d,g,p=s[5](s[1])+"",S,b,h,v,w,C,V,B=$t(s[2].slice().reverse()),D=[];for(let R=0;R<B.length;R+=1)D[R]=Fl(jl(s,B,R));function P(R,H){return R[0]?to:$r}let L=P(s),A=L(s);return{c(){t=E("div"),e=E("div"),l=E("button"),n=_t("svg"),o=_t("path"),i=Q(),a=E("div"),u=E("div");for(let R=0;R<D.length;R+=1)D[R].c();c=Q(),d=E("div"),g=E("div"),S=bt(p),h=Q(),v=E("div"),A.c(),this.h()},l(R){t=I(R,"DIV",{class:!0});var H=k(t);e=I(H,"DIV",{class:!0});var F=k(e);l=I(F,"BUTTON",{type:!0,class:!0});var j=k(l);n=vt(j,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var M=k(n);o=vt(M,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(o).forEach(m),M.forEach(m),j.forEach(m),F.forEach(m),i=Y(H),a=I(H,"DIV",{class:!0,dir:!0});var q=k(a);u=I(q,"DIV",{class:!0});var ot=k(u);for(let lt=0;lt<D.length;lt+=1)D[lt].l(ot);ot.forEach(m),q.forEach(m),c=Y(H),d=I(H,"DIV",{class:!0});var Z=k(d);g=I(Z,"DIV",{class:!0});var J=k(g);S=wt(J,p),J.forEach(m),Z.forEach(m),h=Y(H),v=I(H,"DIV",{class:!0});var X=k(v);A.l(X),X.forEach(m),H.forEach(m),this.h()},h(){f(o,"stroke-linecap","round"),f(o,"stroke-linejoin","round"),f(o,"d","M6 18 18 6M6 6l12 12"),f(n,"xmlns","http://www.w3.org/2000/svg"),f(n,"fill","none"),f(n,"viewBox","0 0 24 24"),f(n,"stroke-width","3"),f(n,"stroke","currentColor"),f(n,"class","size-4"),f(l,"type","button"),f(l,"class",r="p-1.5 "+(s[0]?" bg-gray-200 dark:bg-gray-700/50":"bg-indigo-400/20 text-indigo-600 dark:text-indigo-300 ")+" rounded-full"),f(e,"class","flex items-center mr-1"),f(u,"class","flex-1 flex items-center gap-0.5 h-6"),f(a,"class","flex flex-1 self-center items-center justify-between ml-2 mx-1 overflow-hidden h-6"),f(a,"dir","rtl"),f(g,"class",b="text-sm "+(s[0]?" text-gray-500  dark:text-gray-400  ":" text-indigo-400 ")+" font-medium flex-1 mx-auto text-center"),f(d,"class","mx-1.5 pr-1 flex justify-center items-center"),f(v,"class","flex items-center mr-1"),f(t,"class",w=(s[0]?" bg-gray-100/50 dark:bg-gray-850/50":"bg-indigo-300/10 dark:bg-indigo-500/10 ")+" rounded-full flex p-2.5")},m(R,H){U(R,t,H),_(t,e),_(e,l),_(l,n),_(n,o),_(t,i),_(t,a),_(a,u);for(let F=0;F<D.length;F+=1)D[F]&&D[F].m(u,null);_(t,c),_(t,d),_(d,g),_(g,S),_(t,h),_(t,v),A.m(v,null),C||(V=et(l,"click",s[9]),C=!0)},p(R,H){if(H[0]&1&&r!==(r="p-1.5 "+(R[0]?" bg-gray-200 dark:bg-gray-700/50":"bg-indigo-400/20 text-indigo-600 dark:text-indigo-300 ")+" rounded-full")&&f(l,"class",r),H[0]&5){B=$t(R[2].slice().reverse());let F;for(F=0;F<B.length;F+=1){const j=jl(R,B,F);D[F]?D[F].p(j,H):(D[F]=Fl(j),D[F].c(),D[F].m(u,null))}for(;F<D.length;F+=1)D[F].d(1);D.length=B.length}H[0]&2&&p!==(p=R[5](R[1])+"")&&Vt(S,p),H[0]&1&&b!==(b="text-sm "+(R[0]?" text-gray-500  dark:text-gray-400  ":" text-indigo-400 ")+" font-medium flex-1 mx-auto text-center")&&f(g,"class",b),L===(L=P(R))&&A?A.p(R,H):(A.d(1),A=L(R),A&&(A.c(),A.m(v,null))),H[0]&1&&w!==(w=(R[0]?" bg-gray-100/50 dark:bg-gray-850/50":"bg-indigo-300/10 dark:bg-indigo-500/10 ")+" rounded-full flex p-2.5")&&f(t,"class",w)},i:kt,o:kt,d(R){R&&m(t),pe(D,R),A.d(),C=!1,V()}}}const ql=300;function lo(s,t,e){let l,n,o;it(s,fe,q=>e(18,n=q)),it(s,Me,q=>e(19,o=q));const r=ue("i18n");it(s,r,q=>e(17,l=q));const i=De();let{recording:a=!1}=t,u=!1,c=!1,d=0,g=null,p="";const S=()=>{g=setInterval(()=>{e(1,d++,d)},1e3)},b=()=>{clearInterval(g),e(1,d=0)},h=q=>{const ot=Math.floor(q/60),Z=q%60,J=Z<10?`0${Z}`:Z;return`${ot}:${J}`};let v,w,C=[];const V=-45;let B=Array(ql).fill(0);const D=q=>{let ot=0;for(let Z=0;Z<q.length;Z++){const J=(q[Z]-128)/128;ot+=J*J}return Math.sqrt(ot/q.length)},P=q=>{q=q*10;const Z=Math.pow(q,1.5);return Math.min(1,Math.max(.01,Z))},L=q=>{const ot=new AudioContext,Z=ot.createMediaStreamSource(q),J=ot.createAnalyser();J.minDecibels=V,Z.connect(J);const X=J.frequencyBinCount,lt=new Uint8Array(X),At=new Uint8Array(J.fftSize);(()=>{const Xt=()=>{if(!(!a||u)){if(a&&!u){J.getByteTimeDomainData(At),J.getByteFrequencyData(lt);const Wt=D(At);B.push(P(Wt)),B.length>=ql&&B.shift(),e(2,B)}window.requestAnimationFrame(Xt)}};window.requestAnimationFrame(Xt)})()},A=async q=>{await Bt();const ot=Xe(q,"recording.wav"),Z=await vn(localStorage.token,ot).catch(J=>(pt.error(J),null));Z&&(console.log(Z.text),i("confirm",Z.text))},R=async()=>{var ot,Z;S();const q=await navigator.mediaDevices.getUserMedia({audio:!0});if(w=new MediaRecorder(q),w.onstart=()=>{console.log("Recording started"),C=[],L(q)},w.ondataavailable=J=>C.push(J.data),w.onstop=async()=>{var J,X;if(console.log("Recording stopped"),(((X=(J=n==null?void 0:n.audio)==null?void 0:J.stt)==null?void 0:X.engine)??"")==="web")C=[];else{if(c){const lt=new Blob(C,{type:"audio/wav"});await A(lt),c=!1,e(0,u=!1)}C=[],e(8,a=!1)}},w.start(),(o.audio.stt.engine==="web"||(((Z=(ot=n==null?void 0:n.audio)==null?void 0:ot.stt)==null?void 0:Z.engine)??"")==="web")&&("SpeechRecognition"in window||"webkitSpeechRecognition"in window)){v=new(window.SpeechRecognition||window.webkitSpeechRecognition),v.continuous=!0;const J=2e3;let X;v.start(),v.onresult=async lt=>{var Pt;clearTimeout(X),console.log(lt);const At=lt.results[Object.keys(lt.results).length-1][0].transcript;p=`${p}${At}`,await Bt(),(Pt=document.getElementById("chat-textarea"))==null||Pt.focus(),X=setTimeout(()=>{console.log("Speech recognition turned off due to inactivity."),v.stop()},J)},v.onend=function(){console.log("recognition ended"),F(),i("confirm",p),c=!1,e(0,u=!1)},v.onerror=function(lt){console.log(lt),pt.error(l.t("Speech recognition error: {{error}}",{error:lt.error})),i("cancel"),H()}}},H=async()=>{a&&w&&await w.stop(),b(),C=[]},F=async()=>{e(0,u=!0),c=!0,a&&w&&await w.stop(),clearInterval(g)},j=async()=>{i("cancel"),H()},M=async()=>{await F()};return s.$$set=q=>{"recording"in q&&e(8,a=q.recording)},s.$$.update=()=>{s.$$.dirty[0]&256&&(a?R():H())},[u,d,B,r,i,h,H,F,a,j,M]}class no extends Jt{constructor(t){super(),Qt(this,t,lo,eo,Gt,{recording:8},null,[-1,-1])}}function Wl(s,t,e){const l=s.slice();return l[69]=t[e],l[71]=e,l}function Zl(s){let t,e,l,n,o,r,i;return o=new $n({}),{c(){t=E("div"),e=E("div"),l=E("div"),n=E("div"),at(o.$$.fragment),this.h()},l(a){t=I(a,"DIV",{class:!0,id:!0,role:!0,"aria-label":!0});var u=k(t);e=I(u,"DIV",{class:!0});var c=k(e);l=I(c,"DIV",{class:!0});var d=k(l);n=I(d,"DIV",{class:!0});var g=k(n);ct(o.$$.fragment,g),g.forEach(m),d.forEach(m),c.forEach(m),u.forEach(m),this.h()},h(){f(n,"class","max-w-md"),f(l,"class","m-auto pt-64 flex flex-col justify-center"),f(e,"class","absolute w-full h-full backdrop-blur bg-gray-800/40 flex justify-center"),f(t,"class",r="fixed "+(s[22]?"left-0 md:left-[260px] md:w-[calc(100%-260px)]":"left-0")+" w-full h-full flex z-50 touch-none pointer-events-none"),f(t,"id","dropzone"),f(t,"role","region"),f(t,"aria-label","Drag and Drop Container")},m(a,u){U(a,t,u),_(t,e),_(e,l),_(l,n),ut(o,n,null),i=!0},p(a,u){(!i||u[0]&4194304&&r!==(r="fixed "+(a[22]?"left-0 md:left-[260px] md:w-[calc(100%-260px)]":"left-0")+" w-full h-full flex z-50 touch-none pointer-events-none"))&&f(t,"class",r)},i(a){i||(O(o.$$.fragment,a),i=!0)},o(a){z(o.$$.fragment,a),i=!1},d(a){a&&m(t),ft(o)}}}function xl(s){let t,e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z" clip-rule="evenodd"></path></svg>',n,o;return{c(){t=E("div"),e=E("button"),e.innerHTML=l,this.h()},l(r){t=I(r,"DIV",{class:!0});var i=k(t);e=I(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Zt(e)!=="svelte-a2mahu"&&(e.innerHTML=l),i.forEach(m),this.h()},h(){f(e,"class","bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full"),f(t,"class","absolute -top-12 left-0 right-0 flex justify-center z-30")},m(r,i){U(r,t,i),_(t,e),n||(o=et(e,"click",s[31]),n=!0)},p:kt,d(r){r&&m(t),n=!1,o()}}}function so(s){let t,e,l;function n(r){s[36](r)}let o={};return s[1]!==void 0&&(o.prompt=s[1]),t=new Cr({props:o}),s[35](t),Et.push(()=>Ut(t,"prompt",n)),t.$on("youtube",s[37]),t.$on("url",s[38]),t.$on("select",s[39]),{c(){at(t.$$.fragment)},l(r){ct(t.$$.fragment,r)},m(r,i){ut(t,r,i),l=!0},p(r,i){const a={};!e&&i[0]&2&&(e=!0,a.prompt=r[1],Ot(()=>e=!1)),t.$set(a)},i(r){l||(O(t.$$.fragment,r),l=!0)},o(r){z(t.$$.fragment,r),l=!1},d(r){s[35](null),ft(t,r)}}}function ro(s){let t,e,l,n;function o(a){s[33](a)}function r(a){s[34](a)}let i={};return s[1]!==void 0&&(i.prompt=s[1]),s[3]!==void 0&&(i.files=s[3]),t=new br({props:i}),s[32](t),Et.push(()=>Ut(t,"prompt",o)),Et.push(()=>Ut(t,"files",r)),{c(){at(t.$$.fragment)},l(a){ct(t.$$.fragment,a)},m(a,u){ut(t,a,u),n=!0},p(a,u){const c={};!e&&u[0]&2&&(e=!0,c.prompt=a[1],Ot(()=>e=!1)),!l&&u[0]&8&&(l=!0,c.files=a[3],Ot(()=>l=!1)),t.$set(c)},i(a){n||(O(t.$$.fragment,a),n=!0)},o(a){z(t.$$.fragment,a),n=!1},d(a){s[32](null),ft(t,a)}}}function Gl(s){let t,e,l,n,o,r,i,a,u=s[0].name+"",c,d,g,p,S,b,h,v;return S=new Ar({}),{c(){t=E("div"),e=E("div"),l=E("img"),o=Q(),r=E("div"),i=bt("Talking to "),a=E("span"),c=bt(u),d=Q(),g=E("div"),p=E("button"),at(S.$$.fragment),this.h()},l(w){t=I(w,"DIV",{class:!0});var C=k(t);e=I(C,"DIV",{class:!0});var V=k(e);l=I(V,"IMG",{crossorigin:!0,alt:!0,class:!0,src:!0}),o=Y(V),r=I(V,"DIV",{});var B=k(r);i=wt(B,"Talking to "),a=I(B,"SPAN",{class:!0});var D=k(a);c=wt(D,u),D.forEach(m),B.forEach(m),V.forEach(m),d=Y(C),g=I(C,"DIV",{});var P=k(g);p=I(P,"BUTTON",{class:!0});var L=k(p);ct(S.$$.fragment,L),L.forEach(m),P.forEach(m),C.forEach(m),this.h()},h(){var w,C,V;f(l,"crossorigin","anonymous"),f(l,"alt","model profile"),f(l,"class","size-5 max-w-[28px] object-cover rounded-full"),ve(l.src,n=((V=(C=(w=s[10].find(s[45]))==null?void 0:w.info)==null?void 0:C.meta)==null?void 0:V.profile_image_url)??(s[21].language==="dg-DG"?"/doge.png":`${Le}/static/favicon.png`))||f(l,"src",n),f(a,"class","font-medium"),f(e,"class","flex items-center gap-2 text-sm dark:text-gray-500"),f(p,"class","flex items-center"),f(t,"class","px-3 py-2.5 text-left w-full flex justify-between items-center absolute bottom-0 left-0 right-0 bg-gradient-to-t from-50% from-white dark:from-gray-900")},m(w,C){U(w,t,C),_(t,e),_(e,l),_(e,o),_(e,r),_(r,i),_(r,a),_(a,c),_(t,d),_(t,g),_(g,p),ut(S,p,null),b=!0,h||(v=et(p,"click",s[46]),h=!0)},p(w,C){var V,B,D;(!b||C[0]&2098177&&!ve(l.src,n=((D=(B=(V=w[10].find(w[45]))==null?void 0:V.info)==null?void 0:B.meta)==null?void 0:D.profile_image_url)??(w[21].language==="dg-DG"?"/doge.png":`${Le}/static/favicon.png`)))&&f(l,"src",n),(!b||C[0]&1)&&u!==(u=w[0].name+"")&&Vt(c,u)},i(w){b||(O(S.$$.fragment,w),b=!0)},o(w){z(S.$$.fragment,w),b=!1},d(w){w&&m(t),ft(S),h=!1,v()}}}function oo(s){let t,e,l,n,o,r,i,a,u,c,d,g,p=s[8].length==0||s[8].at(-1).done==!0,S,b,h,v,w,C,V,B,D,P=s[3].length>0&&Jl(s);function L(M){s[57](M)}let A={uploadFilesHandler:s[55],onClose:s[56],$$slots:{default:[go]},$$scope:{ctx:s}};s[4]!==void 0&&(A.webSearchEnabled=s[4]),r=new Qr({props:A}),Et.push(()=>Ut(r,"webSearchEnabled",L));let R=p&&Xl(s);const H=[vo,_o],F=[];function j(M,q){return q[0]&256&&(v=null),v==null&&(v=M[8].length==0||M[8].at(-1).done==!0),v?0:1}return w=j(s,[-1,-1,-1]),C=F[w]=H[w](s),{c(){t=E("form"),e=E("div"),P&&P.c(),l=Q(),n=E("div"),o=E("div"),at(r.$$.fragment),a=Q(),u=E("textarea"),d=Q(),g=E("div"),R&&R.c(),b=Q(),h=E("div"),C.c(),this.h()},l(M){t=I(M,"FORM",{class:!0});var q=k(t);e=I(q,"DIV",{class:!0,dir:!0});var ot=k(e);P&&P.l(ot),l=Y(ot),n=I(ot,"DIV",{class:!0});var Z=k(n);o=I(Z,"DIV",{class:!0});var J=k(o);ct(r.$$.fragment,J),J.forEach(m),a=Y(Z),u=I(Z,"TEXTAREA",{id:!0,class:!0,placeholder:!0,rows:!0}),k(u).forEach(m),d=Y(Z),g=I(Z,"DIV",{class:!0});var X=k(g);R&&R.l(X),X.forEach(m),Z.forEach(m),ot.forEach(m),b=Y(q),h=I(q,"DIV",{class:!0});var lt=k(h);C.l(lt),lt.forEach(m),q.forEach(m),this.h()},h(){var M;f(o,"class","ml-0.5 self-end mb-1.5 flex space-x-1"),f(u,"id","chat-textarea"),f(u,"class","scrollbar-hidden bg-gray-50 dark:bg-gray-850 dark:text-gray-100 outline-none w-full py-3 px-1 rounded-xl resize-none h-[48px] svelte-141e0sl"),f(u,"placeholder",c=s[19]!==""?s[19]:s[21].t("Send a Message")),f(u,"rows","1"),f(g,"class","self-end mb-2 flex space-x-1 mr-1"),f(n,"class","flex"),f(e,"class","flex-1 flex flex-col relative w-full rounded-3xl px-1.5 bg-gray-50 dark:bg-gray-850 dark:text-gray-100"),f(e,"dir",S=((M=s[23])==null?void 0:M.chatDirection)??"LTR"),f(h,"class","flex items-end w-10"),f(t,"class","w-full flex gap-1.5")},m(M,q){U(M,t,q),_(t,e),P&&P.m(e,null),_(e,l),_(e,n),_(n,o),ut(r,o,null),_(n,a),_(n,u),s[58](u),nl(u,s[1]),_(n,d),_(n,g),R&&R.m(g,null),_(t,b),_(t,h),F[w].m(h,null),V=!0,B||(D=[et(u,"input",s[59]),et(u,"keypress",s[60]),et(u,"keydown",s[61]),et(u,"input",s[62]),et(u,"focus",s[63]),et(u,"paste",s[64]),et(t,"submit",kn(s[68]))],B=!0)},p(M,q){var J;M[3].length>0?P?(P.p(M,q),q[0]&8&&O(P,1)):(P=Jl(M),P.c(),O(P,1),P.m(e,l)):P&&(zt(),z(P,1,1,()=>{P=null}),Rt());const ot={};q[0]&4096&&(ot.uploadFilesHandler=M[55]),q[0]&512&&(ot.onClose=M[56]),q[2]&1024&&(ot.$$scope={dirty:q,ctx:M}),!i&&q[0]&16&&(i=!0,ot.webSearchEnabled=M[4],Ot(()=>i=!1)),r.$set(ot),(!V||q[0]&2621440&&c!==(c=M[19]!==""?M[19]:M[21].t("Send a Message")))&&f(u,"placeholder",c),q[0]&2&&nl(u,M[1]),q[0]&256&&(p=M[8].length==0||M[8].at(-1).done==!0),p?R?(R.p(M,q),q[0]&256&&O(R,1)):(R=Xl(M),R.c(),O(R,1),R.m(g,null)):R&&(zt(),z(R,1,1,()=>{R=null}),Rt()),(!V||q[0]&8388608&&S!==(S=((J=M[23])==null?void 0:J.chatDirection)??"LTR"))&&f(e,"dir",S);let Z=w;w=j(M,q),w===Z?F[w].p(M,q):(zt(),z(F[Z],1,1,()=>{F[Z]=null}),Rt(),C=F[w],C?C.p(M,q):(C=F[w]=H[w](M),C.c()),O(C,1),C.m(h,null))},i(M){V||(O(P),O(r.$$.fragment,M),O(R),O(C),V=!0)},o(M){z(P),z(r.$$.fragment,M),z(R),z(C),V=!1},d(M){M&&m(t),P&&P.d(),ft(r),s[58](null),R&&R.d(),F[w].d(),B=!1,de(D)}}}function io(s){let t,e,l;function n(r){s[50](r)}let o={};return s[11]!==void 0&&(o.recording=s[11]),t=new no({props:o}),Et.push(()=>Ut(t,"recording",n)),t.$on("cancel",s[51]),t.$on("confirm",s[52]),{c(){at(t.$$.fragment)},l(r){ct(t.$$.fragment,r)},m(r,i){ut(t,r,i),l=!0},p(r,i){const a={};!e&&i[0]&2048&&(e=!0,a.recording=r[11],Ot(()=>e=!1)),t.$set(a)},i(r){l||(O(t.$$.fragment,r),l=!0)},o(r){z(t.$$.fragment,r),l=!1},d(r){ft(t,r)}}}function Jl(s){let t,e,l=$t(s[3]),n=[];for(let r=0;r<l.length;r+=1)n[r]=Yl(Wl(s,l,r));const o=r=>z(n[r],1,1,()=>{n[r]=null});return{c(){t=E("div");for(let r=0;r<n.length;r+=1)n[r].c();this.h()},l(r){t=I(r,"DIV",{class:!0});var i=k(t);for(let a=0;a<n.length;a+=1)n[a].l(i);i.forEach(m),this.h()},h(){f(t,"class","mx-2 mt-2 mb-1 flex flex-wrap gap-2")},m(r,i){U(r,t,i);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(t,null);e=!0},p(r,i){if(i[0]&3145865){l=$t(r[3]);let a;for(a=0;a<l.length;a+=1){const u=Wl(r,l,a);n[a]?(n[a].p(u,i),O(n[a],1)):(n[a]=Yl(u),n[a].c(),O(n[a],1),n[a].m(t,null))}for(zt(),a=l.length;a<n.length;a+=1)o(a);Rt()}},i(r){if(!e){for(let i=0;i<l.length;i+=1)O(n[i]);e=!0}},o(r){n=n.filter(Boolean);for(let i=0;i<n.length;i+=1)z(n[i]);e=!1},d(r){r&&m(t),pe(n,r)}}}function ao(s){var p;let t,e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6"><path d="M7.5 3.375c0-1.036.84-1.875 1.875-1.875h.375a3.75 3.75 0 0 1 3.75 3.75v1.875C13.5 8.161 14.34 9 15.375 9h1.875A3.75 3.75 0 0 1 21 12.75v3.375C21 17.16 20.16 18 19.125 18h-9.75A1.875 1.875 0 0 1 7.5 16.125V3.375Z"></path><path d="M15 5.25a5.23 5.23 0 0 0-1.279-3.434 9.768 9.768 0 0 1 6.963 6.963A5.23 5.23 0 0 0 17.25 7.5h-1.875A.375.375 0 0 1 15 7.125V5.25ZM4.875 6H6v10.125A3.375 3.375 0 0 0 9.375 19.5H16.5v1.125c0 1.035-.84 1.875-1.875 1.875h-9.75A1.875 1.875 0 0 1 3 20.625V7.875C3 6.839 3.84 6 4.875 6Z"></path></svg>',n,o,r,i=(((p=s[69])==null?void 0:p.title)??`#${s[69].name}`)+"",a,u,c,d=s[21].t("Collection")+"",g;return{c(){t=E("div"),e=E("div"),e.innerHTML=l,n=Q(),o=E("div"),r=E("div"),a=bt(i),u=Q(),c=E("div"),g=bt(d),this.h()},l(S){t=I(S,"DIV",{class:!0});var b=k(t);e=I(b,"DIV",{class:!0,"data-svelte-h":!0}),Zt(e)!=="svelte-1kdy8bu"&&(e.innerHTML=l),n=Y(b),o=I(b,"DIV",{class:!0});var h=k(o);r=I(h,"DIV",{class:!0});var v=k(r);a=wt(v,i),v.forEach(m),u=Y(h),c=I(h,"DIV",{class:!0});var w=k(c);g=wt(w,d),w.forEach(m),h.forEach(m),b.forEach(m),this.h()},h(){f(e,"class","p-2.5 bg-red-400 text-white rounded-lg"),f(r,"class","dark:text-gray-100 text-sm font-medium line-clamp-1"),f(c,"class","text-gray-500 text-sm"),f(o,"class","flex flex-col justify-center -space-y-0.5"),f(t,"class","h-16 w-[15rem] flex items-center space-x-3 px-2.5 dark:bg-gray-600 rounded-xl border border-gray-200 dark:border-none")},m(S,b){U(S,t,b),_(t,e),_(t,n),_(t,o),_(o,r),_(r,a),_(o,u),_(o,c),_(c,g)},p(S,b){var h;b[0]&8&&i!==(i=(((h=S[69])==null?void 0:h.title)??`#${S[69].name}`)+"")&&Vt(a,i),b[0]&2097152&&d!==(d=S[21].t("Collection")+"")&&Vt(g,d)},i:kt,o:kt,d(S){S&&m(t)}}}function co(s){let t,e,l,n,o,r=s[69].name+"",i,a,u,c=s[21].t("Document")+"",d;function g(b,h){return b[69].upload_status?mo:fo}let p=g(s),S=p(s);return{c(){t=E("div"),e=E("div"),S.c(),l=Q(),n=E("div"),o=E("div"),i=bt(r),a=Q(),u=E("div"),d=bt(c),this.h()},l(b){t=I(b,"DIV",{class:!0});var h=k(t);e=I(h,"DIV",{class:!0});var v=k(e);S.l(v),v.forEach(m),l=Y(h),n=I(h,"DIV",{class:!0});var w=k(n);o=I(w,"DIV",{class:!0});var C=k(o);i=wt(C,r),C.forEach(m),a=Y(w),u=I(w,"DIV",{class:!0});var V=k(u);d=wt(V,c),V.forEach(m),w.forEach(m),h.forEach(m),this.h()},h(){f(e,"class","p-2.5 bg-red-400 text-white rounded-lg"),f(o,"class","dark:text-gray-100 text-sm font-medium line-clamp-1"),f(u,"class","text-gray-500 text-sm"),f(n,"class","flex flex-col justify-center -space-y-0.5"),f(t,"class","h-16 w-[15rem] flex items-center space-x-3 px-2.5 dark:bg-gray-600 rounded-xl border border-gray-200 dark:border-none")},m(b,h){U(b,t,h),_(t,e),S.m(e,null),_(t,l),_(t,n),_(n,o),_(o,i),_(n,a),_(n,u),_(u,d)},p(b,h){p!==(p=g(b))&&(S.d(1),S=p(b),S&&(S.c(),S.m(e,null))),h[0]&8&&r!==(r=b[69].name+"")&&Vt(i,r),h[0]&2097152&&c!==(c=b[21].t("Document")+"")&&Vt(d,c)},i:kt,o:kt,d(b){b&&m(t),S.d()}}}function uo(s){let t,e,l,n,o,r=(s[0]?s[20].length===0:s[7].length!==s[20].length)&&Ql(s);return{c(){t=E("div"),e=E("img"),n=Q(),r&&r.c(),this.h()},l(i){t=I(i,"DIV",{class:!0});var a=k(t);e=I(a,"IMG",{src:!0,alt:!0,class:!0}),n=Y(a),r&&r.l(a),a.forEach(m),this.h()},h(){ve(e.src,l=s[69].url)||f(e,"src",l),f(e,"alt","input"),f(e,"class","h-16 w-16 rounded-xl object-cover"),f(t,"class","relative")},m(i,a){U(i,t,a),_(t,e),_(t,n),r&&r.m(t,null),o=!0},p(i,a){(!o||a[0]&8&&!ve(e.src,l=i[69].url))&&f(e,"src",l),(i[0]?i[20].length===0:i[7].length!==i[20].length)?r?(r.p(i,a),a[0]&1048705&&O(r,1)):(r=Ql(i),r.c(),O(r,1),r.m(t,null)):r&&(zt(),z(r,1,1,()=>{r=null}),Rt())},i(i){o||(O(r),o=!0)},o(i){z(r),o=!1},d(i){i&&m(t),r&&r.d()}}}function fo(s){let t,e,l,n,o,r;return{c(){t=_t("svg"),e=_t("style"),l=bt(`.spinner_qM83 {
																		animation: spinner_8HQG 1.05s infinite;
																	}
																	.spinner_oXPr {
																		animation-delay: 0.1s;
																	}
																	.spinner_ZTLf {
																		animation-delay: 0.2s;
																	}
																	@keyframes spinner_8HQG {
																		0%,
																		57.14% {
																			animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
																			transform: translate(0);
																		}
																		28.57% {
																			animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
																			transform: translateY(-6px);
																		}
																		100% {
																			transform: translate(0);
																		}
																	}
																`),n=_t("circle"),o=_t("circle"),r=_t("circle"),this.h()},l(i){t=vt(i,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=k(t);e=vt(a,"style",{});var u=k(e);l=wt(u,`.spinner_qM83 {
																		animation: spinner_8HQG 1.05s infinite;
																	}
																	.spinner_oXPr {
																		animation-delay: 0.1s;
																	}
																	.spinner_ZTLf {
																		animation-delay: 0.2s;
																	}
																	@keyframes spinner_8HQG {
																		0%,
																		57.14% {
																			animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
																			transform: translate(0);
																		}
																		28.57% {
																			animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
																			transform: translateY(-6px);
																		}
																		100% {
																			transform: translate(0);
																		}
																	}
																`),u.forEach(m),n=vt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(n).forEach(m),o=vt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(o).forEach(m),r=vt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(r).forEach(m),a.forEach(m),this.h()},h(){f(n,"class","spinner_qM83"),f(n,"cx","4"),f(n,"cy","12"),f(n,"r","2.5"),f(o,"class","spinner_qM83 spinner_oXPr"),f(o,"cx","12"),f(o,"cy","12"),f(o,"r","2.5"),f(r,"class","spinner_qM83 spinner_ZTLf"),f(r,"cx","20"),f(r,"cy","12"),f(r,"r","2.5"),f(t,"class","w-6 h-6 translate-y-[0.5px]"),f(t,"fill","currentColor"),f(t,"viewBox","0 0 24 24"),f(t,"xmlns","http://www.w3.org/2000/svg")},m(i,a){U(i,t,a),_(t,e),_(e,l),_(t,n),_(t,o),_(t,r)},d(i){i&&m(t)}}}function mo(s){let t,e,l;return{c(){t=_t("svg"),e=_t("path"),l=_t("path"),this.h()},l(n){t=vt(n,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var o=k(t);e=vt(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),k(e).forEach(m),l=vt(o,"path",{d:!0}),k(l).forEach(m),o.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z"),f(e,"clip-rule","evenodd"),f(l,"d","M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class","w-6 h-6")},m(n,o){U(n,t,o),_(t,e),_(t,l)},d(n){n&&m(t)}}}function Ql(s){let t,e;return t=new ge({props:{className:" absolute top-1 left-1",content:s[21].t("{{ models }}",{models:[...s[0]?[s[0]]:s[7]].filter(s[53]).join(", ")}),$$slots:{default:[ho]},$$scope:{ctx:s}}}),{c(){at(t.$$.fragment)},l(l){ct(t.$$.fragment,l)},m(l,n){ut(t,l,n),e=!0},p(l,n){const o={};n[0]&3145857&&(o.content=l[21].t("{{ models }}",{models:[...l[0]?[l[0]]:l[7]].filter(l[53]).join(", ")})),n[2]&1024&&(o.$$scope={dirty:n,ctx:l}),t.$set(o)},i(l){e||(O(t.$$.fragment,l),e=!0)},o(l){z(t.$$.fragment,l),e=!1},d(l){ft(t,l)}}}function ho(s){let t,e;return{c(){t=_t("svg"),e=_t("path"),this.h()},l(l){t=vt(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var n=k(t);e=vt(n,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),k(e).forEach(m),n.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"),f(e,"clip-rule","evenodd"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class","size-4 fill-yellow-300")},m(l,n){U(l,t,n),_(t,e)},p:kt,d(l){l&&m(t)}}}function Yl(s){let t,e,l,n,o,r,i='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',a,u,c,d;const g=[uo,co,ao],p=[];function S(h,v){return h[69].type==="image"?0:h[69].type==="doc"?1:h[69].type==="collection"?2:-1}~(e=S(s))&&(l=p[e]=g[e](s));function b(){return s[54](s[71])}return{c(){t=E("div"),l&&l.c(),n=Q(),o=E("div"),r=E("button"),r.innerHTML=i,a=Q(),this.h()},l(h){t=I(h,"DIV",{class:!0});var v=k(t);l&&l.l(v),n=Y(v),o=I(v,"DIV",{class:!0});var w=k(o);r=I(w,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),Zt(r)!=="svelte-6u4utr"&&(r.innerHTML=i),w.forEach(m),a=Y(v),v.forEach(m),this.h()},h(){f(r,"class","bg-gray-400 text-white border border-white rounded-full group-hover:visible invisible transition"),f(r,"type","button"),f(o,"class","absolute -top-1 -right-1"),f(t,"class","relative group")},m(h,v){U(h,t,v),~e&&p[e].m(t,null),_(t,n),_(t,o),_(o,r),_(t,a),u=!0,c||(d=et(r,"click",b),c=!0)},p(h,v){s=h;let w=e;e=S(s),e===w?~e&&p[e].p(s,v):(l&&(zt(),z(p[w],1,1,()=>{p[w]=null}),Rt()),~e?(l=p[e],l?l.p(s,v):(l=p[e]=g[e](s),l.c()),O(l,1),l.m(t,n)):l=null)},i(h){u||(O(l),u=!0)},o(h){z(l),u=!1},d(h){h&&m(t),~e&&p[e].d(),c=!1,d()}}}function go(s){let t,e='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-5"><path d="M8.75 3.75a.75.75 0 0 0-1.5 0v3.5h-3.5a.75.75 0 0 0 0 1.5h3.5v3.5a.75.75 0 0 0 1.5 0v-3.5h3.5a.75.75 0 0 0 0-1.5h-3.5v-3.5Z"></path></svg>';return{c(){t=E("button"),t.innerHTML=e,this.h()},l(l){t=I(l,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),Zt(t)!=="svelte-1948p7i"&&(t.innerHTML=e),this.h()},h(){f(t,"class","bg-gray-50 hover:bg-gray-100 text-gray-800 dark:bg-gray-850 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-2 outline-none focus:outline-none"),f(t,"type","button")},m(l,n){U(l,t,n)},p:kt,d(l){l&&m(t)}}}function Xl(s){let t,e;return t=new ge({props:{content:s[21].t("Record voice"),$$slots:{default:[po]},$$scope:{ctx:s}}}),{c(){at(t.$$.fragment)},l(l){ct(t.$$.fragment,l)},m(l,n){ut(t,l,n),e=!0},p(l,n){const o={};n[0]&2097152&&(o.content=l[21].t("Record voice")),n[0]&2099200|n[2]&1024&&(o.$$scope={dirty:n,ctx:l}),t.$set(o)},i(l){e||(O(t.$$.fragment,l),e=!0)},o(l){z(t.$$.fragment,l),e=!1},d(l){ft(t,l)}}}function po(s){let t,e='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 translate-y-[0.5px]"><path d="M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z"></path><path d="M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z"></path></svg>',l,n;return{c(){t=E("button"),t.innerHTML=e,this.h()},l(o){t=I(o,"BUTTON",{id:!0,class:!0,type:!0,"data-svelte-h":!0}),Zt(t)!=="svelte-47fjze"&&(t.innerHTML=e),this.h()},h(){f(t,"id","voice-input-button"),f(t,"class","text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-850 transition rounded-full p-1.5 mr-0.5 self-center"),f(t,"type","button")},m(o,r){U(o,t,r),l||(n=et(t,"click",s[65]),l=!0)},p:kt,d(o){o&&m(t),l=!1,n()}}}function _o(s){let t,e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 01-1.313-1.313V9.564z" clip-rule="evenodd"></path></svg>',n,o;return{c(){t=E("div"),e=E("button"),e.innerHTML=l,this.h()},l(r){t=I(r,"DIV",{class:!0});var i=k(t);e=I(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Zt(e)!=="svelte-5uu99u"&&(e.innerHTML=l),i.forEach(m),this.h()},h(){f(e,"class","bg-white hover:bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5"),f(t,"class","flex items-center mb-1.5")},m(r,i){U(r,t,i),_(t,e),n||(o=et(e,"click",s[67]),n=!0)},p:kt,i:kt,o:kt,d(r){r&&m(t),n=!1,o()}}}function vo(s){let t,e,l,n;const o=[wo,bo],r=[];function i(a,u){return a[1]===""?0:1}return t=i(s),e=r[t]=o[t](s),{c(){e.c(),l=Ht()},l(a){e.l(a),l=Ht()},m(a,u){r[t].m(a,u),U(a,l,u),n=!0},p(a,u){let c=t;t=i(a),t===c?r[t].p(a,u):(zt(),z(r[c],1,1,()=>{r[c]=null}),Rt(),e=r[t],e?e.p(a,u):(e=r[t]=o[t](a),e.c()),O(e,1),e.m(l.parentNode,l))},i(a){n||(O(e),n=!0)},o(a){z(e),n=!1},d(a){a&&m(l),r[t].d(a)}}}function bo(s){let t,e,l;return e=new ge({props:{content:s[21].t("Send message"),$$slots:{default:[ko]},$$scope:{ctx:s}}}),{c(){t=E("div"),at(e.$$.fragment),this.h()},l(n){t=I(n,"DIV",{class:!0});var o=k(t);ct(e.$$.fragment,o),o.forEach(m),this.h()},h(){f(t,"class","flex items-center mb-1")},m(n,o){U(n,t,o),ut(e,t,null),l=!0},p(n,o){const r={};o[0]&2097152&&(r.content=n[21].t("Send message")),o[0]&2|o[2]&1024&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){l||(O(e.$$.fragment,n),l=!0)},o(n){z(e.$$.fragment,n),l=!1},d(n){n&&m(t),ft(e)}}}function wo(s){let t,e,l;return e=new ge({props:{content:s[21].t("Call"),$$slots:{default:[yo]},$$scope:{ctx:s}}}),{c(){t=E("div"),at(e.$$.fragment),this.h()},l(n){t=I(n,"DIV",{class:!0});var o=k(t);ct(e.$$.fragment,o),o.forEach(m),this.h()},h(){f(t,"class","flex items-center mb-1")},m(n,o){U(n,t,o),ut(e,t,null),l=!0},p(n,o){const r={};o[0]&2097152&&(r.content=n[21].t("Call")),o[0]&35651712|o[2]&1024&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){l||(O(e.$$.fragment,n),l=!0)},o(n){z(e.$$.fragment,n),l=!1},d(n){n&&m(t),ft(e)}}}function ko(s){let t,e,l,n,o;return{c(){t=E("button"),e=_t("svg"),l=_t("path"),this.h()},l(r){t=I(r,"BUTTON",{id:!0,class:!0,type:!0});var i=k(t);e=vt(i,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var a=k(e);l=vt(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),k(l).forEach(m),a.forEach(m),i.forEach(m),this.h()},h(){f(l,"fill-rule","evenodd"),f(l,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),f(l,"clip-rule","evenodd"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"viewBox","0 0 16 16"),f(e,"fill","currentColor"),f(e,"class","size-6"),f(t,"id","send-message-button"),f(t,"class",n=(s[1]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center"),f(t,"type","submit"),t.disabled=o=s[1]===""},m(r,i){U(r,t,i),_(t,e),_(e,l)},p(r,i){i[0]&2&&n!==(n=(r[1]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center")&&f(t,"class",n),i[0]&2&&o!==(o=r[1]==="")&&(t.disabled=o)},d(r){r&&m(t)}}}function yo(s){let t,e,l,n,o;return e=new Kr({props:{className:"size-6"}}),{c(){t=E("button"),at(e.$$.fragment),this.h()},l(r){t=I(r,"BUTTON",{class:!0,type:!0});var i=k(t);ct(e.$$.fragment,i),i.forEach(m),this.h()},h(){f(t,"class","text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-850 transition rounded-full p-2 self-center"),f(t,"type","button")},m(r,i){U(r,t,i),ut(e,t,null),l=!0,n||(o=et(t,"click",s[66]),n=!0)},p:kt,i(r){l||(O(e.$$.fragment,r),l=!0)},o(r){z(e.$$.fragment,r),l=!1},d(r){r&&m(t),ft(e),n=!1,o()}}}function Eo(s){let t,e,l,n,o,r,i,a,u,c,d,g,p,S,b,h,v,w,C,V,B,D,P,L,A,R,H,F=s[21].t("LLMs can make mistakes. Verify important information.")+"",j,M,q,ot,Z=s[17]&&Zl(s),J=s[2]===!1&&s[8].length>0&&xl(s);const X=[ro,so],lt=[];function At(x,dt){return dt[0]&2&&(a=null),dt[0]&2&&(u=null),a==null&&(a=x[1].charAt(0)==="/"),a?0:(u==null&&(u=x[1].charAt(0)==="#"),u?1:-1)}~(c=At(s,[-1,-1,-1]))&&(d=lt[c]=X[c](s));function Pt(x){s[41](x)}function Xt(x){s[42](x)}function Wt(x){s[43](x)}let W={messages:s[8]};s[1]!==void 0&&(W.prompt=s[1]),s[18]!==void 0&&(W.user=s[18]),s[19]!==void 0&&(W.chatInputPlaceholder=s[19]),p=new Nr({props:W}),s[40](p),Et.push(()=>Ut(p,"prompt",Pt)),Et.push(()=>Ut(p,"user",Xt)),Et.push(()=>Ut(p,"chatInputPlaceholder",Wt)),p.$on("select",s[44]);let T=s[0]!==void 0&&Gl(s);const K=[io,oo],st=[];function mt(x,dt){return x[11]?0:1}return L=mt(s),A=st[L]=K[L](s),{c(){Z&&Z.c(),t=Q(),e=E("div"),l=E("div"),n=E("div"),o=E("div"),J&&J.c(),r=Q(),i=E("div"),d&&d.c(),g=Q(),at(p.$$.fragment),v=Q(),T&&T.c(),w=Q(),C=E("div"),V=E("div"),B=E("div"),D=E("input"),P=Q(),A.c(),R=Q(),H=E("div"),j=bt(F),this.h()},l(x){Z&&Z.l(x),t=Y(x),e=I(x,"DIV",{class:!0});var dt=k(e);l=I(dt,"DIV",{class:!0});var Yt=k(l);n=I(Yt,"DIV",{class:!0});var Nt=k(n);o=I(Nt,"DIV",{class:!0});var xt=k(o);J&&J.l(xt),xt.forEach(m),r=Y(Nt),i=I(Nt,"DIV",{class:!0});var qt=k(i);d&&d.l(qt),g=Y(qt),ct(p.$$.fragment,qt),v=Y(qt),T&&T.l(qt),qt.forEach(m),Nt.forEach(m),Yt.forEach(m),w=Y(dt),C=I(dt,"DIV",{class:!0});var Kt=k(C);V=I(Kt,"DIV",{class:!0});var ee=k(V);B=I(ee,"DIV",{class:!0});var te=k(B);D=I(te,"INPUT",{type:!0}),P=Y(te),A.l(te),R=Y(te),H=I(te,"DIV",{class:!0});var he=k(H);j=wt(he,F),he.forEach(m),te.forEach(m),ee.forEach(m),Kt.forEach(m),dt.forEach(m),this.h()},h(){f(o,"class","relative"),f(i,"class","w-full relative"),f(n,"class","flex flex-col max-w-6xl px-2.5 md:px-6 w-full"),f(l,"class","-mb-0.5 mx-auto inset-x-0 bg-transparent flex justify-center"),f(D,"type","file"),D.hidden=!0,D.multiple=!0,f(H,"class","mt-1.5 text-xs text-gray-500 text-center line-clamp-1"),f(B,"class","pb-2"),f(V,"class","max-w-6xl px-2.5 md:px-6 mx-auto inset-x-0"),f(C,"class","bg-white dark:bg-gray-900"),f(e,"class","w-full")},m(x,dt){Z&&Z.m(x,dt),U(x,t,dt),U(x,e,dt),_(e,l),_(l,n),_(n,o),J&&J.m(o,null),_(n,r),_(n,i),~c&&lt[c].m(i,null),_(i,g),ut(p,i,null),_(i,v),T&&T.m(i,null),_(e,w),_(e,C),_(C,V),_(V,B),_(B,D),s[47](D),_(B,P),st[L].m(B,null),_(B,R),_(B,H),_(H,j),M=!0,q||(ot=[et(D,"change",s[48]),et(D,"change",s[49])],q=!0)},p(x,dt){x[17]?Z?(Z.p(x,dt),dt[0]&131072&&O(Z,1)):(Z=Zl(x),Z.c(),O(Z,1),Z.m(t.parentNode,t)):Z&&(zt(),z(Z,1,1,()=>{Z=null}),Rt()),x[2]===!1&&x[8].length>0?J?J.p(x,dt):(J=xl(x),J.c(),J.m(o,null)):J&&(J.d(1),J=null);let Yt=c;c=At(x,dt),c===Yt?~c&&lt[c].p(x,dt):(d&&(zt(),z(lt[Yt],1,1,()=>{lt[Yt]=null}),Rt()),~c?(d=lt[c],d?d.p(x,dt):(d=lt[c]=X[c](x),d.c()),O(d,1),d.m(i,g)):d=null);const Nt={};dt[0]&256&&(Nt.messages=x[8]),!S&&dt[0]&2&&(S=!0,Nt.prompt=x[1],Ot(()=>S=!1)),!b&&dt[0]&262144&&(b=!0,Nt.user=x[18],Ot(()=>b=!1)),!h&&dt[0]&524288&&(h=!0,Nt.chatInputPlaceholder=x[19],Ot(()=>h=!1)),p.$set(Nt),x[0]!==void 0?T?(T.p(x,dt),dt[0]&1&&O(T,1)):(T=Gl(x),T.c(),O(T,1),T.m(i,null)):T&&(zt(),z(T,1,1,()=>{T=null}),Rt());let xt=L;L=mt(x),L===xt?st[L].p(x,dt):(zt(),z(st[xt],1,1,()=>{st[xt]=null}),Rt(),A=st[L],A?A.p(x,dt):(A=st[L]=K[L](x),A.c()),O(A,1),A.m(B,R)),(!M||dt[0]&2097152)&&F!==(F=x[21].t("LLMs can make mistakes. Verify important information.")+"")&&Vt(j,F)},i(x){M||(O(Z),O(d),O(p.$$.fragment,x),O(T),O(A),M=!0)},o(x){z(Z),z(d),z(p.$$.fragment,x),z(T),z(A),M=!1},d(x){x&&(m(t),m(e)),Z&&Z.d(x),J&&J.d(),~c&&lt[c].d(),s[40](null),ft(p),T&&T.d(),s[47](null),st[L].d(),q=!1,de(ot)}}}function Io(s,t,e){let l,n,o,r,i,a;it(s,Ae,y=>e(10,n=y)),it(s,Ne,y=>e(22,o=y)),it(s,fe,y=>e(23,r=y)),it(s,mn,y=>e(24,i=y)),it(s,Me,y=>e(25,a=y));const u=ue("i18n");it(s,u,y=>e(21,l=y));let{submitPrompt:c}=t,{stopResponse:d}=t,{autoScroll:g=!0}=t,{atSelectedModel:p}=t,{selectedModels:S}=t,b=!1,h,v,w,C,V,B,D=!1,P=null,L="",{files:A=[]}=t,{webSearchEnabled:R=!1}=t,{prompt:H=""}=t,{messages:F=[]}=t,j=[];const M=()=>{const y=document.getElementById("messages-container");y.scrollTop=y.scrollHeight},q=async y=>{console.log(y);const nt={type:"doc",name:y.name,collection_name:"",upload_status:!1,error:""};try{if(e(3,A=[...A,nt]),["audio/mpeg","audio/wav"].includes(y.type)){const rt=await transcribeAudio(localStorage.token,y).catch(yt=>(pt.error(yt),null));if(rt){console.log(rt);const yt=new Blob([rt.text],{type:"text/plain"});y=Xe(yt,`${y.name}.txt`)}}const ht=await Fn(localStorage.token,"",y);ht&&(nt.upload_status=!0,nt.collection_name=ht.collection_name,e(3,A))}catch(ht){e(3,A=A.filter(rt=>rt.name!==y.name)),pt.error(ht)}},ot=async y=>{console.log(y);const nt={type:"doc",name:y,collection_name:"",upload_status:!1,url:y,error:""};try{e(3,A=[...A,nt]);const ht=await qn(localStorage.token,"",y);ht&&(nt.upload_status=!0,nt.collection_name=ht.collection_name,e(3,A))}catch(ht){e(3,A=A.filter(rt=>rt.name!==y)),pt.error(ht)}},Z=async y=>{console.log(y);const nt={type:"doc",name:y,collection_name:"",upload_status:!1,url:y,error:""};try{e(3,A=[...A,nt]);const ht=await Wn(localStorage.token,y);ht&&(nt.upload_status=!0,nt.collection_name=ht.collection_name,e(3,A))}catch(ht){e(3,A=A.filter(rt=>rt.name!==y)),pt.error(ht)}};Ye(()=>{window.setTimeout(()=>h==null?void 0:h.focus(),0);const y=document.querySelector("body"),nt=Ft=>{Ft.key==="Escape"&&(console.log("Escape"),e(17,D=!1))},ht=Ft=>{Ft.preventDefault(),e(17,D=!0)},rt=()=>{e(17,D=!1)},yt=async Ft=>{var le,se;if(Ft.preventDefault(),console.log(Ft),(le=Ft.dataTransfer)!=null&&le.files){const gt=Array.from((se=Ft.dataTransfer)==null?void 0:se.files);gt&&gt.length>0?gt.forEach(Mt=>{if(console.log(Mt,Mt.name.split(".").at(-1)),["image/gif","image/webp","image/jpeg","image/png"].includes(Mt.type)){if(j.length===0){pt.error(l.t("Selected model(s) do not support image inputs"));return}let Ct=new FileReader;Ct.onload=jt=>{e(3,A=[...A,{type:"image",url:`${jt.target.result}`}])},Ct.readAsDataURL(Mt)}else rl.includes(Mt.type)||ol.includes(Mt.name.split(".").at(-1))||pt.error(l.t("Unknown File Type '{{file_type}}', but accepting and treating as plain text",{file_type:Mt.type})),q(Mt)}):pt.error(l.t("File not found."))}e(17,D=!1)};return window.addEventListener("keydown",nt),y==null||y.addEventListener("dragover",ht),y==null||y.addEventListener("drop",yt),y==null||y.addEventListener("dragleave",rt),()=>{window.removeEventListener("keydown",nt),y==null||y.removeEventListener("dragover",ht),y==null||y.removeEventListener("drop",yt),y==null||y.removeEventListener("dragleave",rt)}});const J=()=>{e(2,g=!0),M()};function X(y){Et[y?"unshift":"push"](()=>{w=y,e(13,w)})}function lt(y){H=y,e(1,H)}function At(y){A=y,e(3,A)}function Pt(y){Et[y?"unshift":"push"](()=>{C=y,e(14,C)})}function Xt(y){H=y,e(1,H)}const Wt=y=>{console.log(y),Z(y.detail)},W=y=>{console.log(y),ot(y.detail)},T=y=>{var nt;console.log(y),e(3,A=[...A,{type:((nt=y==null?void 0:y.detail)==null?void 0:nt.type)??"doc",...y.detail,upload_status:!0}])};function K(y){Et[y?"unshift":"push"](()=>{V=y,e(15,V)})}function st(y){H=y,e(1,H)}function mt(y){P=y,e(18,P)}function x(y){L=y,e(19,L)}const dt=y=>{e(0,p=y.detail),h==null||h.focus()},Yt=y=>y.id===p.id,Nt=()=>{e(0,p=void 0)};function xt(y){Et[y?"unshift":"push"](()=>{v=y,e(12,v)})}function qt(){B=this.files,e(16,B)}const Kt=async()=>{B&&B.length>0?Array.from(B).forEach(nt=>{if(["image/gif","image/webp","image/jpeg","image/png"].includes(nt.type)){if(j.length===0){pt.error(l.t("Selected model(s) do not support image inputs")),e(16,B=null),e(12,v.value="",v);return}let ht=new FileReader;ht.onload=rt=>{e(3,A=[...A,{type:"image",url:`${rt.target.result}`}]),e(16,B=null),e(12,v.value="",v)},ht.readAsDataURL(nt)}else rl.includes(nt.type)||ol.includes(nt.name.split(".").at(-1))?(q(nt),e(12,v.value="",v)):(pt.error(l.t("Unknown File Type '{{file_type}}', but accepting and treating as plain text",{file_type:nt.type})),q(nt),e(12,v.value="",v))}):pt.error(l.t("File not found."))};function ee(y){b=y,e(11,b)}const te=async()=>{var y;e(11,b=!1),await Bt(),(y=document.getElementById("chat-textarea"))==null||y.focus()},he=async y=>{var ht;const nt=y.detail;e(1,H=`${H}${nt} `),e(11,b=!1),await Bt(),(ht=document.getElementById("chat-textarea"))==null||ht.focus(),((r==null?void 0:r.speechAutoSend)??!1)&&c(H,P)},Ue=y=>!j.includes(y),Pe=y=>{A.splice(y,1),e(3,A)},ze=()=>{v.click()},Re=async()=>{await Bt(),h==null||h.focus()};function je(y){R=y,e(4,R)}function Fe(y){Et[y?"unshift":"push"](()=>{h=y,e(9,h),e(1,H)})}function qe(){H=this.value,e(1,H)}const We=y=>{(!i||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0))&&(y.key==="Enter"&&!y.shiftKey&&y.preventDefault(),H!==""&&y.key==="Enter"&&!y.shiftKey&&c(H,P))},Ze=async y=>{var ht;const nt=y.ctrlKey||y.metaKey;if(H===""&&nt&&y.key.toLowerCase()==="r"){y.preventDefault(),console.log("regenerate");const rt=[...document.getElementsByClassName("regenerate-response-button")].at(-1);rt==null||rt.click()}if(H===""&&y.key=="ArrowUp"){y.preventDefault();const rt=[...document.getElementsByClassName("user-message")].at(-1),yt=[...document.getElementsByClassName("edit-user-message-button")].at(-1);console.log(rt),rt.scrollIntoView({block:"center"}),yt==null||yt.click()}if(["/","#","@"].includes(H.charAt(0))&&y.key==="ArrowUp"&&(y.preventDefault(),(w||C||V).selectUp(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),["/","#","@"].includes(H.charAt(0))&&y.key==="ArrowDown"&&(y.preventDefault(),(w||C||V).selectDown(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),["/","#","@"].includes(H.charAt(0))&&y.key==="Enter"){y.preventDefault();const rt=[...document.getElementsByClassName("selected-command-option-button")].at(-1);y.shiftKey?e(1,H=`${H}
`):rt?rt==null||rt.click():(ht=document.getElementById("send-message-button"))==null||ht.click()}if(["/","#","@"].includes(H.charAt(0))&&y.key==="Tab"){y.preventDefault();const rt=[...document.getElementsByClassName("selected-command-option-button")].at(-1);rt==null||rt.click()}else if(y.key==="Tab"){const rt=pn(H);if(rt.length>0){const yt=rt.at(0),Ft=H;e(1,H=H.substring(0,(yt==null?void 0:yt.endIndex)+1)),await Bt(),y.target.scrollTop=y.target.scrollHeight,e(1,H=Ft),await Bt(),y.preventDefault(),y.target.setSelectionRange(yt==null?void 0:yt.startIndex,yt.endIndex+1)}y.target.style.height="",y.target.style.height=Math.min(y.target.scrollHeight,200)+"px"}y.key==="Escape"&&(console.log("Escape"),e(0,p=void 0))},N=y=>{y.target.style.height="",y.target.style.height=Math.min(y.target.scrollHeight,200)+"px",e(18,P=null)},tt=y=>{y.target.style.height="",y.target.style.height=Math.min(y.target.scrollHeight,200)+"px"},It=y=>{const nt=y.clipboardData||window.clipboardData;if(nt&&nt.items){for(const ht of nt.items)if(ht.type.indexOf("image")!==-1){const rt=ht.getAsFile(),yt=new FileReader;yt.onload=function(Ft){e(3,A=[...A,{type:"image",url:`${Ft.target.result}`}])},yt.readAsDataURL(rt)}}},$=async()=>{try{await navigator.mediaDevices.getUserMedia({audio:!0}).catch(function(nt){return pt.error(l.t("Permission denied when accessing microphone: {{error}}",{error:nt})),null})&&e(11,b=!0)}catch{pt.error(l.t("Permission denied when accessing microphone"))}},Lt=async()=>{if(S.length>1){pt.error(l.t("Select only one model to call"));return}if(a.audio.stt.engine==="web"){pt.error(l.t("Call feature is not supported when using Web STT engine"));return}try{await navigator.mediaDevices.getUserMedia({audio:!0,video:!0}),Be.set(!0)}catch{pt.error(l.t("Permission denied when accessing media devices"))}},G=()=>{d()},St=()=>{c(H,P)};return s.$$set=y=>{"submitPrompt"in y&&e(5,c=y.submitPrompt),"stopResponse"in y&&e(6,d=y.stopResponse),"autoScroll"in y&&e(2,g=y.autoScroll),"atSelectedModel"in y&&e(0,p=y.atSelectedModel),"selectedModels"in y&&e(7,S=y.selectedModels),"files"in y&&e(3,A=y.files),"webSearchEnabled"in y&&e(4,R=y.webSearchEnabled),"prompt"in y&&e(1,H=y.prompt),"messages"in y&&e(8,F=y.messages)},s.$$.update=()=>{s.$$.dirty[0]&1153&&e(20,j=[...p?[p]:S].filter(y=>{var nt,ht,rt,yt;return((yt=(rt=(ht=(nt=n.find(Ft=>Ft.id===y))==null?void 0:nt.info)==null?void 0:ht.meta)==null?void 0:rt.capabilities)==null?void 0:yt.vision)??!0})),s.$$.dirty[0]&514&&H&&h&&(e(9,h.style.height="",h),e(9,h.style.height=Math.min(h.scrollHeight,200)+"px",h))},[p,H,g,A,R,c,d,S,F,h,n,b,v,w,C,V,B,D,P,L,j,l,o,r,i,a,u,M,q,ot,Z,J,X,lt,At,Pt,Xt,Wt,W,T,K,st,mt,x,dt,Yt,Nt,xt,qt,Kt,ee,te,he,Ue,Pe,ze,Re,je,Fe,qe,We,Ze,N,tt,It,$,Lt,G,St]}class So extends Jt{constructor(t){super(),Qt(this,t,Io,Eo,Gt,{submitPrompt:5,stopResponse:6,autoScroll:2,atSelectedModel:0,selectedModels:7,files:3,webSearchEnabled:4,prompt:1,messages:8},null,[-1,-1,-1])}}function Kl(s,t,e){const l=s.slice();return l[12]=t[e],l[13]=t,l[14]=e,l}function Do(s){let t,e,l;return e=new ge({props:{content:s[4].t("Remove Model"),$$slots:{default:[Co]},$$scope:{ctx:s}}}),{c(){t=E("div"),at(e.$$.fragment),this.h()},l(n){t=I(n,"DIV",{class:!0});var o=k(t);ct(e.$$.fragment,o),o.forEach(m),this.h()},h(){f(t,"class","self-center disabled:text-gray-600 disabled:hover:text-gray-600 mr-2")},m(n,o){U(n,t,o),ut(e,t,null),l=!0},p(n,o){const r={};o&16&&(r.content=n[4].t("Remove Model")),o&32771&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){l||(O(e.$$.fragment,n),l=!0)},o(n){z(e.$$.fragment,n),l=!1},d(n){n&&m(t),ft(e)}}}function Mo(s){let t,e,l;return e=new ge({props:{content:s[4].t("Add Model"),$$slots:{default:[To]},$$scope:{ctx:s}}}),{c(){t=E("div"),at(e.$$.fragment),this.h()},l(n){t=I(n,"DIV",{class:!0});var o=k(t);ct(e.$$.fragment,o),o.forEach(m),this.h()},h(){f(t,"class","self-center mr-2 disabled:text-gray-600 disabled:hover:text-gray-600")},m(n,o){U(n,t,o),ut(e,t,null),l=!0},p(n,o){const r={};o&16&&(r.content=n[4].t("Add Model")),o&32771&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){l||(O(e.$$.fragment,n),l=!0)},o(n){z(e.$$.fragment,n),l=!1},d(n){n&&m(t),ft(e)}}}function Co(s){let t,e,l,n,o;function r(){return s[10](s[14])}return{c(){t=E("button"),e=_t("svg"),l=_t("path"),this.h()},l(i){t=I(i,"BUTTON",{});var a=k(t);e=vt(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=k(e);l=vt(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),u.forEach(m),a.forEach(m),this.h()},h(){f(l,"stroke-linecap","round"),f(l,"stroke-linejoin","round"),f(l,"d","M19.5 12h-15"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","2"),f(e,"stroke","currentColor"),f(e,"class","size-3.5"),t.disabled=s[1]},m(i,a){U(i,t,a),_(t,e),_(e,l),n||(o=et(t,"click",r),n=!0)},p(i,a){s=i,a&2&&(t.disabled=s[1])},d(i){i&&m(t),n=!1,o()}}}function To(s){let t,e,l,n,o;return{c(){t=E("button"),e=_t("svg"),l=_t("path"),this.h()},l(r){t=I(r,"BUTTON",{class:!0});var i=k(t);e=vt(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var a=k(e);l=vt(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),a.forEach(m),i.forEach(m),this.h()},h(){f(l,"stroke-linecap","round"),f(l,"stroke-linejoin","round"),f(l,"d","M12 6v12m6-6H6"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","2"),f(e,"stroke","currentColor"),f(e,"class","size-3.5"),f(t,"class",""),t.disabled=s[1]},m(r,i){U(r,t,i),_(t,e),_(e,l),n||(o=et(t,"click",s[9]),n=!0)},p(r,i){i&2&&(t.disabled=r[1])},d(r){r&&m(t),n=!1,o()}}}function $l(s){let t,e,l,n,o,r,i,a,u,c;function d(h){s[8](h,s[12],s[13],s[14])}let g={placeholder:s[4].t("Select a model"),items:s[3].map(en)};s[12]!==void 0&&(g.value=s[12]),n=new as({props:g}),Et.push(()=>Ut(n,"value",d));const p=[Mo,Do],S=[];function b(h,v){return h[14]===0?0:1}return i=b(s),a=S[i]=p[i](s),{c(){t=E("div"),e=E("div"),l=E("div"),at(n.$$.fragment),r=Q(),a.c(),u=Q(),this.h()},l(h){t=I(h,"DIV",{class:!0});var v=k(t);e=I(v,"DIV",{class:!0});var w=k(e);l=I(w,"DIV",{class:!0});var C=k(l);ct(n.$$.fragment,C),C.forEach(m),w.forEach(m),r=Y(v),a.l(v),u=Y(v),v.forEach(m),this.h()},h(){f(l,"class","mr-1 max-w-full"),f(e,"class","overflow-hidden w-full"),f(t,"class","flex w-full max-w-fit")},m(h,v){U(h,t,v),_(t,e),_(e,l),ut(n,l,null),_(t,r),S[i].m(t,null),_(t,u),c=!0},p(h,v){s=h;const w={};v&16&&(w.placeholder=s[4].t("Select a model")),v&8&&(w.items=s[3].map(en)),!o&&v&1&&(o=!0,w.value=s[12],Ot(()=>o=!1)),n.$set(w),a.p(s,v)},i(h){c||(O(n.$$.fragment,h),O(a),c=!0)},o(h){z(n.$$.fragment,h),z(a),c=!1},d(h){h&&m(t),ft(n),S[i].d()}}}function tn(s){let t,e,l=s[4].t("Set as default")+"",n,o,r;return{c(){t=E("div"),e=E("button"),n=bt(l),this.h()},l(i){t=I(i,"DIV",{class:!0});var a=k(t);e=I(a,"BUTTON",{});var u=k(e);n=wt(u,l),u.forEach(m),a.forEach(m),this.h()},h(){f(t,"class","text-left mt-0.5 ml-1 text-[0.7rem] text-gray-500")},m(i,a){U(i,t,a),_(t,e),_(e,n),o||(r=et(e,"click",s[7]),o=!0)},p(i,a){a&16&&l!==(l=i[4].t("Set as default")+"")&&Vt(n,l)},d(i){i&&m(t),o=!1,r()}}}function Vo(s){let t,e,l,n,o=$t(s[0]),r=[];for(let u=0;u<o.length;u+=1)r[u]=$l(Kl(s,o,u));const i=u=>z(r[u],1,1,()=>{r[u]=null});let a=s[2]&&!s[5]&&tn(s);return{c(){t=E("div");for(let u=0;u<r.length;u+=1)r[u].c();e=Q(),a&&a.c(),l=Ht(),this.h()},l(u){t=I(u,"DIV",{class:!0});var c=k(t);for(let d=0;d<r.length;d+=1)r[d].l(c);c.forEach(m),e=Y(u),a&&a.l(u),l=Ht(),this.h()},h(){f(t,"class","flex flex-col w-full items-center md:items-start")},m(u,c){U(u,t,c);for(let d=0;d<r.length;d+=1)r[d]&&r[d].m(t,null);U(u,e,c),a&&a.m(u,c),U(u,l,c),n=!0},p(u,[c]){if(c&27){o=$t(u[0]);let d;for(d=0;d<o.length;d+=1){const g=Kl(u,o,d);r[d]?(r[d].p(g,c),O(r[d],1)):(r[d]=$l(g),r[d].c(),O(r[d],1),r[d].m(t,null))}for(zt(),d=o.length;d<r.length;d+=1)i(d);Rt()}u[2]&&!u[5]?a?a.p(u,c):(a=tn(u),a.c(),a.m(l.parentNode,l)):a&&(a.d(1),a=null)},i(u){if(!n){for(let c=0;c<o.length;c+=1)O(r[c]);n=!0}},o(u){r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)z(r[c]);n=!1},d(u){u&&(m(t),m(e),m(l)),pe(r,u),a&&a.d(u)}}}const en=s=>({value:s.id,label:s.name,model:s});function Bo(s,t,e){let l,n,o,r;it(s,Ae,b=>e(3,l=b)),it(s,fe,b=>e(11,o=b)),it(s,mn,b=>e(5,r=b));const i=ue("i18n");it(s,i,b=>e(4,n=b));let{selectedModels:a=[""]}=t,{disabled:u=!1}=t,{showSetDefault:c=!0}=t;const d=async()=>{if(a.filter(h=>h==="").length){pt.error(n.t("Choose a model before saving..."));return}fe.set({...o,models:a}),await Un(localStorage.token,{ui:o}),pt.success(n.t("Default model updated"))};function g(b,h,v,w){v[w]=b,e(0,a),e(3,l)}const p=()=>{e(0,a=[...a,""])},S=b=>{a.splice(b,1),e(0,a),e(3,l)};return s.$$set=b=>{"selectedModels"in b&&e(0,a=b.selectedModels),"disabled"in b&&e(1,u=b.disabled),"showSetDefault"in b&&e(2,c=b.showSetDefault)},s.$$.update=()=>{s.$$.dirty&9&&a.length>0&&l.length>0&&e(0,a=a.map(b=>l.map(h=>h.id).includes(b)?b:""))},[a,u,c,l,n,r,i,d,g,p,S]}class No extends Jt{constructor(t){super(),Qt(this,t,Bo,Vo,Gt,{selectedModels:0,disabled:1,showSetDefault:2})}}function Lo(s){let t;const e=s[10].default,l=oe(e,s,s[16],null);return{c(){l&&l.c()},l(n){l&&l.l(n)},m(n,o){l&&l.m(n,o),t=!0},p(n,o){l&&l.p&&(!t||o&65536)&&ie(l,e,n,n[16],t?ce(e,n[16],o,null):ae(n[16]),null)},i(n){t||(O(l,n),t=!0)},o(n){z(l,n),t=!1},d(n){l&&l.d(n)}}}function Ho(s){let t,e,l,n,o=s[3].t("Share")+"",r;return{c(){t=_t("svg"),e=_t("path"),l=Q(),n=E("div"),r=bt(o),this.h()},l(i){t=vt(i,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var a=k(t);e=vt(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),k(e).forEach(m),a.forEach(m),l=Y(i),n=I(i,"DIV",{class:!0});var u=k(n);r=wt(u,o),u.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M15.75 4.5a3 3 0 1 1 .825 2.066l-8.421 4.679a3.002 3.002 0 0 1 0 1.51l8.421 4.679a3 3 0 1 1-.729 1.31l-8.421-4.678a3 3 0 1 1 0-4.132l8.421-4.679a3 3 0 0 1-.096-.755Z"),f(e,"clip-rule","evenodd"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class","size-4"),f(n,"class","flex items-center")},m(i,a){U(i,t,a),_(t,e),U(i,l,a),U(i,n,a),_(n,r)},p(i,a){a&8&&o!==(o=i[3].t("Share")+"")&&Vt(r,o)},d(i){i&&(m(t),m(l),m(n))}}}function Ao(s){let t,e,l,n,o=s[3].t("Download")+"",r;return{c(){t=_t("svg"),e=_t("path"),l=Q(),n=E("div"),r=bt(o),this.h()},l(i){t=vt(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var a=k(t);e=vt(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(e).forEach(m),a.forEach(m),l=Y(i),n=I(i,"DIV",{class:!0});var u=k(n);r=wt(u,o),u.forEach(m),this.h()},h(){f(e,"stroke-linecap","round"),f(e,"stroke-linejoin","round"),f(e,"d","M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"fill","none"),f(t,"viewBox","0 0 24 24"),f(t,"stroke-width","1.5"),f(t,"stroke","currentColor"),f(t,"class","size-4"),f(n,"class","flex items-center")},m(i,a){U(i,t,a),_(t,e),U(i,l,a),U(i,n,a),_(n,r)},p(i,a){a&8&&o!==(o=i[3].t("Download")+"")&&Vt(r,o)},d(i){i&&(m(t),m(l),m(n))}}}function Oo(s){let t,e=s[3].t("Export chat (.json)")+"",l;return{c(){t=E("div"),l=bt(e),this.h()},l(n){t=I(n,"DIV",{class:!0});var o=k(t);l=wt(o,e),o.forEach(m),this.h()},h(){f(t,"class","flex items-center line-clamp-1")},m(n,o){U(n,t,o),_(t,l)},p(n,o){o&8&&e!==(e=n[3].t("Export chat (.json)")+"")&&Vt(l,e)},d(n){n&&m(t)}}}function Uo(s){let t,e=s[3].t("Plain text (.txt)")+"",l;return{c(){t=E("div"),l=bt(e),this.h()},l(n){t=I(n,"DIV",{class:!0});var o=k(t);l=wt(o,e),o.forEach(m),this.h()},h(){f(t,"class","flex items-center line-clamp-1")},m(n,o){U(n,t,o),_(t,l)},p(n,o){o&8&&e!==(e=n[3].t("Plain text (.txt)")+"")&&Vt(l,e)},d(n){n&&m(t)}}}function Po(s){let t,e=s[3].t("PDF document (.pdf)")+"",l;return{c(){t=E("div"),l=bt(e),this.h()},l(n){t=I(n,"DIV",{class:!0});var o=k(t);l=wt(o,e),o.forEach(m),this.h()},h(){f(t,"class","flex items-center line-clamp-1")},m(n,o){U(n,t,o),_(t,l)},p(n,o){o&8&&e!==(e=n[3].t("PDF document (.pdf)")+"")&&Vt(l,e)},d(n){n&&m(t)}}}function zo(s){let t,e,l,n,o,r;return t=new we({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Oo]},$$scope:{ctx:s}}}),t.$on("click",s[12]),l=new we({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Uo]},$$scope:{ctx:s}}}),l.$on("click",s[13]),o=new we({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Po]},$$scope:{ctx:s}}}),o.$on("click",s[14]),{c(){at(t.$$.fragment),e=Q(),at(l.$$.fragment),n=Q(),at(o.$$.fragment)},l(i){ct(t.$$.fragment,i),e=Y(i),ct(l.$$.fragment,i),n=Y(i),ct(o.$$.fragment,i)},m(i,a){ut(t,i,a),U(i,e,a),ut(l,i,a),U(i,n,a),ut(o,i,a),r=!0},p(i,a){const u={};a&65544&&(u.$$scope={dirty:a,ctx:i}),t.$set(u);const c={};a&65544&&(c.$$scope={dirty:a,ctx:i}),l.$set(c);const d={};a&65544&&(d.$$scope={dirty:a,ctx:i}),o.$set(d)},i(i){r||(O(t.$$.fragment,i),O(l.$$.fragment,i),O(o.$$.fragment,i),r=!0)},o(i){z(t.$$.fragment,i),z(l.$$.fragment,i),z(o.$$.fragment,i),r=!1},d(i){i&&(m(e),m(n)),ft(t,i),ft(l,i),ft(o,i)}}}function Ro(s){let t,e,l,n;return t=new Us({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Ao]},$$scope:{ctx:s}}}),l=new Vs({props:{class:"w-full rounded-lg px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",transition:Oe,sideOffset:8,$$slots:{default:[zo]},$$scope:{ctx:s}}}),{c(){at(t.$$.fragment),e=Q(),at(l.$$.fragment)},l(o){ct(t.$$.fragment,o),e=Y(o),ct(l.$$.fragment,o)},m(o,r){ut(t,o,r),U(o,e,r),ut(l,o,r),n=!0},p(o,r){const i={};r&65544&&(i.$$scope={dirty:r,ctx:o}),t.$set(i);const a={};r&65544&&(a.$$scope={dirty:r,ctx:o}),l.$set(a)},i(o){n||(O(t.$$.fragment,o),O(l.$$.fragment,o),n=!0)},o(o){z(t.$$.fragment,o),z(l.$$.fragment,o),n=!1},d(o){o&&m(e),ft(t,o),ft(l,o)}}}function jo(s){let t,e,l,n,o,r,i,a,u;return t=new we({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-share-button",$$slots:{default:[Ho]},$$scope:{ctx:s}}}),t.$on("click",s[11]),l=new gs({props:{$$slots:{default:[Ro]},$$scope:{ctx:s}}}),a=new xn({props:{chatId:s[1].id}}),{c(){at(t.$$.fragment),e=Q(),at(l.$$.fragment),n=Q(),o=E("hr"),r=Q(),i=E("div"),at(a.$$.fragment),this.h()},l(c){ct(t.$$.fragment,c),e=Y(c),ct(l.$$.fragment,c),n=Y(c),o=I(c,"HR",{class:!0}),r=Y(c),i=I(c,"DIV",{class:!0});var d=k(i);ct(a.$$.fragment,d),d.forEach(m),this.h()},h(){f(o,"class","border-gray-100 dark:border-gray-800 mt-2.5 mb-1.5"),f(i,"class","flex p-1")},m(c,d){ut(t,c,d),U(c,e,d),ut(l,c,d),U(c,n,d),U(c,o,d),U(c,r,d),U(c,i,d),ut(a,i,null),u=!0},p(c,d){const g={};d&65544&&(g.$$scope={dirty:d,ctx:c}),t.$set(g);const p={};d&65544&&(p.$$scope={dirty:d,ctx:c}),l.$set(p);const S={};d&2&&(S.chatId=c[1].id),a.$set(S)},i(c){u||(O(t.$$.fragment,c),O(l.$$.fragment,c),O(a.$$.fragment,c),u=!0)},o(c){z(t.$$.fragment,c),z(l.$$.fragment,c),z(a.$$.fragment,c),u=!1},d(c){c&&(m(e),m(n),m(o),m(r),m(i)),ft(t,c),ft(l,c),ft(a)}}}function Fo(s){let t,e,l;return e=new $e({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:8,side:"bottom",align:"end",transition:Oe,$$slots:{default:[jo]},$$scope:{ctx:s}}}),{c(){t=E("div"),at(e.$$.fragment),this.h()},l(n){t=I(n,"DIV",{slot:!0});var o=k(t);ct(e.$$.fragment,o),o.forEach(m),this.h()},h(){f(t,"slot","content")},m(n,o){U(n,t,o),ut(e,t,null),l=!0},p(n,o){const r={};o&65547&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){l||(O(e.$$.fragment,n),l=!0)},o(n){z(e.$$.fragment,n),l=!1},d(n){n&&m(t),ft(e)}}}function qo(s){let t,e;return t=new Ke({props:{$$slots:{content:[Fo],default:[Lo]},$$scope:{ctx:s}}}),t.$on("change",s[15]),{c(){at(t.$$.fragment)},l(l){ct(t.$$.fragment,l)},m(l,n){ut(t,l,n),e=!0},p(l,[n]){const o={};n&65547&&(o.$$scope={dirty:n,ctx:l}),t.$set(o)},i(l){e||(O(t.$$.fragment,l),e=!0)},o(l){z(t.$$.fragment,l),e=!1},d(l){ft(t,l)}}}function Wo(s,t,e){let l,{$$slots:n={},$$scope:o}=t;const{saveAs:r}=us,i=ue("i18n");it(s,i,B=>e(3,l=B));let{shareEnabled:a=!1}=t,{shareHandler:u}=t,{downloadHandler:c}=t,{chat:d}=t,{onClose:g=()=>{}}=t;const p=async()=>{const B=d.chat;console.log("download",d);const D=B.messages.reduce((L,A,R,H)=>`${L}### ${A.role.toUpperCase()}
${A.content}

`,"");let P=new Blob([D],{type:"text/plain"});r(P,`chat-${B.title}.txt`)},S=async()=>{const B=d.chat;console.log("download",d);const D=await os(B),P=window.URL.createObjectURL(D),L=document.createElement("a");L.href=P,L.download=`chat-${B.title}.pdf`,document.body.appendChild(L),L.click(),document.body.removeChild(L),window.URL.revokeObjectURL(P)},b=async()=>{let B=new Blob([JSON.stringify([d])],{type:"application/json"});r(B,`chat-export-${Date.now()}.json`)},h=()=>{u()},v=()=>{b()},w=()=>{p()},C=()=>{S()},V=B=>{B.detail===!1&&g()};return s.$$set=B=>{"shareEnabled"in B&&e(8,a=B.shareEnabled),"shareHandler"in B&&e(0,u=B.shareHandler),"downloadHandler"in B&&e(9,c=B.downloadHandler),"chat"in B&&e(1,d=B.chat),"onClose"in B&&e(2,g=B.onClose),"$$scope"in B&&e(16,o=B.$$scope)},[u,d,g,l,i,p,S,b,a,c,n,h,v,w,C,V,o]}class Zo extends Jt{constructor(t){super(),Qt(this,t,Wo,qo,Gt,{shareEnabled:8,shareHandler:0,downloadHandler:9,chat:1,onClose:2})}}function ln(s){let t,e,l;function n(r){s[15](r)}let o={showSetDefault:!s[2]};return s[0]!==void 0&&(o.selectedModels=s[0]),t=new No({props:o}),Et.push(()=>Ut(t,"selectedModels",n)),{c(){at(t.$$.fragment)},l(r){ct(t.$$.fragment,r)},m(r,i){ut(t,r,i),l=!0},p(r,i){const a={};i&4&&(a.showSetDefault=!r[2]),!e&&i&1&&(e=!0,a.selectedModels=r[0],Ot(()=>e=!1)),t.$set(a)},i(r){l||(O(t.$$.fragment,r),l=!0)},o(r){z(t.$$.fragment,r),l=!1},d(r){ft(t,r)}}}function nn(s){let t,e;return t=new Zo({props:{chat:s[3],shareEnabled:s[2],shareHandler:s[16],downloadHandler:s[17],$$slots:{default:[xo]},$$scope:{ctx:s}}}),{c(){at(t.$$.fragment)},l(l){ct(t.$$.fragment,l)},m(l,n){ut(t,l,n),e=!0},p(l,n){const o={};n&8&&(o.chat=l[3]),n&4&&(o.shareEnabled=l[2]),n&32&&(o.shareHandler=l[16]),n&64&&(o.downloadHandler=l[17]),n&2097152&&(o.$$scope={dirty:n,ctx:l}),t.$set(o)},i(l){e||(O(t.$$.fragment,l),e=!0)},o(l){z(t.$$.fragment,l),e=!1},d(l){ft(t,l)}}}function xo(s){let t,e='<div class="m-auto self-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"></path></svg></div>';return{c(){t=E("button"),t.innerHTML=e,this.h()},l(l){t=I(l,"BUTTON",{class:!0,id:!0,"data-svelte-h":!0}),Zt(t)!=="svelte-9m6068"&&(t.innerHTML=e),this.h()},h(){f(t,"class","hidden md:flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition"),f(t,"id","chat-context-menu-button")},m(l,n){U(l,t,n)},p:kt,d(l){l&&m(t)}}}function Go(s){let t,e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z"></path><path d="M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z"></path></svg>',n,o,r;return{c(){t=E("button"),e=E("div"),e.innerHTML=l,this.h()},l(i){t=I(i,"BUTTON",{id:!0,class:!0});var a=k(t);e=I(a,"DIV",{class:!0,"data-svelte-h":!0}),Zt(e)!=="svelte-1fcii9y"&&(e.innerHTML=l),a.forEach(m),this.h()},h(){f(e,"class","m-auto self-center"),f(t,"id","new-chat-button"),f(t,"class",n="flex "+(s[8]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition")},m(i,a){U(i,t,a),_(t,e),o||(r=et(t,"click",s[18]),o=!0)},p(i,a){a&256&&n!==(n="flex "+(i[8]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition")&&f(t,"class",n)},d(i){i&&m(t),o=!1,r()}}}function sn(s){let t,e;return t=new Jn({props:{className:"max-w-[200px]",role:s[10].role,$$slots:{default:[Jo]},$$scope:{ctx:s}}}),t.$on("show",s[19]),{c(){at(t.$$.fragment)},l(l){ct(t.$$.fragment,l)},m(l,n){ut(t,l,n),e=!0},p(l,n){const o={};n&1024&&(o.role=l[10].role),n&2098176&&(o.$$scope={dirty:n,ctx:l}),t.$set(o)},i(l){e||(O(t.$$.fragment,l),e=!0)},o(l){z(t.$$.fragment,l),e=!1},d(l){ft(t,l)}}}function Jo(s){let t,e,l,n;return{c(){t=E("button"),e=E("div"),l=E("img"),this.h()},l(o){t=I(o,"BUTTON",{class:!0,"aria-label":!0});var r=k(t);e=I(r,"DIV",{class:!0});var i=k(e);l=I(i,"IMG",{src:!0,class:!0,alt:!0,draggable:!0}),i.forEach(m),r.forEach(m),this.h()},h(){ve(l.src,n=s[10].profile_image_url)||f(l,"src",n),f(l,"class","size-6 object-cover rounded-full"),f(l,"alt","User profile"),f(l,"draggable","false"),f(e,"class","self-center"),f(t,"class","select-none flex rounded-xl p-1.5 w-full hover:bg-gray-100 dark:hover:bg-gray-850 transition"),f(t,"aria-label","User Menu")},m(o,r){U(o,t,r),_(t,e),_(e,l)},p(o,r){r&1024&&!ve(l.src,n=o[10].profile_image_url)&&f(l,"src",n)},d(o){o&&m(t)}}}function Qo(s){let t,e,l,n,o,r,i,a,u,c,d,g,p,S,b,h,v,w,C,V,B;function D(H){s[13](H)}let P={chatId:s[7]};s[5]!==void 0&&(P.show=s[5]),t=new Gn({props:P}),Et.push(()=>Ut(t,"show",D)),c=new fs({});let L=s[4]&&ln(s),A=s[2]&&s[3]&&s[3].id&&nn(s);v=new ge({props:{content:s[9].t("New Chat"),$$slots:{default:[Go]},$$scope:{ctx:s}}});let R=s[10]!==void 0&&sn(s);return{c(){at(t.$$.fragment),l=Q(),n=E("nav"),o=E("div"),r=E("div"),i=E("div"),a=E("button"),u=E("div"),at(c.$$.fragment),g=Q(),p=E("div"),L&&L.c(),S=Q(),b=E("div"),A&&A.c(),h=Q(),at(v.$$.fragment),w=Q(),R&&R.c(),this.h()},l(H){ct(t.$$.fragment,H),l=Y(H),n=I(H,"NAV",{id:!0,class:!0});var F=k(n);o=I(F,"DIV",{class:!0});var j=k(o);r=I(j,"DIV",{class:!0});var M=k(r);i=I(M,"DIV",{class:!0});var q=k(i);a=I(q,"BUTTON",{id:!0,class:!0});var ot=k(a);u=I(ot,"DIV",{class:!0});var Z=k(u);ct(c.$$.fragment,Z),Z.forEach(m),ot.forEach(m),q.forEach(m),g=Y(M),p=I(M,"DIV",{class:!0});var J=k(p);L&&L.l(J),J.forEach(m),S=Y(M),b=I(M,"DIV",{class:!0});var X=k(b);A&&A.l(X),h=Y(X),ct(v.$$.fragment,X),w=Y(X),R&&R.l(X),X.forEach(m),M.forEach(m),j.forEach(m),F.forEach(m),this.h()},h(){f(u,"class","m-auto self-center"),f(a,"id","sidebar-toggle-button"),f(a,"class","cursor-pointer px-2 py-2 flex rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition"),f(i,"class",d=(s[8]?"md:hidden":"")+" mr-3 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),f(p,"class","flex-1 overflow-hidden max-w-full"),f(b,"class","self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),f(r,"class","flex items-center w-full max-w-full"),f(o,"class","flex max-w-full w-full mx-auto px-5 pt-0.5 md:px-[1rem]"),f(n,"id","nav"),f(n,"class","sticky py-2.5 top-0 flex flex-row justify-center z-30")},m(H,F){ut(t,H,F),U(H,l,F),U(H,n,F),_(n,o),_(o,r),_(r,i),_(i,a),_(a,u),ut(c,u,null),_(r,g),_(r,p),L&&L.m(p,null),_(r,S),_(r,b),A&&A.m(b,null),_(b,h),ut(v,b,null),_(b,w),R&&R.m(b,null),C=!0,V||(B=et(a,"click",s[14]),V=!0)},p(H,[F]){const j={};F&128&&(j.chatId=H[7]),!e&&F&32&&(e=!0,j.show=H[5],Ot(()=>e=!1)),t.$set(j),(!C||F&256&&d!==(d=(H[8]?"md:hidden":"")+" mr-3 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"))&&f(i,"class",d),H[4]?L?(L.p(H,F),F&16&&O(L,1)):(L=ln(H),L.c(),O(L,1),L.m(p,null)):L&&(zt(),z(L,1,1,()=>{L=null}),Rt()),H[2]&&H[3]&&H[3].id?A?(A.p(H,F),F&12&&O(A,1)):(A=nn(H),A.c(),O(A,1),A.m(b,h)):A&&(zt(),z(A,1,1,()=>{A=null}),Rt());const M={};F&512&&(M.content=H[9].t("New Chat")),F&2097410&&(M.$$scope={dirty:F,ctx:H}),v.$set(M),H[10]!==void 0?R?(R.p(H,F),F&1024&&O(R,1)):(R=sn(H),R.c(),O(R,1),R.m(b,null)):R&&(zt(),z(R,1,1,()=>{R=null}),Rt())},i(H){C||(O(t.$$.fragment,H),O(c.$$.fragment,H),O(L),O(A),O(v.$$.fragment,H),O(R),C=!0)},o(H){z(t.$$.fragment,H),z(c.$$.fragment,H),z(L),z(A),z(v.$$.fragment,H),z(R),C=!1},d(H){H&&(m(l),m(n)),ft(t,H),ft(c),L&&L.d(),A&&A.d(),ft(v),R&&R.d(),V=!1,B()}}}function Yo(s,t,e){let l,n,o,r,i;it(s,hn,L=>e(20,l=L)),it(s,be,L=>e(7,n=L)),it(s,Ne,L=>e(8,o=L)),it(s,gn,L=>e(10,i=L));const a=ue("i18n");it(s,a,L=>e(9,r=L));let{initNewChat:u}=t,{title:c=l}=t,{shareEnabled:d=!1}=t,{chat:g}=t,{selectedModels:p}=t,{showModelSelector:S=!0}=t,b=!1,h=!1;function v(L){b=L,e(5,b)}const w=()=>{Ne.set(!o)};function C(L){p=L,e(0,p)}const V=()=>{e(5,b=!b)},B=()=>{e(6,h=!h)},D=()=>{u()},P=L=>{L.detail==="archived-chat"&&Tn.set(!0)};return s.$$set=L=>{"initNewChat"in L&&e(1,u=L.initNewChat),"title"in L&&e(12,c=L.title),"shareEnabled"in L&&e(2,d=L.shareEnabled),"chat"in L&&e(3,g=L.chat),"selectedModels"in L&&e(0,p=L.selectedModels),"showModelSelector"in L&&e(4,S=L.showModelSelector)},[p,u,d,g,S,b,h,n,o,r,i,a,c,v,w,C,V,B,D,P]}class Xo extends Jt{constructor(t){super(),Qt(this,t,Yo,Qo,Gt,{initNewChat:1,title:12,shareEnabled:2,chat:3,selectedModels:0,showModelSelector:4})}}const{document:Qe}=En;function rn(s,t,e){const l=s.slice();return l[63]=t[e],l}function on(s){let t,e,l,n,o,r,i,a,u,c,d,g,p,S,b,h,v,w,C,V,B,D,P,L,A,R;function H(T){s[26](T)}function F(T){s[27](T)}let j={title:s[10],shareEnabled:s[13].length>0,chat:s[9],initNewChat:s[19]};s[6]!==void 0&&(j.selectedModels=s[6]),s[5]!==void 0&&(j.showModelSelector=s[5]),e=new Xo({props:j}),Et.push(()=>Ut(e,"selectedModels",H)),Et.push(()=>Ut(e,"showModelSelector",F));let M=s[17].length>0&&s[13].length===0&&!s[14]&&s[6].length<=1&&an(s);function q(T){s[30](T)}function ot(T){s[31](T)}function Z(T){s[32](T)}function J(T){s[33](T)}let X={chatId:s[14],selectedModels:s[6],processing:$o,bottomPadding:s[12].length>0,sendPrompt:s[21],continueGeneration:s[24],regenerateResponse:s[23]};s[1]!==void 0&&(X.history=s[1]),s[13]!==void 0&&(X.messages=s[13]),s[3]!==void 0&&(X.autoScroll=s[3]),s[11]!==void 0&&(X.prompt=s[11]),c=new In({props:X}),Et.push(()=>Ut(c,"history",q)),Et.push(()=>Ut(c,"messages",ot)),Et.push(()=>Ut(c,"autoScroll",Z)),Et.push(()=>Ut(c,"prompt",J));function lt(T){s[36](T)}function At(T){s[37](T)}function Pt(T){s[38](T)}function Xt(T){s[39](T)}function Wt(T){s[40](T)}let W={selectedModels:s[6],messages:s[13],submitPrompt:s[20],stopResponse:s[22]};return s[12]!==void 0&&(W.files=s[12]),s[11]!==void 0&&(W.prompt=s[11]),s[3]!==void 0&&(W.autoScroll=s[3]),s[8]!==void 0&&(W.webSearchEnabled=s[8]),s[7]!==void 0&&(W.atSelectedModel=s[7]),v=new So({props:W}),Et.push(()=>Ut(v,"files",lt)),Et.push(()=>Ut(v,"prompt",At)),Et.push(()=>Ut(v,"autoScroll",Pt)),Et.push(()=>Ut(v,"webSearchEnabled",Xt)),Et.push(()=>Ut(v,"atSelectedModel",Wt)),{c(){t=E("div"),at(e.$$.fragment),o=Q(),M&&M.c(),r=Q(),i=E("div"),a=E("div"),u=E("div"),at(c.$$.fragment),h=Q(),at(v.$$.fragment),this.h()},l(T){t=I(T,"DIV",{class:!0});var K=k(t);ct(e.$$.fragment,K),o=Y(K),M&&M.l(K),r=Y(K),i=I(K,"DIV",{class:!0});var st=k(i);a=I(st,"DIV",{class:!0,id:!0});var mt=k(a);u=I(mt,"DIV",{class:!0});var x=k(u);ct(c.$$.fragment,x),x.forEach(m),mt.forEach(m),h=Y(st),ct(v.$$.fragment,st),st.forEach(m),K.forEach(m),this.h()},h(){f(u,"class",b="h-full w-full flex flex-col "+(s[0]?"py-4":"pt-2 pb-4")),f(a,"class","pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0 max-w-full"),f(a,"id","messages-container"),f(i,"class","flex flex-col flex-auto"),f(t,"class",P="h-screen max-h-[100dvh] "+(s[16]?"md:max-w-[calc(100%-260px)]":"")+" w-full max-w-full flex flex-col")},m(T,K){U(T,t,K),ut(e,t,null),_(t,o),M&&M.m(t,null),_(t,r),_(t,i),_(i,a),_(a,u),ut(c,u,null),s[34](a),_(i,h),ut(v,i,null),L=!0,A||(R=et(a,"scroll",s[35]),A=!0)},p(T,K){const st={};K[0]&1024&&(st.title=T[10]),K[0]&8192&&(st.shareEnabled=T[13].length>0),K[0]&512&&(st.chat=T[9]),!l&&K[0]&64&&(l=!0,st.selectedModels=T[6],Ot(()=>l=!1)),!n&&K[0]&32&&(n=!0,st.showModelSelector=T[5],Ot(()=>n=!1)),e.$set(st),T[17].length>0&&T[13].length===0&&!T[14]&&T[6].length<=1?M?(M.p(T,K),K[0]&155712&&O(M,1)):(M=an(T),M.c(),O(M,1),M.m(t,r)):M&&(zt(),z(M,1,1,()=>{M=null}),Rt());const mt={};K[0]&16384&&(mt.chatId=T[14]),K[0]&64&&(mt.selectedModels=T[6]),K[0]&4096&&(mt.bottomPadding=T[12].length>0),!d&&K[0]&2&&(d=!0,mt.history=T[1],Ot(()=>d=!1)),!g&&K[0]&8192&&(g=!0,mt.messages=T[13],Ot(()=>g=!1)),!p&&K[0]&8&&(p=!0,mt.autoScroll=T[3],Ot(()=>p=!1)),!S&&K[0]&2048&&(S=!0,mt.prompt=T[11],Ot(()=>S=!1)),c.$set(mt),(!L||K[0]&1&&b!==(b="h-full w-full flex flex-col "+(T[0]?"py-4":"pt-2 pb-4")))&&f(u,"class",b);const x={};K[0]&64&&(x.selectedModels=T[6]),K[0]&8192&&(x.messages=T[13]),!w&&K[0]&4096&&(w=!0,x.files=T[12],Ot(()=>w=!1)),!C&&K[0]&2048&&(C=!0,x.prompt=T[11],Ot(()=>C=!1)),!V&&K[0]&8&&(V=!0,x.autoScroll=T[3],Ot(()=>V=!1)),!B&&K[0]&256&&(B=!0,x.webSearchEnabled=T[8],Ot(()=>B=!1)),!D&&K[0]&128&&(D=!0,x.atSelectedModel=T[7],Ot(()=>D=!1)),v.$set(x),(!L||K[0]&65536&&P!==(P="h-screen max-h-[100dvh] "+(T[16]?"md:max-w-[calc(100%-260px)]":"")+" w-full max-w-full flex flex-col"))&&f(t,"class",P)},i(T){L||(O(e.$$.fragment,T),O(M),O(c.$$.fragment,T),O(v.$$.fragment,T),L=!0)},o(T){z(e.$$.fragment,T),z(M),z(c.$$.fragment,T),z(v.$$.fragment,T),L=!1},d(T){T&&m(t),ft(e),M&&M.d(),ft(c),s[34](null),ft(v),A=!1,R()}}}function an(s){let t,e,l,n,o=$t(s[17].filter(s[28])),r=[];for(let a=0;a<o.length;a+=1)r[a]=cn(rn(s,o,a));const i=a=>z(r[a],1,1,()=>{r[a]=null});return{c(){t=E("div"),e=E("div");for(let a=0;a<r.length;a+=1)r[a].c();this.h()},l(a){t=I(a,"DIV",{class:!0});var u=k(t);e=I(u,"DIV",{class:!0});var c=k(e);for(let d=0;d<r.length;d+=1)r[d].l(c);c.forEach(m),u.forEach(m),this.h()},h(){f(e,"class","flex flex-col gap-1 w-full"),f(t,"class",l="absolute top-[4.25rem] w-full "+(s[16]?"md:max-w-[calc(100%-260px)]":""))},m(a,u){U(a,t,u),_(t,e);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(e,null);n=!0},p(a,u){if(u[0]&131072){o=$t(a[17].filter(a[28]));let c;for(c=0;c<o.length;c+=1){const d=rn(a,o,c);r[c]?(r[c].p(d,u),O(r[c],1)):(r[c]=cn(d),r[c].c(),O(r[c],1),r[c].m(e,null))}for(zt(),c=o.length;c<r.length;c+=1)i(c);Rt()}(!n||u[0]&65536&&l!==(l="absolute top-[4.25rem] w-full "+(a[16]?"md:max-w-[calc(100%-260px)]":"")))&&f(t,"class",l)},i(a){if(!n){for(let u=0;u<o.length;u+=1)O(r[u]);n=!0}},o(a){r=r.filter(Boolean);for(let u=0;u<r.length;u+=1)z(r[u]);n=!1},d(a){a&&m(t),pe(r,a)}}}function cn(s){let t,e;return t=new gr({props:{banner:s[63]}}),t.$on("dismiss",s[29]),{c(){at(t.$$.fragment)},l(l){ct(t.$$.fragment,l)},m(l,n){ut(t,l,n),e=!0},p(l,n){const o={};n[0]&131072&&(o.banner=l[63]),t.$set(o)},i(l){e||(O(t.$$.fragment,l),e=!0)},o(l){z(t.$$.fragment,l),e=!1},d(l){ft(t,l)}}}function Ko(s){let t,e,l,n,o,r,i;Qe.title=t=`
		`+(s[10]?`${s[10].length>30?`${s[10].slice(0,30)}...`:s[10]} | ${s[15]}`:`${s[15]}`)+`
	`;function a(d){s[25](d)}let u={submitPrompt:s[20]};s[12]!==void 0&&(u.files=s[12]),l=new rr({props:u}),Et.push(()=>Ut(l,"files",a));let c=(!s[0]||s[2]&&s[0])&&on(s);return{c(){e=Q(),at(l.$$.fragment),o=Q(),c&&c.c(),r=Ht()},l(d){yn("svelte-1123lr8",Qe.head).forEach(m),e=Y(d),ct(l.$$.fragment,d),o=Y(d),c&&c.l(d),r=Ht()},m(d,g){U(d,e,g),ut(l,d,g),U(d,o,g),c&&c.m(d,g),U(d,r,g),i=!0},p(d,g){(!i||g[0]&33792)&&t!==(t=`
		`+(d[10]?`${d[10].length>30?`${d[10].slice(0,30)}...`:d[10]} | ${d[15]}`:`${d[15]}`)+`
	`)&&(Qe.title=t);const p={};!n&&g[0]&4096&&(n=!0,p.files=d[12],Ot(()=>n=!1)),l.$set(p),!d[0]||d[2]&&d[0]?c?(c.p(d,g),g[0]&5&&O(c,1)):(c=on(d),c.c(),O(c,1),c.m(r.parentNode,r)):c&&(zt(),z(c,1,1,()=>{c=null}),Rt())},i(d){i||(O(l.$$.fragment,d),O(c),i=!0)},o(d){z(l.$$.fragment,d),z(c),i=!1},d(d){d&&(m(e),m(o),m(r)),ft(l,d),c&&c.d(d)}}}let $o="";function ti(s,t,e){let l,n,o,r,i,a,u,c,d,g,p,S;it(s,be,N=>e(14,l=N)),it(s,fe,N=>e(43,n=N)),it(s,Ae,N=>e(45,r=N)),it(s,Be,N=>e(46,i=N)),it(s,gn,N=>e(47,a=N)),it(s,Vn,N=>e(48,u=N)),it(s,Dn,N=>e(49,c=N)),it(s,Me,N=>e(50,d=N)),it(s,hn,N=>e(15,g=N)),it(s,Ne,N=>e(16,p=N)),it(s,Bn,N=>e(17,S=N));const b=ue("i18n");it(s,b,N=>e(44,o=N));let{chatIdProp:h=""}=t,v=!1,w=!1,C=!0,V,B=!0,D=[""],P,L=!1,A=null,R="",H="",F=[],j=[],M={messages:{},currentId:null};Ye(async()=>{l?(n.saveChatHistory??!0)||await xe("/"):await q()});const q=async()=>{var It;window.history.replaceState(M.state,"","/"),await be.set(""),e(3,C=!0),e(10,R=""),e(13,j=[]),e(1,M={messages:{},currentId:null}),c.url.searchParams.get("models")?e(6,D=(It=c.url.searchParams.get("models"))==null?void 0:It.split(",")):n!=null&&n.models?e(6,D=n==null?void 0:n.models):d!=null&&d.default_models?(console.log((d==null?void 0:d.default_models.split(","))??""),e(6,D=d==null?void 0:d.default_models.split(","))):e(6,D=[""]),c.url.searchParams.get("q")&&(e(11,H=c.url.searchParams.get("q")??""),H&&(await Bt(),At(H))),e(6,D=D.map($=>r.map(Lt=>Lt.id).includes($)?$:""));const N=await fl(localStorage.token);N?fe.set(N.ui):fe.set(JSON.parse(localStorage.getItem("settings")??"{}"));const tt=document.getElementById("chat-textarea");setTimeout(()=>tt==null?void 0:tt.focus(),0)},ot=async()=>{if(be.set(h),e(9,A=await zn(localStorage.token,l).catch(async N=>(await xe("/"),null))),A){await Yt();const N=A.chat;if(N){console.log(N),e(6,D=((N==null?void 0:N.models)??void 0)!==void 0?N.models:[N.models??""]),e(1,M=((N==null?void 0:N.history)??void 0)!==void 0?N.history:An(N.messages)),e(10,R=N.title);const tt=await fl(localStorage.token);return tt?await fe.set(tt.ui):await fe.set(JSON.parse(localStorage.getItem("settings")??"{}")),await fe.set({...n,system:N.system??n.system,params:N.options??n.params}),e(3,C=!0),await Bt(),j.length>0&&e(1,M.messages[j.at(-1).id].done=!0,M),await Bt(),!0}else return null}},Z=async()=>{await Bt(),V&&e(4,V.scrollTop=V.scrollHeight,V)},J=N=>{const tt=M.messages[N];return tt.parentId?[...J(tt.parentId),tt]:[tt]},X=async(N,tt)=>{await Sn.run({querySelector:".mermaid"});const It=await Xn(localStorage.token,{model:N,messages:tt.map($=>({id:$.id,role:$.role,content:$.content,timestamp:$.timestamp})),chat_id:l}).catch($=>(console.error($),null));if(It!==null)for(const $ of It.messages)e(1,M.messages[$.id]={...M.messages[$.id],...M.messages[$.id].content!==$.content?{originalContent:M.messages[$.id].content}:{},...$},M)},lt=async(N,tt="")=>setInterval(()=>{u==null||u.emit("usage",{action:"chat",model:N,chat_id:tt})},1e3),At=async(N,tt=null)=>{let It=[];if(console.log("submitPrompt",l),e(6,D=D.map($=>r.map(Lt=>Lt.id).includes($)?$:"")),D.includes(""))pt.error(o.t("Model not selected"));else if(j.length!=0&&j.at(-1).done!=!0)console.log("wait");else if(F.length>0&&F.filter($=>$.upload_status===!1).length>0)pt.error(o.t("Oops! Hold tight! Your files are still in the processing oven. We're cooking them up to perfection. Please be patient and we'll let you know once they're ready."));else{const $=document.getElementById("chat-textarea");$&&($.value="",$.style.height=""),e(11,H="");let Lt=al(),G={id:Lt,parentId:j.length!==0?j.at(-1).id:null,childrenIds:[],role:"user",user:tt??void 0,content:N,files:F.length>0?F:void 0,timestamp:Math.floor(Date.now()/1e3),models:D.filter((St,y)=>D.indexOf(St)===y)};e(1,M.messages[Lt]=G,M),e(1,M.currentId=Lt,M),j.length!==0&&M.messages[j.at(-1).id].childrenIds.push(Lt),await Bt(),j.length==1&&(n.saveChatHistory??!0?(e(9,A=await Pn(localStorage.token,{id:l,title:o.t("New Chat"),models:D,system:n.system??void 0,options:{...n.params??{}},messages:j,history:M,tags:[],timestamp:Date.now()})),await Ie.set(await Se(localStorage.token)),await be.set(A.id)):await be.set("local"),await Bt()),e(12,F=[]),It=await Pt(N,Lt)}return It},Pt=async(N,tt,It=null)=>{let $=[];const Lt=JSON.parse(JSON.stringify(l));return await Promise.all((It?[It]:P!==void 0?[P.id]:D).map(async G=>{var y,nt,ht;console.log("modelId",G);const St=r.filter(rt=>rt.id===G).at(0);if(St){j.some(Mt=>{var Ct;return(Ct=Mt.files)==null?void 0:Ct.some(jt=>jt.type==="image")})&&!(((ht=(nt=(y=St.info)==null?void 0:y.meta)==null?void 0:nt.capabilities)==null?void 0:ht.vision)??!0)&&pt.error(o.t("Model {{modelName}} is not vision capable",{modelName:St.name??St.id}));let yt=al(),Ft={parentId:tt,id:yt,childrenIds:[],role:"assistant",content:"",model:St.id,modelName:St.name??St.id,userContext:null,timestamp:Math.floor(Date.now()/1e3)};e(1,M.messages[yt]=Ft,M),e(1,M.currentId=yt,M),tt!==null&&e(1,M.messages[tt].childrenIds=[...M.messages[tt].childrenIds,yt],M),await Bt();let le=null;if(((n==null?void 0:n.memory)??!1)&&le===null){const Mt=await Qn(localStorage.token,N).catch(Ct=>(pt.error(Ct),null));Mt&&(Mt.documents[0].length>0&&(le=Mt.documents.reduce((Ct,jt,Dt)=>{const Tt=Mt.metadatas[Dt][0].created_at,ne=new Date(Tt*1e3).toISOString().split("T")[0];return Ct.push(`${Dt+1}. [${ne}]. ${jt[0]}`),Ct},[])),console.log(le))}Ft.userContext=le;const se=await lt(St.id,Lt);L&&await Xt(St.id,tt,yt);let gt=null;(St==null?void 0:St.owned_by)==="openai"?gt=await W(St,N,yt,Lt):St&&(gt=await Wt(St,N,yt,Lt)),$.push(gt),console.log("chatEventEmitter",se),se&&clearInterval(se)}else pt.error(o.t("Model {{modelId}} not found",{modelId:G}))})),await Ie.set(await Se(localStorage.token)),$},Xt=async(N,tt,It)=>{const $=M.messages[It];$.status={done:!1,action:"web_search",description:o.t("Generating search query")},e(13,j),e(1,M);const Lt=M.messages[tt].content;let G=await Kn(localStorage.token,N,j,Lt).catch(y=>(console.log(y),Lt));G||(pt.warning(o.t("No search query generated")),$.status={...$.status,done:!0,error:!0,description:"No search query generated"},e(13,j),e(1,M)),$.status={...$.status,description:o.t("Searching the web for '{{searchQuery}}'",{searchQuery:G})},e(13,j),e(1,M);const St=await Zn(localStorage.token,G).catch(y=>(console.log(y),pt.error(y),null));St?($.status={...$.status,done:!0,description:o.t("Searched {{count}} sites",{count:St.filenames.length}),urls:St.filenames},(($==null?void 0:$.files)??!0)&&($.files=[]),$.files.push({collection_name:St.collection_name,name:G,type:"web_search_results",urls:St.filenames}),e(13,j),e(1,M)):($.status={...$.status,done:!0,error:!0,description:"No search results found"},e(13,j),e(1,M))},Wt=async(N,tt,It,$)=>{var yt,Ft,le,se;let Lt=null;const G=M.messages[It];await Bt(),Z();const St=[n.system||((G==null?void 0:G.userContext)??null)?{role:"system",content:`${cl((n==null?void 0:n.system)??"",a.name)}${(G==null?void 0:G.userContext)??null?`

User Context:
${((G==null?void 0:G.userContext)??[]).join(`
`)}`:""}`}:void 0,...j].filter(gt=>{var Mt;return(Mt=gt==null?void 0:gt.content)==null?void 0:Mt.trim()}).map((gt,Mt,Ct)=>{var Tt;const jt={role:gt.role,content:gt.content},Dt=(Tt=gt.files)==null?void 0:Tt.filter(ne=>ne.type==="image").map(ne=>ne.url.slice(ne.url.indexOf(",")+1));return Dt&&Dt.length>0&&gt.role==="user"&&(jt.images=Dt),jt});let y=-1;St.forEach((gt,Mt)=>{gt.images&&(y=Mt)}),St.forEach((gt,Mt)=>{Mt!==y&&delete gt.images});let nt=[];N.info.meta.knowledge&&(nt=N.info.meta.knowledge),nt=[...nt,...j.filter(gt=>(gt==null?void 0:gt.files)??null).map(gt=>gt.files.filter(Mt=>["doc","collection","web_search_results"].includes(Mt.type))).flat(1)].filter((gt,Mt,Ct)=>Ct.findIndex(jt=>JSON.stringify(jt)===JSON.stringify(gt))===Mt);const[ht,rt]=await On(localStorage.token,{model:N.id,messages:St,options:{...n.params??{},stop:((yt=n==null?void 0:n.params)==null?void 0:yt.stop)??void 0?n.params.stop.map(gt=>decodeURIComponent(JSON.parse('"'+gt.replace(/\"/g,'\\"')+'"'))):void 0,num_predict:((Ft=n==null?void 0:n.params)==null?void 0:Ft.max_tokens)??void 0,repeat_penalty:((le=n==null?void 0:n.params)==null?void 0:le.frequency_penalty)??void 0},format:n.requestFormat??void 0,keep_alive:n.keepAlive??void 0,docs:nt.length>0?nt:void 0,citations:nt.length>0,chat_id:l});if(ht&&ht.ok){console.log("controller",rt);const gt=ht.body.pipeThrough(new TextDecoderStream).pipeThrough(Hn(`
`)).getReader();for(;;){const{value:Mt,done:Ct}=await gt.read();if(Ct||w||$!==l){if(G.done=!0,e(13,j),e(1,M),w)rt.abort("User: Stop Response");else{const jt=J(It);await X(N.id,jt)}Lt=G.content;break}try{let jt=Mt.split(`
`);for(const Dt of jt)if(Dt!==""){console.log(Dt);let Tt=JSON.parse(Dt);if("citations"in Tt){G.citations=Tt.citations;continue}if("detail"in Tt)throw Tt;if(Tt.done==!1){if(G.content==""&&Tt.message.content==`
`)continue;G.content+=Tt.message.content,e(13,j),e(1,M)}else{if(G.done=!0,G.content==""&&(G.error={code:400,content:"Oops! No text generated from Ollama, Please try again."}),G.context=Tt.context??null,G.info={total_duration:Tt.total_duration,load_duration:Tt.load_duration,sample_count:Tt.sample_count,sample_duration:Tt.sample_duration,prompt_eval_count:Tt.prompt_eval_count,prompt_eval_duration:Tt.prompt_eval_duration,eval_count:Tt.eval_count,eval_duration:Tt.eval_duration},e(13,j),e(1,M),n.notificationEnabled&&!document.hasFocus()){const ne=new Notification(selectedModelfile?`${selectedModelfile.title.charAt(0).toUpperCase()+selectedModelfile.title.slice(1)}`:`${N.id}`,{body:G.content,icon:(selectedModelfile==null?void 0:selectedModelfile.imageUrl)??`${Le}/static/favicon.png`})}n.responseAutoCopy&&ul(G.content),n.responseAutoPlayback&&!i&&(await Bt(),(se=document.getElementById(`speak-button-${G.id}`))==null||se.click())}}}catch(jt){console.log(jt),"detail"in jt&&pt.error(jt.detail);break}C&&Z()}l==$&&(n.saveChatHistory??!0)&&(e(9,A=await Je(localStorage.token,$,{messages:j,history:M,models:D})),await Ie.set(await Se(localStorage.token)))}else{if(ht!==null){const gt=await ht.json();console.log(gt),"detail"in gt?(pt.error(gt.detail),G.error={content:gt.detail}):(pt.error(gt.error),G.error={content:gt.error})}else pt.error(o.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:"Ollama"})),G.error={content:o.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:"Ollama"})};G.done=!0,e(13,j),e(1,M)}if(w=!1,await Bt(),C&&Z(),j.length==2&&j.at(1).content!==""){window.history.replaceState(M.state,"",`/c/${$}`);const gt=await x(tt);await dt($,gt)}return Lt},W=async(N,tt,It,$)=>{var y,nt,ht,rt,yt,Ft,le,se,gt,Mt;let Lt=null;const G=M.messages[It];let St=[];N.info.meta.knowledge&&(St=N.info.meta.knowledge),St=[...St,...j.filter(Ct=>(Ct==null?void 0:Ct.files)??null).map(Ct=>Ct.files.filter(jt=>["doc","collection","web_search_results"].includes(jt.type))).flat(1)].filter((Ct,jt,Dt)=>Dt.findIndex(Tt=>JSON.stringify(Tt)===JSON.stringify(Ct))===jt),Z();try{const[Ct,jt]=await jn(localStorage.token,{model:N.id,stream:!0,stream_options:((ht=(nt=(y=N.info)==null?void 0:y.meta)==null?void 0:nt.capabilities)==null?void 0:ht.usage)??!1?{include_usage:!0}:void 0,messages:[n.system||((G==null?void 0:G.userContext)??null)?{role:"system",content:`${cl((n==null?void 0:n.system)??"",a.name)}${(G==null?void 0:G.userContext)??null?`

User Context:
${((G==null?void 0:G.userContext)??[]).join(`
`)}`:""}`}:void 0,...j].filter(Dt=>{var Tt;return(Tt=Dt==null?void 0:Dt.content)==null?void 0:Tt.trim()}).map((Dt,Tt,ne)=>{var Ee;return{role:Dt.role,...((Ee=Dt.files)==null?void 0:Ee.filter(_e=>_e.type==="image").length)>0&&Dt.role==="user"?{content:[{type:"text",text:ne.length-1!==Tt?Dt.content:(Dt==null?void 0:Dt.raContent)??Dt.content},...Dt.files.filter(_e=>_e.type==="image").map(_e=>({type:"image_url",image_url:{url:_e.url}}))]}:{content:ne.length-1!==Tt?Dt.content:(Dt==null?void 0:Dt.raContent)??Dt.content}}}),seed:((rt=n==null?void 0:n.params)==null?void 0:rt.seed)??void 0,stop:((yt=n==null?void 0:n.params)==null?void 0:yt.stop)??void 0?n.params.stop.map(Dt=>decodeURIComponent(JSON.parse('"'+Dt.replace(/\"/g,'\\"')+'"'))):void 0,temperature:((Ft=n==null?void 0:n.params)==null?void 0:Ft.temperature)??void 0,top_p:((le=n==null?void 0:n.params)==null?void 0:le.top_p)??void 0,frequency_penalty:((se=n==null?void 0:n.params)==null?void 0:se.frequency_penalty)??void 0,max_tokens:((gt=n==null?void 0:n.params)==null?void 0:gt.max_tokens)??void 0,docs:St.length>0?St:void 0,citations:St.length>0,chat_id:l},`${Nn}`);if(await Bt(),Z(),Ct&&Ct.ok&&Ct.body){const Dt=await cr(Ct.body,n.splitLargeChunks);let Tt=null;for await(const ne of Dt){const{value:Ee,done:_e,citations:tl,error:el,usage:ll}=ne;if(el){await T(el,null,N,G);break}if(_e||w||$!==l){if(G.done=!0,e(13,j),e(1,M),w)jt.abort("User: Stop Response");else{const wn=J(It);await X(N.id,wn)}Lt=G.content;break}if(ll&&(Tt=ll),tl){G.citations=tl;continue}G.content==""&&Ee==`
`||(G.content+=Ee,e(13,j),e(1,M),C&&Z())}if(n.notificationEnabled&&!document.hasFocus()){const ne=new Notification(`${N.id}`,{body:G.content,icon:`${Le}/static/favicon.png`})}n.responseAutoCopy&&ul(G.content),n.responseAutoPlayback&&!i&&(await Bt(),(Mt=document.getElementById(`speak-button-${G.id}`))==null||Mt.click()),Tt&&(G.info={...Tt,openai:!0}),l==$&&(n.saveChatHistory??!0)&&(e(9,A=await Je(localStorage.token,$,{models:D,messages:j,history:M})),await Ie.set(await Se(localStorage.token)))}else await T(null,Ct,N,G)}catch(Ct){await T(Ct,null,N,G)}if(e(13,j),e(1,M),w=!1,await Bt(),C&&Z(),j.length==2){window.history.replaceState(M.state,"",`/c/${$}`);const Ct=await x(tt);await dt($,Ct)}return Lt},T=async(N,tt,It,$)=>{let Lt="",G;N?G=N:tt!==null&&(G=await tt.json()),console.error(G),"detail"in G?(pt.error(G.detail),Lt=G.detail):"error"in G?"message"in G.error?(pt.error(G.error.message),Lt=G.error.message):(pt.error(G.error),Lt=G.error):"message"in G&&(pt.error(G.message),Lt=G.message),$.error={content:o.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:It.name??It.id})+`
`+Lt},$.done=!0,e(13,j),e(1,M)},K=()=>{w=!0,console.log("stopResponse")},st=async N=>{if(console.log("regenerateResponse"),j.length!=0){let tt=M.messages[N.parentId],It=tt.content;((tt==null?void 0:tt.models)??[...D]).length==1?await Pt(It,tt.id):await Pt(It,tt.id,N.model)}},mt=async()=>{console.log("continueGeneration");const N=JSON.parse(JSON.stringify(l));if(j.length!=0&&j.at(-1).done==!0){const tt=M.messages[M.currentId];tt.done=!1,await Bt();const It=r.filter($=>$.id===tt.model).at(0);It&&((It==null?void 0:It.owned_by)==="openai"?await W(It,M.messages[tt.parentId].content,tt.id,N):await Wt(It,M.messages[tt.parentId].content,tt.id,N))}else pt.error(o.t("Model {{modelId}} not found",{modelId}))},x=async N=>{var tt;return((tt=n==null?void 0:n.title)==null?void 0:tt.auto)??!0?await Yn(localStorage.token,D[0],N,l).catch($=>(console.error($),"New Chat")):`${N}`},dt=async(N,tt)=>{N===l&&e(10,R=tt),(n.saveChatHistory??!0)&&(e(9,A=await Je(localStorage.token,N,{title:tt})),await Ie.set(await Se(localStorage.token)))},Yt=async()=>await Rn(localStorage.token,l).catch(async N=>[]);function Nt(N){F=N,e(12,F)}function xt(N){D=N,e(6,D)}function qt(N){B=N,e(5,B)}const Kt=N=>N.dismissible?!JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]").includes(N.id):!0,ee=N=>{const tt=N.detail;localStorage.setItem("dismissedBannerIds",JSON.stringify([tt,...JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]")].filter(It=>S.find($=>$.id===It))))};function te(N){M=N,e(1,M)}function he(N){j=N,e(13,j),e(1,M)}function Ue(N){C=N,e(3,C)}function Pe(N){H=N,e(11,H)}function ze(N){Et[N?"unshift":"push"](()=>{V=N,e(4,V)})}const Re=N=>{e(3,C=V.scrollHeight-V.scrollTop<=V.clientHeight+5)};function je(N){F=N,e(12,F)}function Fe(N){H=N,e(11,H)}function qe(N){C=N,e(3,C)}function We(N){L=N,e(8,L)}function Ze(N){P=N,e(7,P)}return s.$$set=N=>{"chatIdProp"in N&&e(0,h=N.chatIdProp)},s.$$.update=()=>{if(s.$$.dirty[0]&2)if(M.currentId!==null){let N=[],tt=M.messages[M.currentId];for(;tt!==null;)N.unshift({...tt}),tt=tt.parentId!==null?M.messages[tt.parentId]:null;e(13,j=N)}else e(13,j=[]);s.$$.dirty[0]&1&&h&&(async()=>{if(await ot()){await Bt(),e(2,v=!0),window.setTimeout(()=>Z(),0);const N=document.getElementById("chat-textarea");N==null||N.focus()}else await xe("/")})()},[h,M,v,C,V,B,D,P,L,A,R,H,F,j,l,g,p,S,b,q,At,Pt,K,st,mt,Nt,xt,qt,Kt,ee,te,he,Ue,Pe,ze,Re,je,Fe,qe,We,Ze]}class Hi extends Jt{constructor(t){super(),Qt(this,t,ti,Ko,Gt,{chatIdProp:0},null,[-1,-1,-1])}}export{Hi as C};
//# sourceMappingURL=Chat.7ad57a3f.js.map
