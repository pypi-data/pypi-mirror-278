import"./sha256.8dba905a.js";let p;const D=new Uint8Array(16);function F(){if(!p&&(p=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!p))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return p(D)}const o=[];for(let t=0;t<256;++t)o.push((t+256).toString(16).slice(1));function v(t,e=0){return o[t[e+0]]+o[t[e+1]]+o[t[e+2]]+o[t[e+3]]+"-"+o[t[e+4]]+o[t[e+5]]+"-"+o[t[e+6]]+o[t[e+7]]+"-"+o[t[e+8]]+o[t[e+9]]+"-"+o[t[e+10]]+o[t[e+11]]+o[t[e+12]]+o[t[e+13]]+o[t[e+14]]+o[t[e+15]]}const C=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),w={randomUUID:C};function T(t,e,n){if(w.randomUUID&&!e&&!t)return w.randomUUID();t=t||{};const s=t.random||(t.rng||F)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,e){n=n||0;for(let a=0;a<16;++a)e[n+a]=s[a];return e}return v(s)}const A=t=>t.replace(/<\|[a-z]*$/,"").replace(/<\|[a-z]+\|$/,"").replace(/<$/,"").replaceAll(/<\|[a-z]+\|>/g," ").replaceAll("<","&lt;").replaceAll(">","&gt;").trim(),E=t=>t.replaceAll("&lt;","<").replaceAll("&gt;",">"),N=t=>{let e="";return new TransformStream({transform(n,s){e+=n;const a=e.split(t);a.slice(0,-1).forEach(r=>s.enqueue(r)),e=a[a.length-1]},flush(n){e&&n.enqueue(e)}})},z=t=>{const e={messages:{},currentId:null};let n=null,s=null;for(const a of t)s=T(),n!==null&&(e.messages[n].childrenIds=[...e.messages[n].childrenIds,s]),e.messages[s]={...a,id:s,parentId:n,childrenIds:[]},n=s;return e.currentId=s,e},U=()=>{const t=document.createElement("canvas"),e=t.getContext("2d");t.height=1,t.width=1;const n=new ImageData(t.width,t.height),s=n.data;for(let r=0;r<n.data.length;r+=1)r%4!==3?s[r]=Math.floor(256*Math.random()):s[r]=255;e.putImageData(n,0,0);const a=e.getImageData(0,0,t.width,t.height).data;for(let r=0;r<a.length;r+=1)if(a[r]!==s[r])return console.log("canvasPixelTest: Wrong canvas pixel RGB value detected:",a[r],"at:",r,"expected:",s[r]),console.log("canvasPixelTest: Canvas blocking or spoofing is likely"),!1;return!0},O=t=>{const e=document.createElement("canvas"),n=e.getContext("2d");if(e.width=100,e.height=100,!U())return console.log("generateInitialsImage: failed pixel test, fingerprint evasion is likely. Using default image."),"/user.png";n.fillStyle="#F39C12",n.fillRect(0,0,e.width,e.height),n.fillStyle="#FFFFFF",n.font="40px Helvetica",n.textAlign="center",n.textBaseline="middle";const s=t.trim(),a=s.length>0?s[0]+(s.split(" ").length>1?s[s.lastIndexOf(" ")+1]:""):"";return n.fillText(a.toUpperCase(),e.width/2,e.height/2),e.toDataURL()},V=async t=>{let e=!1;if(!navigator.clipboard){const n=document.createElement("textarea");n.value=t,n.style.top="0",n.style.left="0",n.style.position="fixed",document.body.appendChild(n),n.focus(),n.select();try{const a=document.execCommand("copy")?"successful":"unsuccessful";console.log("Fallback: Copying text command was "+a),e=!0}catch(s){console.error("Fallback: Oops, unable to copy",s)}return document.body.removeChild(n),e}return e=await navigator.clipboard.writeText(t).then(()=>(console.log("Async: Copying to clipboard was successful!"),!0)).catch(n=>(console.error("Async: Could not copy text: ",n),!1)),e},Y=(t,e)=>e==="0.0.0"?!1:e.localeCompare(t,void 0,{numeric:!0,sensitivity:"case",caseFirst:"upper"})<0,k=t=>{const e=/\[([^\]]+)\]/g,n=[];let s;for(;(s=e.exec(t))!==null;)n.push({word:s[1],startIndex:s.index,endIndex:e.lastIndex-1});return n},H=t=>{const e=t.split(" "),n=e.findIndex(a=>a.startsWith("#"));return n!==-1&&e.splice(n,1),e.join(" ")},_=t=>t.toLowerCase().replace(/[^\w\s]/g,"").replace(/\s+/g,"-"),$=t=>"mapping"in t[0]?"openai":"webui",M=t=>{var i,d,g,c,f,y,x,I;const e=t.mapping,n=[];let s="",a=null;for(let u in e){const l=e[u];s=u;try{if(n.length==0&&(l.message==null||((i=l.message.content.parts)==null?void 0:i[0])==""&&l.message.content.text==null))continue;{const h={id:u,parentId:a,childrenIds:l.children||[],role:((g=(d=l.message)==null?void 0:d.author)==null?void 0:g.role)!=="user"?"assistant":"user",content:((y=(f=(c=l.message)==null?void 0:c.content)==null?void 0:f.parts)==null?void 0:y[0])||((I=(x=l.message)==null?void 0:x.content)==null?void 0:I.text)||"",model:"gpt-3.5-turbo",done:!0,context:null};n.push(h),a=s}}catch(h){console.log("Error with",l,`
Error:`,h)}}let r={};return n.forEach(u=>r[u.id]=u),{history:{currentId:s,messages:r},models:["gpt-3.5-turbo"],messages:n,options:{},timestamp:t.create_time,title:t.title??"New Chat"}},R=t=>{const e=t.messages;if(e.length===0||e[e.length-1].childrenIds.length!==0||e[0].parentId!==null)return!1;for(let a of e)if(typeof a.content!="string")return!1;return!0},j=t=>{const e=[];let n=0;for(let s of t){const a=M(s);R(a)?e.push({id:s.id,user_id:"",title:s.title,chat:a,timestamp:s.timestamp}):n++}return console.log(n,"Conversations could not be imported"),e},L=t=>{let e;try{e=new URL(t)}catch{return!1}return e.protocol==="http:"||e.protocol==="https:"},S=t=>{const e=/[\uD800-\uDBFF][\uDC00-\uDFFF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g;return t.replace(e,"")},P=t=>t.split(new RegExp("(?<=[.!?])")).map(n=>S(n.trim())).filter(n=>n!==""),W=(t,e)=>new File([t],e,{type:t.type}),B=(t,e,n)=>{const s=new Date,a=s.getFullYear()+"-"+String(s.getMonth()+1).padStart(2,"0")+"-"+String(s.getDate()).padStart(2,"0");return t=t.replace("{{CURRENT_DATE}}",a),e&&(t=t.replace("{{USER_NAME}}",e)),n&&(t=t.replace("{{CURRENT_LOCATION}}",n)),t},q=t=>{const e=Math.floor(t/1e9%60),n=Math.floor(t/6e10%60),s=Math.floor(t/36e11%24),a=[];return e>=0&&a.push(`${e}s`),n>0&&a.push(`${n}m`),s>0&&a.push(`${s}h`),a.reverse().join(" ")},G=t=>{const e=new Date,n=new Date(t*1e3),a=(e.getTime()-n.getTime())/(1e3*3600*24),r=e.getDate(),m=e.getMonth(),i=e.getFullYear(),d=n.getDate(),g=n.getMonth(),c=n.getFullYear();return i===c&&m===g&&r===d?"Today":i===c&&m===g&&r-d===1?"Yesterday":a<=7?"Previous 7 days":a<=30?"Previous 30 days":i===c?n.toLocaleString("default",{month:"long"}):n.getFullYear().toString()};export{V as a,Y as b,U as c,$ as d,j as e,W as f,O as g,P as h,k as i,L as j,z as k,A as l,q as m,E as n,G as o,B as p,H as r,N as s,_ as t,v as u,T as v};
//# sourceMappingURL=index.485e0f6b.js.map
